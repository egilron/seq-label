Starting job 426954 on gpu-7 at Wed Feb 7 09:38:01 CET 2024

/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01191518_tsa-bin_NorBERT_3_large_37_b.json
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01191518_tsa-bin_NorBERT_3_large_37_b.json
01191518_tsa-bin_NorBERT_3_large Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6289.59 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6655.91 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6478.73 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6510.11 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6473.59 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 6541.79 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 6702.01 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 5555.84 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6122.47 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 6728.21 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6396.88 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 6604.30 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6353.08 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01191518_tsa-bin_NorBERT_3_large Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.9341, 'learning_rate': 9.583333333333335e-06, 'epoch': 1.0}
{'eval_loss': 0.4396754503250122, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7592, 'eval_samples_per_second': 265.833, 'eval_steps_per_second': 33.338, 'epoch': 1.0}
{'loss': 0.311, 'learning_rate': 9.166666666666666e-06, 'epoch': 2.0}
{'eval_loss': 0.22469975054264069, 'eval_precision': 0.18773006134969325, 'eval_recall': 0.17445838084378562, 'eval_f1': 0.1808510638297872, 'eval_accuracy': 0.9359993823824596, 'eval_runtime': 6.1353, 'eval_samples_per_second': 249.541, 'eval_steps_per_second': 31.295, 'epoch': 2.0}
{'loss': 0.207, 'learning_rate': 8.750000000000001e-06, 'epoch': 3.0}
{'eval_loss': 0.19555683434009552, 'eval_precision': 0.18792599805258034, 'eval_recall': 0.22006841505131128, 'eval_f1': 0.20273109243697476, 'eval_accuracy': 0.9392804755655061, 'eval_runtime': 6.2536, 'eval_samples_per_second': 244.819, 'eval_steps_per_second': 30.702, 'epoch': 3.0}
{'loss': 0.1665, 'learning_rate': 8.333333333333334e-06, 'epoch': 4.0}
{'eval_loss': 0.21089015901088715, 'eval_precision': 0.40229885057471265, 'eval_recall': 0.43899657924743446, 'eval_f1': 0.4198473282442748, 'eval_accuracy': 0.9441056125993978, 'eval_runtime': 5.9446, 'eval_samples_per_second': 257.546, 'eval_steps_per_second': 32.298, 'epoch': 4.0}
{'loss': 0.1227, 'learning_rate': 7.916666666666667e-06, 'epoch': 5.0}
{'eval_loss': 0.19540926814079285, 'eval_precision': 0.46347305389221555, 'eval_recall': 0.4412770809578107, 'eval_f1': 0.4521028037383178, 'eval_accuracy': 0.9491237551146453, 'eval_runtime': 5.7039, 'eval_samples_per_second': 268.411, 'eval_steps_per_second': 33.661, 'epoch': 5.0}
{'loss': 0.0924, 'learning_rate': 7.500000000000001e-06, 'epoch': 6.0}
{'eval_loss': 0.1968381404876709, 'eval_precision': 0.4454244762954796, 'eval_recall': 0.4606613454960091, 'eval_f1': 0.45291479820627806, 'eval_accuracy': 0.9472323013973597, 'eval_runtime': 5.7141, 'eval_samples_per_second': 267.932, 'eval_steps_per_second': 33.601, 'epoch': 6.0}
{'loss': 0.0705, 'learning_rate': 7.083333333333335e-06, 'epoch': 7.0}
{'eval_loss': 0.19038507342338562, 'eval_precision': 0.5191897654584222, 'eval_recall': 0.5553021664766249, 'eval_f1': 0.5366391184573004, 'eval_accuracy': 0.9540646954373504, 'eval_runtime': 5.7201, 'eval_samples_per_second': 267.653, 'eval_steps_per_second': 33.566, 'epoch': 7.0}
{'loss': 0.0522, 'learning_rate': 6.666666666666667e-06, 'epoch': 8.0}
{'eval_loss': 0.19844011962413788, 'eval_precision': 0.5526627218934911, 'eval_recall': 0.5324971493728621, 'eval_f1': 0.5423925667828106, 'eval_accuracy': 0.9549525206515865, 'eval_runtime': 6.0335, 'eval_samples_per_second': 253.749, 'eval_steps_per_second': 31.822, 'epoch': 8.0}
{'loss': 0.0405, 'learning_rate': 6.25e-06, 'epoch': 9.0}
{'eval_loss': 0.20267195999622345, 'eval_precision': 0.5288753799392097, 'eval_recall': 0.5952109464082098, 'eval_f1': 0.5600858369098713, 'eval_accuracy': 0.9527522581641319, 'eval_runtime': 6.2105, 'eval_samples_per_second': 246.519, 'eval_steps_per_second': 30.916, 'epoch': 9.0}
{'loss': 0.032, 'learning_rate': 5.833333333333334e-06, 'epoch': 10.0}
{'eval_loss': 0.215815931558609, 'eval_precision': 0.5574365175332527, 'eval_recall': 0.5256556442417332, 'eval_f1': 0.5410798122065726, 'eval_accuracy': 0.9546823129776886, 'eval_runtime': 6.0713, 'eval_samples_per_second': 252.169, 'eval_steps_per_second': 31.624, 'epoch': 10.0}
{'loss': 0.0252, 'learning_rate': 5.416666666666667e-06, 'epoch': 11.0}
{'eval_loss': 0.2191992700099945, 'eval_precision': 0.5306345733041575, 'eval_recall': 0.5530216647662486, 'eval_f1': 0.5415968732551648, 'eval_accuracy': 0.9531768702231144, 'eval_runtime': 5.9663, 'eval_samples_per_second': 256.609, 'eval_steps_per_second': 32.181, 'epoch': 11.0}
{'loss': 0.0201, 'learning_rate': 5e-06, 'epoch': 12.0}
{'eval_loss': 0.2212022840976715, 'eval_precision': 0.5315904139433552, 'eval_recall': 0.556442417331813, 'eval_f1': 0.5437325905292479, 'eval_accuracy': 0.9534470778970123, 'eval_runtime': 5.8873, 'eval_samples_per_second': 260.053, 'eval_steps_per_second': 32.613, 'epoch': 12.0}
{'loss': 0.0156, 'learning_rate': 4.583333333333333e-06, 'epoch': 13.0}
{'eval_loss': 0.2305517941713333, 'eval_precision': 0.5397170837867247, 'eval_recall': 0.5655644241733181, 'eval_f1': 0.5523385300668151, 'eval_accuracy': 0.9542963020149772, 'eval_runtime': 5.9625, 'eval_samples_per_second': 256.772, 'eval_steps_per_second': 32.201, 'epoch': 13.0}
{'loss': 0.013, 'learning_rate': 4.166666666666667e-06, 'epoch': 14.0}
{'eval_loss': 0.23357491195201874, 'eval_precision': 0.5640096618357487, 'eval_recall': 0.5324971493728621, 'eval_f1': 0.547800586510264, 'eval_accuracy': 0.9551455261329421, 'eval_runtime': 5.8922, 'eval_samples_per_second': 259.833, 'eval_steps_per_second': 32.585, 'epoch': 14.0}
{'loss': 0.0113, 'learning_rate': 3.7500000000000005e-06, 'epoch': 15.0}
{'eval_loss': 0.24167443811893463, 'eval_precision': 0.5455531453362256, 'eval_recall': 0.5735461801596351, 'eval_f1': 0.5591995553085046, 'eval_accuracy': 0.9545279085926041, 'eval_runtime': 5.8801, 'eval_samples_per_second': 260.371, 'eval_steps_per_second': 32.653, 'epoch': 15.0}
{'loss': 0.0101, 'learning_rate': 3.3333333333333333e-06, 'epoch': 16.0}
{'eval_loss': 0.24170301854610443, 'eval_precision': 0.5553072625698324, 'eval_recall': 0.5667046750285063, 'eval_f1': 0.5609480812641084, 'eval_accuracy': 0.9543349031112484, 'eval_runtime': 5.9034, 'eval_samples_per_second': 259.34, 'eval_steps_per_second': 32.523, 'epoch': 16.0}
{'loss': 0.0085, 'learning_rate': 2.916666666666667e-06, 'epoch': 17.0}
{'eval_loss': 0.2461201399564743, 'eval_precision': 0.5553121577217963, 'eval_recall': 0.5781071835803877, 'eval_f1': 0.5664804469273743, 'eval_accuracy': 0.9548367173627731, 'eval_runtime': 5.6955, 'eval_samples_per_second': 268.811, 'eval_steps_per_second': 33.711, 'epoch': 17.0}
{'loss': 0.0078, 'learning_rate': 2.5e-06, 'epoch': 18.0}
{'eval_loss': 0.24658577144145966, 'eval_precision': 0.5493107104984093, 'eval_recall': 0.5906499429874572, 'eval_f1': 0.5692307692307692, 'eval_accuracy': 0.9546437118814174, 'eval_runtime': 5.7823, 'eval_samples_per_second': 264.772, 'eval_steps_per_second': 33.205, 'epoch': 18.0}
{'loss': 0.007, 'learning_rate': 2.0833333333333334e-06, 'epoch': 19.0}
{'eval_loss': 0.24913068115711212, 'eval_precision': 0.5506937033084311, 'eval_recall': 0.5883694412770809, 'eval_f1': 0.5689084895259096, 'eval_accuracy': 0.9545279085926041, 'eval_runtime': 5.695, 'eval_samples_per_second': 268.832, 'eval_steps_per_second': 33.714, 'epoch': 19.0}
{'loss': 0.0063, 'learning_rate': 1.6666666666666667e-06, 'epoch': 20.0}
{'eval_loss': 0.25085121393203735, 'eval_precision': 0.5668571428571428, 'eval_recall': 0.5655644241733181, 'eval_f1': 0.5662100456621004, 'eval_accuracy': 0.9554157338068401, 'eval_runtime': 6.0385, 'eval_samples_per_second': 253.541, 'eval_steps_per_second': 31.796, 'epoch': 20.0}
{'loss': 0.0062, 'learning_rate': 1.25e-06, 'epoch': 21.0}
{'eval_loss': 0.2582078278064728, 'eval_precision': 0.5641891891891891, 'eval_recall': 0.5712656784492588, 'eval_f1': 0.5677053824362606, 'eval_accuracy': 0.9546823129776886, 'eval_runtime': 5.7973, 'eval_samples_per_second': 264.086, 'eval_steps_per_second': 33.119, 'epoch': 21.0}
{'loss': 0.0059, 'learning_rate': 8.333333333333333e-07, 'epoch': 22.0}
{'eval_loss': 0.25281092524528503, 'eval_precision': 0.5443037974683544, 'eval_recall': 0.5883694412770809, 'eval_f1': 0.5654794520547944, 'eval_accuracy': 0.9542190998224349, 'eval_runtime': 5.6988, 'eval_samples_per_second': 268.653, 'eval_steps_per_second': 33.691, 'epoch': 22.0}
{'loss': 0.0055, 'learning_rate': 4.1666666666666667e-07, 'epoch': 23.0}
{'eval_loss': 0.2583504021167755, 'eval_precision': 0.5591882750845547, 'eval_recall': 0.5655644241733181, 'eval_f1': 0.5623582766439909, 'eval_accuracy': 0.9546823129776886, 'eval_runtime': 5.9089, 'eval_samples_per_second': 259.1, 'eval_steps_per_second': 32.493, 'epoch': 23.0}
{'loss': 0.0052, 'learning_rate': 0.0, 'epoch': 24.0}
{'eval_loss': 0.2586096525192261, 'eval_precision': 0.55119825708061, 'eval_recall': 0.5769669327251995, 'eval_f1': 0.5637883008356547, 'eval_accuracy': 0.9544893074963329, 'eval_runtime': 6.1899, 'eval_samples_per_second': 247.338, 'eval_steps_per_second': 31.018, 'epoch': 24.0}
{'train_runtime': 2499.0856, 'train_samples_per_second': 82.917, 'train_steps_per_second': 1.296, 'train_loss': 0.09069211902441802, 'epoch': 24.0}
***** train metrics *****
  epoch                    =       24.0
  train_loss               =     0.0907
  train_runtime            = 0:41:39.08
  train_samples            =       8634
  train_samples_per_second =     82.917
  train_steps_per_second   =      1.296
[{'loss': 0.9341, 'learning_rate': 9.583333333333335e-06, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.4396754503250122, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7592, 'eval_samples_per_second': 265.833, 'eval_steps_per_second': 33.338, 'epoch': 1.0, 'step': 135}, {'loss': 0.311, 'learning_rate': 9.166666666666666e-06, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.22469975054264069, 'eval_precision': 0.18773006134969325, 'eval_recall': 0.17445838084378562, 'eval_f1': 0.1808510638297872, 'eval_accuracy': 0.9359993823824596, 'eval_runtime': 6.1353, 'eval_samples_per_second': 249.541, 'eval_steps_per_second': 31.295, 'epoch': 2.0, 'step': 270}, {'loss': 0.207, 'learning_rate': 8.750000000000001e-06, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.19555683434009552, 'eval_precision': 0.18792599805258034, 'eval_recall': 0.22006841505131128, 'eval_f1': 0.20273109243697476, 'eval_accuracy': 0.9392804755655061, 'eval_runtime': 6.2536, 'eval_samples_per_second': 244.819, 'eval_steps_per_second': 30.702, 'epoch': 3.0, 'step': 405}, {'loss': 0.1665, 'learning_rate': 8.333333333333334e-06, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.21089015901088715, 'eval_precision': 0.40229885057471265, 'eval_recall': 0.43899657924743446, 'eval_f1': 0.4198473282442748, 'eval_accuracy': 0.9441056125993978, 'eval_runtime': 5.9446, 'eval_samples_per_second': 257.546, 'eval_steps_per_second': 32.298, 'epoch': 4.0, 'step': 540}, {'loss': 0.1227, 'learning_rate': 7.916666666666667e-06, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.19540926814079285, 'eval_precision': 0.46347305389221555, 'eval_recall': 0.4412770809578107, 'eval_f1': 0.4521028037383178, 'eval_accuracy': 0.9491237551146453, 'eval_runtime': 5.7039, 'eval_samples_per_second': 268.411, 'eval_steps_per_second': 33.661, 'epoch': 5.0, 'step': 675}, {'loss': 0.0924, 'learning_rate': 7.500000000000001e-06, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.1968381404876709, 'eval_precision': 0.4454244762954796, 'eval_recall': 0.4606613454960091, 'eval_f1': 0.45291479820627806, 'eval_accuracy': 0.9472323013973597, 'eval_runtime': 5.7141, 'eval_samples_per_second': 267.932, 'eval_steps_per_second': 33.601, 'epoch': 6.0, 'step': 810}, {'loss': 0.0705, 'learning_rate': 7.083333333333335e-06, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.19038507342338562, 'eval_precision': 0.5191897654584222, 'eval_recall': 0.5553021664766249, 'eval_f1': 0.5366391184573004, 'eval_accuracy': 0.9540646954373504, 'eval_runtime': 5.7201, 'eval_samples_per_second': 267.653, 'eval_steps_per_second': 33.566, 'epoch': 7.0, 'step': 945}, {'loss': 0.0522, 'learning_rate': 6.666666666666667e-06, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.19844011962413788, 'eval_precision': 0.5526627218934911, 'eval_recall': 0.5324971493728621, 'eval_f1': 0.5423925667828106, 'eval_accuracy': 0.9549525206515865, 'eval_runtime': 6.0335, 'eval_samples_per_second': 253.749, 'eval_steps_per_second': 31.822, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0405, 'learning_rate': 6.25e-06, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.20267195999622345, 'eval_precision': 0.5288753799392097, 'eval_recall': 0.5952109464082098, 'eval_f1': 0.5600858369098713, 'eval_accuracy': 0.9527522581641319, 'eval_runtime': 6.2105, 'eval_samples_per_second': 246.519, 'eval_steps_per_second': 30.916, 'epoch': 9.0, 'step': 1215}, {'loss': 0.032, 'learning_rate': 5.833333333333334e-06, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.215815931558609, 'eval_precision': 0.5574365175332527, 'eval_recall': 0.5256556442417332, 'eval_f1': 0.5410798122065726, 'eval_accuracy': 0.9546823129776886, 'eval_runtime': 6.0713, 'eval_samples_per_second': 252.169, 'eval_steps_per_second': 31.624, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0252, 'learning_rate': 5.416666666666667e-06, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.2191992700099945, 'eval_precision': 0.5306345733041575, 'eval_recall': 0.5530216647662486, 'eval_f1': 0.5415968732551648, 'eval_accuracy': 0.9531768702231144, 'eval_runtime': 5.9663, 'eval_samples_per_second': 256.609, 'eval_steps_per_second': 32.181, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0201, 'learning_rate': 5e-06, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.2212022840976715, 'eval_precision': 0.5315904139433552, 'eval_recall': 0.556442417331813, 'eval_f1': 0.5437325905292479, 'eval_accuracy': 0.9534470778970123, 'eval_runtime': 5.8873, 'eval_samples_per_second': 260.053, 'eval_steps_per_second': 32.613, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0156, 'learning_rate': 4.583333333333333e-06, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.2305517941713333, 'eval_precision': 0.5397170837867247, 'eval_recall': 0.5655644241733181, 'eval_f1': 0.5523385300668151, 'eval_accuracy': 0.9542963020149772, 'eval_runtime': 5.9625, 'eval_samples_per_second': 256.772, 'eval_steps_per_second': 32.201, 'epoch': 13.0, 'step': 1755}, {'loss': 0.013, 'learning_rate': 4.166666666666667e-06, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.23357491195201874, 'eval_precision': 0.5640096618357487, 'eval_recall': 0.5324971493728621, 'eval_f1': 0.547800586510264, 'eval_accuracy': 0.9551455261329421, 'eval_runtime': 5.8922, 'eval_samples_per_second': 259.833, 'eval_steps_per_second': 32.585, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0113, 'learning_rate': 3.7500000000000005e-06, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.24167443811893463, 'eval_precision': 0.5455531453362256, 'eval_recall': 0.5735461801596351, 'eval_f1': 0.5591995553085046, 'eval_accuracy': 0.9545279085926041, 'eval_runtime': 5.8801, 'eval_samples_per_second': 260.371, 'eval_steps_per_second': 32.653, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0101, 'learning_rate': 3.3333333333333333e-06, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.24170301854610443, 'eval_precision': 0.5553072625698324, 'eval_recall': 0.5667046750285063, 'eval_f1': 0.5609480812641084, 'eval_accuracy': 0.9543349031112484, 'eval_runtime': 5.9034, 'eval_samples_per_second': 259.34, 'eval_steps_per_second': 32.523, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0085, 'learning_rate': 2.916666666666667e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.2461201399564743, 'eval_precision': 0.5553121577217963, 'eval_recall': 0.5781071835803877, 'eval_f1': 0.5664804469273743, 'eval_accuracy': 0.9548367173627731, 'eval_runtime': 5.6955, 'eval_samples_per_second': 268.811, 'eval_steps_per_second': 33.711, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0078, 'learning_rate': 2.5e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.24658577144145966, 'eval_precision': 0.5493107104984093, 'eval_recall': 0.5906499429874572, 'eval_f1': 0.5692307692307692, 'eval_accuracy': 0.9546437118814174, 'eval_runtime': 5.7823, 'eval_samples_per_second': 264.772, 'eval_steps_per_second': 33.205, 'epoch': 18.0, 'step': 2430}, {'loss': 0.007, 'learning_rate': 2.0833333333333334e-06, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.24913068115711212, 'eval_precision': 0.5506937033084311, 'eval_recall': 0.5883694412770809, 'eval_f1': 0.5689084895259096, 'eval_accuracy': 0.9545279085926041, 'eval_runtime': 5.695, 'eval_samples_per_second': 268.832, 'eval_steps_per_second': 33.714, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0063, 'learning_rate': 1.6666666666666667e-06, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.25085121393203735, 'eval_precision': 0.5668571428571428, 'eval_recall': 0.5655644241733181, 'eval_f1': 0.5662100456621004, 'eval_accuracy': 0.9554157338068401, 'eval_runtime': 6.0385, 'eval_samples_per_second': 253.541, 'eval_steps_per_second': 31.796, 'epoch': 20.0, 'step': 2700}, {'loss': 0.0062, 'learning_rate': 1.25e-06, 'epoch': 21.0, 'step': 2835}, {'eval_loss': 0.2582078278064728, 'eval_precision': 0.5641891891891891, 'eval_recall': 0.5712656784492588, 'eval_f1': 0.5677053824362606, 'eval_accuracy': 0.9546823129776886, 'eval_runtime': 5.7973, 'eval_samples_per_second': 264.086, 'eval_steps_per_second': 33.119, 'epoch': 21.0, 'step': 2835}, {'loss': 0.0059, 'learning_rate': 8.333333333333333e-07, 'epoch': 22.0, 'step': 2970}, {'eval_loss': 0.25281092524528503, 'eval_precision': 0.5443037974683544, 'eval_recall': 0.5883694412770809, 'eval_f1': 0.5654794520547944, 'eval_accuracy': 0.9542190998224349, 'eval_runtime': 5.6988, 'eval_samples_per_second': 268.653, 'eval_steps_per_second': 33.691, 'epoch': 22.0, 'step': 2970}, {'loss': 0.0055, 'learning_rate': 4.1666666666666667e-07, 'epoch': 23.0, 'step': 3105}, {'eval_loss': 0.2583504021167755, 'eval_precision': 0.5591882750845547, 'eval_recall': 0.5655644241733181, 'eval_f1': 0.5623582766439909, 'eval_accuracy': 0.9546823129776886, 'eval_runtime': 5.9089, 'eval_samples_per_second': 259.1, 'eval_steps_per_second': 32.493, 'epoch': 23.0, 'step': 3105}, {'loss': 0.0052, 'learning_rate': 0.0, 'epoch': 24.0, 'step': 3240}, {'eval_loss': 0.2586096525192261, 'eval_precision': 0.55119825708061, 'eval_recall': 0.5769669327251995, 'eval_f1': 0.5637883008356547, 'eval_accuracy': 0.9544893074963329, 'eval_runtime': 6.1899, 'eval_samples_per_second': 247.338, 'eval_steps_per_second': 31.018, 'epoch': 24.0, 'step': 3240}, {'train_runtime': 2499.0856, 'train_samples_per_second': 82.917, 'train_steps_per_second': 1.296, 'total_flos': 2.705738887944774e+16, 'train_loss': 0.09069211902441802, 'epoch': 24.0, 'step': 3240}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9533
  predict_f1                 =     0.5104
  predict_loss               =     0.1971
  predict_precision          =     0.5013
  predict_recall             =     0.5197
  predict_runtime            = 0:00:05.15
  predict_samples_per_second =    246.989
  predict_steps_per_second   =     30.874
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01191518_tsa-bin_NorBERT_3_large_37_b.json completed. F1: 0.5103540414161657

Task and CPU usage stats:
JobID           JobName  AllocCPUS   NTasks     MinCPU MinCPUTask     AveCPU    Elapsed ExitCode 
------------ ---------- ---------- -------- ---------- ---------- ---------- ---------- -------- 
426954       tsa_norbe+          1                                             00:42:25      0:0 
426954.batch      batch          1        1   00:41:40          0   00:41:40   00:42:25      0:0 
426954.exte+     extern          1        1   00:00:00          0   00:00:00   00:42:25      0:0 

Memory usage stats:
JobID            MaxRSS MaxRSSTask     AveRSS MaxPages   MaxPagesTask   AvePages 
------------ ---------- ---------- ---------- -------- -------------- ---------- 
426954                                                                           
426954.batch   3431460K          0   3431460K        0              0          0 
426954.exte+          0          0          0        0              0          0 

Disk usage stats:
JobID         MaxDiskRead MaxDiskReadTask    AveDiskRead MaxDiskWrite MaxDiskWriteTask   AveDiskWrite 
------------ ------------ --------------- -------------- ------------ ---------------- -------------- 
426954                                                                                                
426954.batch     1910.35M               0       1910.35M    94440.19M                0      94440.19M 
426954.exte+        0.01M               0          0.01M        0.00M                0          0.00M 

GPU usage stats:
Successfully retrieved statistics for job: 426954. 
+------------------------------------------------------------------------------+
| GPU ID: 1                                                                    |
+====================================+=========================================+
|-----  Execution Stats  ------------+-----------------------------------------|
| Start Time                         | Wed Feb  7 09:38:01 2024                |
| End Time                           | Wed Feb  7 10:20:25 2024                |
| Total Execution Time (sec)         | 2544.01                                 |
| No. of Processes                   | 1                                       |
+-----  Performance Stats  ----------+-----------------------------------------+
| Energy Consumed (Joules)           | 445615                                  |
| Power Usage (Watts)                | Avg: 165.687, Max: 359.42, Min: 70.126  |
| Max GPU Memory Used (bytes)        | 33801895936                             |
| SM Clock (MHz)                     | Avg: 1367, Max: 1410, Min: 1215         |
| Memory Clock (MHz)                 | Avg: 1512, Max: 1512, Min: 1512         |
| SM Utilization (%)                 | Avg: 52, Max: 100, Min: 0               |
| Memory Utilization (%)             | Avg: 17, Max: 38, Min: 0                |
| PCIe Rx Bandwidth (megabytes)      | Avg: N/A, Max: N/A, Min: N/A            |
| PCIe Tx Bandwidth (megabytes)      | Avg: N/A, Max: N/A, Min: N/A            |
+-----  Event Stats  ----------------+-----------------------------------------+
| Single Bit ECC Errors              | 0                                       |
| Double Bit ECC Errors              | 0                                       |
| PCIe Replay Warnings               | 0                                       |
| Critical XID Errors                | 0                                       |
+-----  Slowdown Stats  -------------+-----------------------------------------+
| Due to - Power (%)                 | 0                                       |
|        - Thermal (%)               | 0                                       |
|        - Reliability (%)           | Not Supported                           |
|        - Board Limit (%)           | Not Supported                           |
|        - Low Utilization (%)       | Not Supported                           |
|        - Sync Boost (%)            | 0                                       |
+--  Compute Process Utilization  ---+-----------------------------------------+
| PID                                | 1586202                                 |
|     Avg SM Utilization (%)         | 48                                      |
|     Avg Memory Utilization (%)     | 16                                      |
+-----  Overall Health  -------------+-----------------------------------------+
| Overall Health                     | Healthy                                 |
+------------------------------------+-----------------------------------------+


Job 426954 completed at Wed Feb 7 10:20:25 CET 2024
