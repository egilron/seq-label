Starting job 409165 on gpu-7 at Mon Jan 15 10:59:04 CET 2024

/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_14.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_14.json
config.json:   0%|          | 0.00/948 [00:00<?, ?B/s]config.json: 100%|██████████| 948/948 [00:00<00:00, 9.25MB/s]
configuration_norbert.py:   0%|          | 0.00/1.23k [00:00<?, ?B/s]configuration_norbert.py: 100%|██████████| 1.23k/1.23k [00:00<00:00, 14.9MB/s]
tokenizer_config.json:   0%|          | 0.00/51.0 [00:00<?, ?B/s]tokenizer_config.json: 100%|██████████| 51.0/51.0 [00:00<00:00, 604kB/s]
tokenizer.json:   0%|          | 0.00/1.26M [00:00<?, ?B/s]tokenizer.json: 100%|██████████| 1.26M/1.26M [00:00<00:00, 12.2MB/s]tokenizer.json: 100%|██████████| 1.26M/1.26M [00:00<00:00, 12.2MB/s]
special_tokens_map.json:   0%|          | 0.00/157 [00:00<?, ?B/s]special_tokens_map.json: 100%|██████████| 157/157 [00:00<00:00, 937kB/s]
pytorch_model.bin:   0%|          | 0.00/85.3M [00:00<?, ?B/s]pytorch_model.bin:  12%|█▏        | 10.5M/85.3M [00:00<00:06, 11.3MB/s]pytorch_model.bin:  25%|██▍       | 21.0M/85.3M [00:01<00:03, 20.5MB/s]pytorch_model.bin:  37%|███▋      | 31.5M/85.3M [00:01<00:01, 27.1MB/s]pytorch_model.bin:  49%|████▉     | 41.9M/85.3M [00:01<00:01, 31.2MB/s]pytorch_model.bin:  61%|██████▏   | 52.4M/85.3M [00:01<00:00, 33.0MB/s]pytorch_model.bin:  74%|███████▍  | 62.9M/85.3M [00:02<00:00, 34.7MB/s]pytorch_model.bin:  86%|████████▌ | 73.4M/85.3M [00:02<00:00, 38.6MB/s]pytorch_model.bin:  98%|█████████▊| 83.9M/85.3M [00:02<00:00, 38.7MB/s]pytorch_model.bin: 100%|██████████| 85.3M/85.3M [00:02<00:00, 31.1MB/s]
01150927_tsa-bin_NorBERT_3_x-small Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5775.05 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6676.16 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6742.54 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6905.11 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 7021.60 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7156.10 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7350.19 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 7439.59 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6766.21 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7444.58 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7057.40 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7126.19 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6980.80 examples/s]
Downloading builder script:   0%|          | 0.00/6.34k [00:00<?, ?B/s]Downloading builder script: 100%|██████████| 6.34k/6.34k [00:00<00:00, 40.1MB/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_x-small Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0071, 'eval_samples_per_second': 509.131, 'eval_steps_per_second': 63.849, 'epoch': 1.0}
{'loss': 0.0, 'learning_rate': 9e-07, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9907, 'eval_samples_per_second': 511.92, 'eval_steps_per_second': 64.199, 'epoch': 2.0}
{'loss': 0.0, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9896, 'eval_samples_per_second': 512.1, 'eval_steps_per_second': 64.222, 'epoch': 3.0}
{'loss': 0.0, 'learning_rate': 8e-07, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9847, 'eval_samples_per_second': 512.944, 'eval_steps_per_second': 64.327, 'epoch': 4.0}
{'loss': 0.0, 'learning_rate': 7.5e-07, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.987, 'eval_samples_per_second': 512.554, 'eval_steps_per_second': 64.278, 'epoch': 5.0}
{'loss': 0.0, 'learning_rate': 7e-07, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.986, 'eval_samples_per_second': 512.727, 'eval_steps_per_second': 64.3, 'epoch': 6.0}
{'loss': 0.0, 'learning_rate': 6.5e-07, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9879, 'eval_samples_per_second': 512.407, 'eval_steps_per_second': 64.26, 'epoch': 7.0}
{'loss': 0.0, 'learning_rate': 6e-07, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9891, 'eval_samples_per_second': 512.196, 'eval_steps_per_second': 64.234, 'epoch': 8.0}
{'loss': 0.0, 'learning_rate': 5.5e-07, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9804, 'eval_samples_per_second': 513.695, 'eval_steps_per_second': 64.422, 'epoch': 9.0}
{'loss': 0.0, 'learning_rate': 5e-07, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0637, 'eval_samples_per_second': 499.727, 'eval_steps_per_second': 62.67, 'epoch': 10.0}
{'loss': 0.0, 'learning_rate': 4.5e-07, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.984, 'eval_samples_per_second': 513.072, 'eval_steps_per_second': 64.343, 'epoch': 11.0}
{'loss': 0.0, 'learning_rate': 4e-07, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9927, 'eval_samples_per_second': 511.579, 'eval_steps_per_second': 64.156, 'epoch': 12.0}
{'loss': 0.0, 'learning_rate': 3.5e-07, 'epoch': 13.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9733, 'eval_samples_per_second': 514.914, 'eval_steps_per_second': 64.574, 'epoch': 13.0}
{'loss': 0.0, 'learning_rate': 3e-07, 'epoch': 14.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9709, 'eval_samples_per_second': 515.326, 'eval_steps_per_second': 64.626, 'epoch': 14.0}
{'loss': 0.0, 'learning_rate': 2.5e-07, 'epoch': 15.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9746, 'eval_samples_per_second': 514.687, 'eval_steps_per_second': 64.546, 'epoch': 15.0}
{'loss': 0.0, 'learning_rate': 2e-07, 'epoch': 16.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9848, 'eval_samples_per_second': 512.94, 'eval_steps_per_second': 64.327, 'epoch': 16.0}
{'loss': 0.0, 'learning_rate': 1.5e-07, 'epoch': 17.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9814, 'eval_samples_per_second': 513.517, 'eval_steps_per_second': 64.399, 'epoch': 17.0}
{'loss': 0.0, 'learning_rate': 1e-07, 'epoch': 18.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9875, 'eval_samples_per_second': 512.466, 'eval_steps_per_second': 64.267, 'epoch': 18.0}
{'loss': 0.0, 'learning_rate': 5e-08, 'epoch': 19.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9917, 'eval_samples_per_second': 511.747, 'eval_steps_per_second': 64.177, 'epoch': 19.0}
{'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9861, 'eval_samples_per_second': 512.708, 'eval_steps_per_second': 64.298, 'epoch': 20.0}
{'train_runtime': 241.8499, 'train_samples_per_second': 713.997, 'train_steps_per_second': 11.164, 'train_loss': 0.0, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =        0.0
  train_runtime            = 0:04:01.84
  train_samples            =       8634
  train_samples_per_second =    713.997
  train_steps_per_second   =     11.164
[{'loss': 0.0, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0, 'step': 135}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0071, 'eval_samples_per_second': 509.131, 'eval_steps_per_second': 63.849, 'epoch': 1.0, 'step': 135}, {'loss': 0.0, 'learning_rate': 9e-07, 'epoch': 2.0, 'step': 270}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9907, 'eval_samples_per_second': 511.92, 'eval_steps_per_second': 64.199, 'epoch': 2.0, 'step': 270}, {'loss': 0.0, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0, 'step': 405}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9896, 'eval_samples_per_second': 512.1, 'eval_steps_per_second': 64.222, 'epoch': 3.0, 'step': 405}, {'loss': 0.0, 'learning_rate': 8e-07, 'epoch': 4.0, 'step': 540}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9847, 'eval_samples_per_second': 512.944, 'eval_steps_per_second': 64.327, 'epoch': 4.0, 'step': 540}, {'loss': 0.0, 'learning_rate': 7.5e-07, 'epoch': 5.0, 'step': 675}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.987, 'eval_samples_per_second': 512.554, 'eval_steps_per_second': 64.278, 'epoch': 5.0, 'step': 675}, {'loss': 0.0, 'learning_rate': 7e-07, 'epoch': 6.0, 'step': 810}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.986, 'eval_samples_per_second': 512.727, 'eval_steps_per_second': 64.3, 'epoch': 6.0, 'step': 810}, {'loss': 0.0, 'learning_rate': 6.5e-07, 'epoch': 7.0, 'step': 945}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9879, 'eval_samples_per_second': 512.407, 'eval_steps_per_second': 64.26, 'epoch': 7.0, 'step': 945}, {'loss': 0.0, 'learning_rate': 6e-07, 'epoch': 8.0, 'step': 1080}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9891, 'eval_samples_per_second': 512.196, 'eval_steps_per_second': 64.234, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0, 'learning_rate': 5.5e-07, 'epoch': 9.0, 'step': 1215}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9804, 'eval_samples_per_second': 513.695, 'eval_steps_per_second': 64.422, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0, 'learning_rate': 5e-07, 'epoch': 10.0, 'step': 1350}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0637, 'eval_samples_per_second': 499.727, 'eval_steps_per_second': 62.67, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0, 'learning_rate': 4.5e-07, 'epoch': 11.0, 'step': 1485}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.984, 'eval_samples_per_second': 513.072, 'eval_steps_per_second': 64.343, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0, 'learning_rate': 4e-07, 'epoch': 12.0, 'step': 1620}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9927, 'eval_samples_per_second': 511.579, 'eval_steps_per_second': 64.156, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0, 'learning_rate': 3.5e-07, 'epoch': 13.0, 'step': 1755}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9733, 'eval_samples_per_second': 514.914, 'eval_steps_per_second': 64.574, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0, 'learning_rate': 3e-07, 'epoch': 14.0, 'step': 1890}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9709, 'eval_samples_per_second': 515.326, 'eval_steps_per_second': 64.626, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0, 'learning_rate': 2.5e-07, 'epoch': 15.0, 'step': 2025}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9746, 'eval_samples_per_second': 514.687, 'eval_steps_per_second': 64.546, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0, 'learning_rate': 2e-07, 'epoch': 16.0, 'step': 2160}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9848, 'eval_samples_per_second': 512.94, 'eval_steps_per_second': 64.327, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0, 'learning_rate': 1.5e-07, 'epoch': 17.0, 'step': 2295}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9814, 'eval_samples_per_second': 513.517, 'eval_steps_per_second': 64.399, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0, 'learning_rate': 1e-07, 'epoch': 18.0, 'step': 2430}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9875, 'eval_samples_per_second': 512.466, 'eval_steps_per_second': 64.267, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0, 'learning_rate': 5e-08, 'epoch': 19.0, 'step': 2565}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9917, 'eval_samples_per_second': 511.747, 'eval_steps_per_second': 64.177, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9861, 'eval_samples_per_second': 512.708, 'eval_steps_per_second': 64.298, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 241.8499, 'train_samples_per_second': 713.997, 'train_steps_per_second': 11.164, 'total_flos': 399234715456896.0, 'train_loss': 0.0, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-xs
***** predict metrics *****
  predict_accuracy           =     0.9327
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:02.49
  predict_samples_per_second =     510.23
  predict_steps_per_second   =     63.779
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_14.json completed. F1: 0.0
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_15.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_15.json
config.json:   0%|          | 0.00/949 [00:00<?, ?B/s]config.json: 100%|██████████| 949/949 [00:00<00:00, 8.85MB/s]
configuration_norbert.py:   0%|          | 0.00/1.23k [00:00<?, ?B/s]configuration_norbert.py: 100%|██████████| 1.23k/1.23k [00:00<00:00, 14.4MB/s]
tokenizer_config.json:   0%|          | 0.00/51.0 [00:00<?, ?B/s]tokenizer_config.json: 100%|██████████| 51.0/51.0 [00:00<00:00, 539kB/s]
tokenizer.json:   0%|          | 0.00/1.26M [00:00<?, ?B/s]tokenizer.json: 100%|██████████| 1.26M/1.26M [00:00<00:00, 6.31MB/s]tokenizer.json: 100%|██████████| 1.26M/1.26M [00:00<00:00, 6.30MB/s]
special_tokens_map.json:   0%|          | 0.00/157 [00:00<?, ?B/s]special_tokens_map.json: 100%|██████████| 157/157 [00:00<00:00, 1.88MB/s]
pytorch_model.bin:   0%|          | 0.00/188M [00:00<?, ?B/s]pytorch_model.bin:   6%|▌         | 10.5M/188M [00:00<00:14, 12.6MB/s]pytorch_model.bin:  11%|█         | 21.0M/188M [00:01<00:07, 22.1MB/s]pytorch_model.bin:  17%|█▋        | 31.5M/188M [00:01<00:05, 28.0MB/s]pytorch_model.bin:  22%|██▏       | 41.9M/188M [00:01<00:04, 31.4MB/s]pytorch_model.bin:  28%|██▊       | 52.4M/188M [00:01<00:03, 36.3MB/s]pytorch_model.bin:  33%|███▎      | 62.9M/188M [00:02<00:03, 36.9MB/s]pytorch_model.bin:  39%|███▉      | 73.4M/188M [00:02<00:03, 37.6MB/s]pytorch_model.bin:  45%|████▍     | 83.9M/188M [00:02<00:02, 40.8MB/s]pytorch_model.bin:  50%|█████     | 94.4M/188M [00:02<00:02, 40.3MB/s]pytorch_model.bin:  56%|█████▌    | 105M/188M [00:03<00:02, 39.9MB/s] pytorch_model.bin:  61%|██████▏   | 115M/188M [00:03<00:01, 39.3MB/s]pytorch_model.bin:  67%|██████▋   | 126M/188M [00:03<00:01, 42.1MB/s]pytorch_model.bin:  73%|███████▎  | 136M/188M [00:03<00:01, 41.0MB/s]pytorch_model.bin:  78%|███████▊  | 147M/188M [00:04<00:01, 40.3MB/s]pytorch_model.bin:  84%|████████▎ | 157M/188M [00:04<00:00, 42.9MB/s]pytorch_model.bin:  89%|████████▉ | 168M/188M [00:04<00:00, 41.7MB/s]pytorch_model.bin:  95%|█████████▍| 178M/188M [00:04<00:00, 40.5MB/s]pytorch_model.bin: 100%|██████████| 188M/188M [00:05<00:00, 42.4MB/s]pytorch_model.bin: 100%|██████████| 188M/188M [00:05<00:00, 37.1MB/s]
01150927_tsa-bin_NorBERT_3_small Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6175.18 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6851.92 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6764.33 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6857.99 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6913.73 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7068.58 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7232.48 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 7308.59 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6710.26 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7228.54 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6923.22 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7008.74 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6851.16 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_small Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 1.5764, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0}
{'eval_loss': 1.5389617681503296, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0102, 'eval_samples_per_second': 508.611, 'eval_steps_per_second': 63.784, 'epoch': 1.0}
{'loss': 1.5053, 'learning_rate': 9e-07, 'epoch': 2.0}
{'eval_loss': 1.4715750217437744, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9653, 'eval_samples_per_second': 516.311, 'eval_steps_per_second': 64.75, 'epoch': 2.0}
{'loss': 1.4411, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0}
{'eval_loss': 1.4098857641220093, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9691, 'eval_samples_per_second': 515.643, 'eval_steps_per_second': 64.666, 'epoch': 3.0}
{'loss': 1.3821, 'learning_rate': 8e-07, 'epoch': 4.0}
{'eval_loss': 1.3532605171203613, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9657, 'eval_samples_per_second': 516.243, 'eval_steps_per_second': 64.741, 'epoch': 4.0}
{'loss': 1.3281, 'learning_rate': 7.5e-07, 'epoch': 5.0}
{'eval_loss': 1.301388144493103, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9838, 'eval_samples_per_second': 513.111, 'eval_steps_per_second': 64.348, 'epoch': 5.0}
{'loss': 1.2787, 'learning_rate': 7e-07, 'epoch': 6.0}
{'eval_loss': 1.2540260553359985, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9687, 'eval_samples_per_second': 515.708, 'eval_steps_per_second': 64.674, 'epoch': 6.0}
{'loss': 1.2336, 'learning_rate': 6.5e-07, 'epoch': 7.0}
{'eval_loss': 1.2109609842300415, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9852, 'eval_samples_per_second': 512.861, 'eval_steps_per_second': 64.317, 'epoch': 7.0}
{'loss': 1.1926, 'learning_rate': 6e-07, 'epoch': 8.0}
{'eval_loss': 1.1719874143600464, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9904, 'eval_samples_per_second': 511.965, 'eval_steps_per_second': 64.205, 'epoch': 8.0}
{'loss': 1.1557, 'learning_rate': 5.5e-07, 'epoch': 9.0}
{'eval_loss': 1.1369097232818604, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9648, 'eval_samples_per_second': 516.397, 'eval_steps_per_second': 64.76, 'epoch': 9.0}
{'loss': 1.1227, 'learning_rate': 5e-07, 'epoch': 10.0}
{'eval_loss': 1.10554838180542, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0436, 'eval_samples_per_second': 503.026, 'eval_steps_per_second': 63.084, 'epoch': 10.0}
{'loss': 1.0931, 'learning_rate': 4.5e-07, 'epoch': 11.0}
{'eval_loss': 1.0777256488800049, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9693, 'eval_samples_per_second': 515.605, 'eval_steps_per_second': 64.661, 'epoch': 11.0}
{'loss': 1.0671, 'learning_rate': 4e-07, 'epoch': 12.0}
{'eval_loss': 1.0532820224761963, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9817, 'eval_samples_per_second': 513.465, 'eval_steps_per_second': 64.393, 'epoch': 12.0}
{'loss': 1.0445, 'learning_rate': 3.5e-07, 'epoch': 13.0}
{'eval_loss': 1.0320713520050049, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9737, 'eval_samples_per_second': 514.849, 'eval_steps_per_second': 64.566, 'epoch': 13.0}
{'loss': 1.0249, 'learning_rate': 3e-07, 'epoch': 14.0}
{'eval_loss': 1.0139609575271606, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0057, 'eval_samples_per_second': 509.372, 'eval_steps_per_second': 63.879, 'epoch': 14.0}
{'loss': 1.0083, 'learning_rate': 2.5e-07, 'epoch': 15.0}
{'eval_loss': 0.998836874961853, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9868, 'eval_samples_per_second': 512.582, 'eval_steps_per_second': 64.282, 'epoch': 15.0}
{'loss': 0.9946, 'learning_rate': 2e-07, 'epoch': 16.0}
{'eval_loss': 0.9865970611572266, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0091, 'eval_samples_per_second': 508.793, 'eval_steps_per_second': 63.807, 'epoch': 16.0}
{'loss': 0.9838, 'learning_rate': 1.5e-07, 'epoch': 17.0}
{'eval_loss': 0.9771617650985718, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9845, 'eval_samples_per_second': 512.984, 'eval_steps_per_second': 64.332, 'epoch': 17.0}
{'loss': 0.976, 'learning_rate': 1e-07, 'epoch': 18.0}
{'eval_loss': 0.9704648852348328, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9761, 'eval_samples_per_second': 514.438, 'eval_steps_per_second': 64.515, 'epoch': 18.0}
{'loss': 0.9702, 'learning_rate': 5e-08, 'epoch': 19.0}
{'eval_loss': 0.9664613008499146, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9846, 'eval_samples_per_second': 512.975, 'eval_steps_per_second': 64.331, 'epoch': 19.0}
{'loss': 0.9677, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.9651231169700623, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.98, 'eval_samples_per_second': 513.758, 'eval_steps_per_second': 64.429, 'epoch': 20.0}
{'train_runtime': 343.9291, 'train_samples_per_second': 502.08, 'train_steps_per_second': 7.85, 'train_loss': 1.167333809181496, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     1.1673
  train_runtime            = 0:05:43.92
  train_samples            =       8634
  train_samples_per_second =     502.08
  train_steps_per_second   =       7.85
[{'loss': 1.5764, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0, 'step': 135}, {'eval_loss': 1.5389617681503296, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0102, 'eval_samples_per_second': 508.611, 'eval_steps_per_second': 63.784, 'epoch': 1.0, 'step': 135}, {'loss': 1.5053, 'learning_rate': 9e-07, 'epoch': 2.0, 'step': 270}, {'eval_loss': 1.4715750217437744, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9653, 'eval_samples_per_second': 516.311, 'eval_steps_per_second': 64.75, 'epoch': 2.0, 'step': 270}, {'loss': 1.4411, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0, 'step': 405}, {'eval_loss': 1.4098857641220093, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9691, 'eval_samples_per_second': 515.643, 'eval_steps_per_second': 64.666, 'epoch': 3.0, 'step': 405}, {'loss': 1.3821, 'learning_rate': 8e-07, 'epoch': 4.0, 'step': 540}, {'eval_loss': 1.3532605171203613, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9657, 'eval_samples_per_second': 516.243, 'eval_steps_per_second': 64.741, 'epoch': 4.0, 'step': 540}, {'loss': 1.3281, 'learning_rate': 7.5e-07, 'epoch': 5.0, 'step': 675}, {'eval_loss': 1.301388144493103, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9838, 'eval_samples_per_second': 513.111, 'eval_steps_per_second': 64.348, 'epoch': 5.0, 'step': 675}, {'loss': 1.2787, 'learning_rate': 7e-07, 'epoch': 6.0, 'step': 810}, {'eval_loss': 1.2540260553359985, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9687, 'eval_samples_per_second': 515.708, 'eval_steps_per_second': 64.674, 'epoch': 6.0, 'step': 810}, {'loss': 1.2336, 'learning_rate': 6.5e-07, 'epoch': 7.0, 'step': 945}, {'eval_loss': 1.2109609842300415, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9852, 'eval_samples_per_second': 512.861, 'eval_steps_per_second': 64.317, 'epoch': 7.0, 'step': 945}, {'loss': 1.1926, 'learning_rate': 6e-07, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 1.1719874143600464, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9904, 'eval_samples_per_second': 511.965, 'eval_steps_per_second': 64.205, 'epoch': 8.0, 'step': 1080}, {'loss': 1.1557, 'learning_rate': 5.5e-07, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 1.1369097232818604, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9648, 'eval_samples_per_second': 516.397, 'eval_steps_per_second': 64.76, 'epoch': 9.0, 'step': 1215}, {'loss': 1.1227, 'learning_rate': 5e-07, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 1.10554838180542, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0436, 'eval_samples_per_second': 503.026, 'eval_steps_per_second': 63.084, 'epoch': 10.0, 'step': 1350}, {'loss': 1.0931, 'learning_rate': 4.5e-07, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 1.0777256488800049, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9693, 'eval_samples_per_second': 515.605, 'eval_steps_per_second': 64.661, 'epoch': 11.0, 'step': 1485}, {'loss': 1.0671, 'learning_rate': 4e-07, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 1.0532820224761963, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9817, 'eval_samples_per_second': 513.465, 'eval_steps_per_second': 64.393, 'epoch': 12.0, 'step': 1620}, {'loss': 1.0445, 'learning_rate': 3.5e-07, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 1.0320713520050049, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9737, 'eval_samples_per_second': 514.849, 'eval_steps_per_second': 64.566, 'epoch': 13.0, 'step': 1755}, {'loss': 1.0249, 'learning_rate': 3e-07, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 1.0139609575271606, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0057, 'eval_samples_per_second': 509.372, 'eval_steps_per_second': 63.879, 'epoch': 14.0, 'step': 1890}, {'loss': 1.0083, 'learning_rate': 2.5e-07, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.998836874961853, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9868, 'eval_samples_per_second': 512.582, 'eval_steps_per_second': 64.282, 'epoch': 15.0, 'step': 2025}, {'loss': 0.9946, 'learning_rate': 2e-07, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.9865970611572266, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0091, 'eval_samples_per_second': 508.793, 'eval_steps_per_second': 63.807, 'epoch': 16.0, 'step': 2160}, {'loss': 0.9838, 'learning_rate': 1.5e-07, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.9771617650985718, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9845, 'eval_samples_per_second': 512.984, 'eval_steps_per_second': 64.332, 'epoch': 17.0, 'step': 2295}, {'loss': 0.976, 'learning_rate': 1e-07, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.9704648852348328, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9761, 'eval_samples_per_second': 514.438, 'eval_steps_per_second': 64.515, 'epoch': 18.0, 'step': 2430}, {'loss': 0.9702, 'learning_rate': 5e-08, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.9664613008499146, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9846, 'eval_samples_per_second': 512.975, 'eval_steps_per_second': 64.331, 'epoch': 19.0, 'step': 2565}, {'loss': 0.9677, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.9651231169700623, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.98, 'eval_samples_per_second': 513.758, 'eval_steps_per_second': 64.429, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 343.9291, 'train_samples_per_second': 502.08, 'train_steps_per_second': 7.85, 'total_flos': 1592857376191872.0, 'train_loss': 1.167333809181496, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-small
***** predict metrics *****
  predict_accuracy           =     0.9327
  predict_f1                 =        0.0
  predict_loss               =     0.9661
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:02.47
  predict_samples_per_second =    512.999
  predict_steps_per_second   =     64.125
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_15.json completed. F1: 0.0
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_16.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_16.json
config.json:   0%|          | 0.00/950 [00:00<?, ?B/s]config.json: 100%|██████████| 950/950 [00:00<00:00, 5.26MB/s]
configuration_norbert.py:   0%|          | 0.00/1.23k [00:00<?, ?B/s]configuration_norbert.py: 100%|██████████| 1.23k/1.23k [00:00<00:00, 14.8MB/s]
tokenizer_config.json:   0%|          | 0.00/51.0 [00:00<?, ?B/s]tokenizer_config.json: 100%|██████████| 51.0/51.0 [00:00<00:00, 598kB/s]
tokenizer.json:   0%|          | 0.00/1.26M [00:00<?, ?B/s]tokenizer.json: 100%|██████████| 1.26M/1.26M [00:00<00:00, 4.15MB/s]tokenizer.json: 100%|██████████| 1.26M/1.26M [00:00<00:00, 4.15MB/s]
special_tokens_map.json:   0%|          | 0.00/157 [00:00<?, ?B/s]special_tokens_map.json: 100%|██████████| 157/157 [00:00<00:00, 1.91MB/s]
pytorch_model.bin:   0%|          | 0.00/522M [00:00<?, ?B/s]pytorch_model.bin:   2%|▏         | 10.5M/522M [00:00<00:07, 64.1MB/s]pytorch_model.bin:   4%|▍         | 21.0M/522M [00:00<00:06, 76.1MB/s]pytorch_model.bin:   8%|▊         | 41.9M/522M [00:00<00:05, 95.8MB/s]pytorch_model.bin:  12%|█▏        | 62.9M/522M [00:00<00:04, 104MB/s] pytorch_model.bin:  16%|█▌        | 83.9M/522M [00:00<00:04, 108MB/s]pytorch_model.bin:  20%|██        | 105M/522M [00:01<00:03, 112MB/s] pytorch_model.bin:  24%|██▍       | 126M/522M [00:01<00:03, 113MB/s]pytorch_model.bin:  28%|██▊       | 147M/522M [00:01<00:03, 115MB/s]pytorch_model.bin:  32%|███▏      | 168M/522M [00:01<00:03, 115MB/s]pytorch_model.bin:  36%|███▌      | 189M/522M [00:01<00:02, 116MB/s]pytorch_model.bin:  40%|████      | 210M/522M [00:01<00:02, 116MB/s]pytorch_model.bin:  44%|████▍     | 231M/522M [00:02<00:02, 117MB/s]pytorch_model.bin:  48%|████▊     | 252M/522M [00:02<00:02, 117MB/s]pytorch_model.bin:  52%|█████▏    | 273M/522M [00:02<00:02, 117MB/s]pytorch_model.bin:  56%|█████▋    | 294M/522M [00:02<00:01, 116MB/s]pytorch_model.bin:  60%|██████    | 315M/522M [00:02<00:01, 116MB/s]pytorch_model.bin:  64%|██████▍   | 336M/522M [00:02<00:01, 116MB/s]pytorch_model.bin:  68%|██████▊   | 357M/522M [00:03<00:01, 116MB/s]pytorch_model.bin:  72%|███████▏  | 377M/522M [00:03<00:01, 117MB/s]pytorch_model.bin:  76%|███████▋  | 398M/522M [00:03<00:01, 117MB/s]pytorch_model.bin:  80%|████████  | 419M/522M [00:03<00:00, 117MB/s]pytorch_model.bin:  84%|████████▍ | 440M/522M [00:03<00:00, 117MB/s]pytorch_model.bin:  88%|████████▊ | 461M/522M [00:04<00:00, 117MB/s]pytorch_model.bin:  92%|█████████▏| 482M/522M [00:04<00:00, 117MB/s]pytorch_model.bin:  97%|█████████▋| 503M/522M [00:04<00:00, 117MB/s]pytorch_model.bin: 100%|██████████| 522M/522M [00:04<00:00, 117MB/s]pytorch_model.bin: 100%|██████████| 522M/522M [00:04<00:00, 114MB/s]
01150927_tsa-bin_NorBERT_3_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5388.45 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:01, 6432.24 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6560.27 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6743.72 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6872.47 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7037.96 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 7226.01 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 7312.36 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6627.16 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7354.58 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7007.76 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7003.73 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6846.08 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 1.5646, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0}
{'eval_loss': 1.4926880598068237, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0275, 'eval_samples_per_second': 505.698, 'eval_steps_per_second': 63.419, 'epoch': 1.0}
{'loss': 1.4228, 'learning_rate': 9e-07, 'epoch': 2.0}
{'eval_loss': 1.3568943738937378, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9882, 'eval_samples_per_second': 512.354, 'eval_steps_per_second': 64.253, 'epoch': 2.0}
{'loss': 1.3018, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0}
{'eval_loss': 1.2466591596603394, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9992, 'eval_samples_per_second': 510.476, 'eval_steps_per_second': 64.018, 'epoch': 3.0}
{'loss': 1.1999, 'learning_rate': 8e-07, 'epoch': 4.0}
{'eval_loss': 1.1517466306686401, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9994, 'eval_samples_per_second': 510.443, 'eval_steps_per_second': 64.014, 'epoch': 4.0}
{'loss': 1.1114, 'learning_rate': 7.5e-07, 'epoch': 5.0}
{'eval_loss': 1.0686818361282349, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9993, 'eval_samples_per_second': 510.46, 'eval_steps_per_second': 64.016, 'epoch': 5.0}
{'loss': 1.0339, 'learning_rate': 7e-07, 'epoch': 6.0}
{'eval_loss': 0.9957486391067505, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9876, 'eval_samples_per_second': 512.456, 'eval_steps_per_second': 64.266, 'epoch': 6.0}
{'loss': 0.9656, 'learning_rate': 6.5e-07, 'epoch': 7.0}
{'eval_loss': 0.9317953586578369, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9884, 'eval_samples_per_second': 512.318, 'eval_steps_per_second': 64.249, 'epoch': 7.0}
{'loss': 0.9058, 'learning_rate': 6e-07, 'epoch': 8.0}
{'eval_loss': 0.8759154677391052, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9932, 'eval_samples_per_second': 511.497, 'eval_steps_per_second': 64.146, 'epoch': 8.0}
{'loss': 0.854, 'learning_rate': 5.5e-07, 'epoch': 9.0}
{'eval_loss': 0.8273189067840576, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9841, 'eval_samples_per_second': 513.047, 'eval_steps_per_second': 64.34, 'epoch': 9.0}
{'loss': 0.809, 'learning_rate': 5e-07, 'epoch': 10.0}
{'eval_loss': 0.7853054404258728, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0626, 'eval_samples_per_second': 499.895, 'eval_steps_per_second': 62.691, 'epoch': 10.0}
{'loss': 0.77, 'learning_rate': 4.5e-07, 'epoch': 11.0}
{'eval_loss': 0.7492168545722961, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9924, 'eval_samples_per_second': 511.638, 'eval_steps_per_second': 64.164, 'epoch': 11.0}
{'loss': 0.7368, 'learning_rate': 4e-07, 'epoch': 12.0}
{'eval_loss': 0.7184697985649109, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9921, 'eval_samples_per_second': 511.675, 'eval_steps_per_second': 64.168, 'epoch': 12.0}
{'loss': 0.7089, 'learning_rate': 3.5e-07, 'epoch': 13.0}
{'eval_loss': 0.6925466060638428, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9934, 'eval_samples_per_second': 511.464, 'eval_steps_per_second': 64.142, 'epoch': 13.0}
{'loss': 0.6854, 'learning_rate': 3e-07, 'epoch': 14.0}
{'eval_loss': 0.670985996723175, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9892, 'eval_samples_per_second': 512.173, 'eval_steps_per_second': 64.231, 'epoch': 14.0}
{'loss': 0.6658, 'learning_rate': 2.5e-07, 'epoch': 15.0}
{'eval_loss': 0.6533942818641663, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9821, 'eval_samples_per_second': 513.397, 'eval_steps_per_second': 64.384, 'epoch': 15.0}
{'loss': 0.65, 'learning_rate': 2e-07, 'epoch': 16.0}
{'eval_loss': 0.6394420266151428, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9789, 'eval_samples_per_second': 513.955, 'eval_steps_per_second': 64.454, 'epoch': 16.0}
{'loss': 0.6377, 'learning_rate': 1.5e-07, 'epoch': 17.0}
{'eval_loss': 0.6288632750511169, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9878, 'eval_samples_per_second': 512.425, 'eval_steps_per_second': 64.262, 'epoch': 17.0}
{'loss': 0.6293, 'learning_rate': 1e-07, 'epoch': 18.0}
{'eval_loss': 0.6214496493339539, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9815, 'eval_samples_per_second': 513.503, 'eval_steps_per_second': 64.398, 'epoch': 18.0}
{'loss': 0.6227, 'learning_rate': 5e-08, 'epoch': 19.0}
{'eval_loss': 0.6170551180839539, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9906, 'eval_samples_per_second': 511.931, 'eval_steps_per_second': 64.2, 'epoch': 19.0}
{'loss': 0.6199, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.6155924797058105, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0004, 'eval_samples_per_second': 510.271, 'eval_steps_per_second': 63.992, 'epoch': 20.0}
{'train_runtime': 705.1355, 'train_samples_per_second': 244.889, 'train_steps_per_second': 3.829, 'train_loss': 0.8947632203278718, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.8948
  train_runtime            = 0:11:45.13
  train_samples            =       8634
  train_samples_per_second =    244.889
  train_steps_per_second   =      3.829
[{'loss': 1.5646, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0, 'step': 135}, {'eval_loss': 1.4926880598068237, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0275, 'eval_samples_per_second': 505.698, 'eval_steps_per_second': 63.419, 'epoch': 1.0, 'step': 135}, {'loss': 1.4228, 'learning_rate': 9e-07, 'epoch': 2.0, 'step': 270}, {'eval_loss': 1.3568943738937378, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9882, 'eval_samples_per_second': 512.354, 'eval_steps_per_second': 64.253, 'epoch': 2.0, 'step': 270}, {'loss': 1.3018, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0, 'step': 405}, {'eval_loss': 1.2466591596603394, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9992, 'eval_samples_per_second': 510.476, 'eval_steps_per_second': 64.018, 'epoch': 3.0, 'step': 405}, {'loss': 1.1999, 'learning_rate': 8e-07, 'epoch': 4.0, 'step': 540}, {'eval_loss': 1.1517466306686401, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9994, 'eval_samples_per_second': 510.443, 'eval_steps_per_second': 64.014, 'epoch': 4.0, 'step': 540}, {'loss': 1.1114, 'learning_rate': 7.5e-07, 'epoch': 5.0, 'step': 675}, {'eval_loss': 1.0686818361282349, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9993, 'eval_samples_per_second': 510.46, 'eval_steps_per_second': 64.016, 'epoch': 5.0, 'step': 675}, {'loss': 1.0339, 'learning_rate': 7e-07, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.9957486391067505, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9876, 'eval_samples_per_second': 512.456, 'eval_steps_per_second': 64.266, 'epoch': 6.0, 'step': 810}, {'loss': 0.9656, 'learning_rate': 6.5e-07, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.9317953586578369, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9884, 'eval_samples_per_second': 512.318, 'eval_steps_per_second': 64.249, 'epoch': 7.0, 'step': 945}, {'loss': 0.9058, 'learning_rate': 6e-07, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.8759154677391052, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9932, 'eval_samples_per_second': 511.497, 'eval_steps_per_second': 64.146, 'epoch': 8.0, 'step': 1080}, {'loss': 0.854, 'learning_rate': 5.5e-07, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.8273189067840576, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9841, 'eval_samples_per_second': 513.047, 'eval_steps_per_second': 64.34, 'epoch': 9.0, 'step': 1215}, {'loss': 0.809, 'learning_rate': 5e-07, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.7853054404258728, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0626, 'eval_samples_per_second': 499.895, 'eval_steps_per_second': 62.691, 'epoch': 10.0, 'step': 1350}, {'loss': 0.77, 'learning_rate': 4.5e-07, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.7492168545722961, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9924, 'eval_samples_per_second': 511.638, 'eval_steps_per_second': 64.164, 'epoch': 11.0, 'step': 1485}, {'loss': 0.7368, 'learning_rate': 4e-07, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.7184697985649109, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9921, 'eval_samples_per_second': 511.675, 'eval_steps_per_second': 64.168, 'epoch': 12.0, 'step': 1620}, {'loss': 0.7089, 'learning_rate': 3.5e-07, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.6925466060638428, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9934, 'eval_samples_per_second': 511.464, 'eval_steps_per_second': 64.142, 'epoch': 13.0, 'step': 1755}, {'loss': 0.6854, 'learning_rate': 3e-07, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.670985996723175, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9892, 'eval_samples_per_second': 512.173, 'eval_steps_per_second': 64.231, 'epoch': 14.0, 'step': 1890}, {'loss': 0.6658, 'learning_rate': 2.5e-07, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.6533942818641663, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9821, 'eval_samples_per_second': 513.397, 'eval_steps_per_second': 64.384, 'epoch': 15.0, 'step': 2025}, {'loss': 0.65, 'learning_rate': 2e-07, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.6394420266151428, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9789, 'eval_samples_per_second': 513.955, 'eval_steps_per_second': 64.454, 'epoch': 16.0, 'step': 2160}, {'loss': 0.6377, 'learning_rate': 1.5e-07, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.6288632750511169, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9878, 'eval_samples_per_second': 512.425, 'eval_steps_per_second': 64.262, 'epoch': 17.0, 'step': 2295}, {'loss': 0.6293, 'learning_rate': 1e-07, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.6214496493339539, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9815, 'eval_samples_per_second': 513.503, 'eval_steps_per_second': 64.398, 'epoch': 18.0, 'step': 2430}, {'loss': 0.6227, 'learning_rate': 5e-08, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.6170551180839539, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9906, 'eval_samples_per_second': 511.931, 'eval_steps_per_second': 64.2, 'epoch': 19.0, 'step': 2565}, {'loss': 0.6199, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.6155924797058105, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0004, 'eval_samples_per_second': 510.271, 'eval_steps_per_second': 63.992, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 705.1355, 'train_samples_per_second': 244.889, 'train_steps_per_second': 3.829, 'total_flos': 6363267648107904.0, 'train_loss': 0.8947632203278718, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-base
***** predict metrics *****
  predict_accuracy           =     0.9327
  predict_f1                 =        0.0
  predict_loss               =     0.6174
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:02.48
  predict_samples_per_second =    511.115
  predict_steps_per_second   =     63.889
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_16.json completed. F1: 0.0
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_00.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_00.json
01150927_tsa-bin_NorBERT_3_x-small Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6564.45 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 7088.89 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6919.56 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6917.44 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6977.51 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7133.10 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7312.84 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 7378.74 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6795.02 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7339.69 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7001.43 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7059.92 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6908.87 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/projects/ec30/egilron/tsa-hf/01150927_tsa-bin_NorBERT_3_x-small/checkpoint-135 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_x-small Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'learning_rate': 4.75e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9615, 'eval_samples_per_second': 516.961, 'eval_steps_per_second': 64.831, 'epoch': 1.0}
{'loss': 0.0, 'learning_rate': 4.5e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9498, 'eval_samples_per_second': 519.022, 'eval_steps_per_second': 65.09, 'epoch': 2.0}
{'loss': 0.0, 'learning_rate': 4.25e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9469, 'eval_samples_per_second': 519.532, 'eval_steps_per_second': 65.154, 'epoch': 3.0}
{'loss': 0.0, 'learning_rate': 4e-05, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9262, 'eval_samples_per_second': 523.196, 'eval_steps_per_second': 65.613, 'epoch': 4.0}
{'loss': 0.0, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9368, 'eval_samples_per_second': 521.309, 'eval_steps_per_second': 65.376, 'epoch': 5.0}
{'loss': 0.0, 'learning_rate': 3.5e-05, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9264, 'eval_samples_per_second': 523.173, 'eval_steps_per_second': 65.61, 'epoch': 6.0}
{'loss': 0.0, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9309, 'eval_samples_per_second': 522.358, 'eval_steps_per_second': 65.508, 'epoch': 7.0}
{'loss': 0.0, 'learning_rate': 3e-05, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.932, 'eval_samples_per_second': 522.171, 'eval_steps_per_second': 65.485, 'epoch': 8.0}
{'loss': 0.0, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.946, 'eval_samples_per_second': 519.685, 'eval_steps_per_second': 65.173, 'epoch': 9.0}
{'loss': 0.0, 'learning_rate': 2.5e-05, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0138, 'eval_samples_per_second': 508.0, 'eval_steps_per_second': 63.707, 'epoch': 10.0}
{'loss': 0.0, 'learning_rate': 2.25e-05, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9323, 'eval_samples_per_second': 522.11, 'eval_steps_per_second': 65.477, 'epoch': 11.0}
{'loss': 0.0, 'learning_rate': 2e-05, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.933, 'eval_samples_per_second': 521.99, 'eval_steps_per_second': 65.462, 'epoch': 12.0}
{'loss': 0.0, 'learning_rate': 1.75e-05, 'epoch': 13.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9343, 'eval_samples_per_second': 521.757, 'eval_steps_per_second': 65.433, 'epoch': 13.0}
{'loss': 0.0, 'learning_rate': 1.5e-05, 'epoch': 14.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9369, 'eval_samples_per_second': 521.3, 'eval_steps_per_second': 65.375, 'epoch': 14.0}
{'loss': 0.0, 'learning_rate': 1.25e-05, 'epoch': 15.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.938, 'eval_samples_per_second': 521.098, 'eval_steps_per_second': 65.35, 'epoch': 15.0}
{'loss': 0.0, 'learning_rate': 1e-05, 'epoch': 16.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9425, 'eval_samples_per_second': 520.302, 'eval_steps_per_second': 65.25, 'epoch': 16.0}
{'loss': 0.0, 'learning_rate': 7.5e-06, 'epoch': 17.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9149, 'eval_samples_per_second': 525.235, 'eval_steps_per_second': 65.869, 'epoch': 17.0}
{'loss': 0.0, 'learning_rate': 5e-06, 'epoch': 18.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9376, 'eval_samples_per_second': 521.171, 'eval_steps_per_second': 65.359, 'epoch': 18.0}
{'loss': 0.0, 'learning_rate': 2.5e-06, 'epoch': 19.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9084, 'eval_samples_per_second': 526.405, 'eval_steps_per_second': 66.016, 'epoch': 19.0}
{'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9266, 'eval_samples_per_second': 523.126, 'eval_steps_per_second': 65.604, 'epoch': 20.0}
{'train_runtime': 237.4908, 'train_samples_per_second': 727.102, 'train_steps_per_second': 11.369, 'train_loss': 0.0, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =        0.0
  train_runtime            = 0:03:57.49
  train_samples            =       8634
  train_samples_per_second =    727.102
  train_steps_per_second   =     11.369
[{'loss': 0.0, 'learning_rate': 4.75e-05, 'epoch': 1.0, 'step': 135}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9615, 'eval_samples_per_second': 516.961, 'eval_steps_per_second': 64.831, 'epoch': 1.0, 'step': 135}, {'loss': 0.0, 'learning_rate': 4.5e-05, 'epoch': 2.0, 'step': 270}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9498, 'eval_samples_per_second': 519.022, 'eval_steps_per_second': 65.09, 'epoch': 2.0, 'step': 270}, {'loss': 0.0, 'learning_rate': 4.25e-05, 'epoch': 3.0, 'step': 405}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9469, 'eval_samples_per_second': 519.532, 'eval_steps_per_second': 65.154, 'epoch': 3.0, 'step': 405}, {'loss': 0.0, 'learning_rate': 4e-05, 'epoch': 4.0, 'step': 540}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9262, 'eval_samples_per_second': 523.196, 'eval_steps_per_second': 65.613, 'epoch': 4.0, 'step': 540}, {'loss': 0.0, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0, 'step': 675}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9368, 'eval_samples_per_second': 521.309, 'eval_steps_per_second': 65.376, 'epoch': 5.0, 'step': 675}, {'loss': 0.0, 'learning_rate': 3.5e-05, 'epoch': 6.0, 'step': 810}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9264, 'eval_samples_per_second': 523.173, 'eval_steps_per_second': 65.61, 'epoch': 6.0, 'step': 810}, {'loss': 0.0, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0, 'step': 945}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9309, 'eval_samples_per_second': 522.358, 'eval_steps_per_second': 65.508, 'epoch': 7.0, 'step': 945}, {'loss': 0.0, 'learning_rate': 3e-05, 'epoch': 8.0, 'step': 1080}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.932, 'eval_samples_per_second': 522.171, 'eval_steps_per_second': 65.485, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0, 'step': 1215}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.946, 'eval_samples_per_second': 519.685, 'eval_steps_per_second': 65.173, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0, 'learning_rate': 2.5e-05, 'epoch': 10.0, 'step': 1350}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0138, 'eval_samples_per_second': 508.0, 'eval_steps_per_second': 63.707, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0, 'learning_rate': 2.25e-05, 'epoch': 11.0, 'step': 1485}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9323, 'eval_samples_per_second': 522.11, 'eval_steps_per_second': 65.477, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0, 'learning_rate': 2e-05, 'epoch': 12.0, 'step': 1620}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.933, 'eval_samples_per_second': 521.99, 'eval_steps_per_second': 65.462, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0, 'learning_rate': 1.75e-05, 'epoch': 13.0, 'step': 1755}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9343, 'eval_samples_per_second': 521.757, 'eval_steps_per_second': 65.433, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0, 'learning_rate': 1.5e-05, 'epoch': 14.0, 'step': 1890}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9369, 'eval_samples_per_second': 521.3, 'eval_steps_per_second': 65.375, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0, 'learning_rate': 1.25e-05, 'epoch': 15.0, 'step': 2025}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.938, 'eval_samples_per_second': 521.098, 'eval_steps_per_second': 65.35, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0, 'learning_rate': 1e-05, 'epoch': 16.0, 'step': 2160}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9425, 'eval_samples_per_second': 520.302, 'eval_steps_per_second': 65.25, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0, 'learning_rate': 7.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9149, 'eval_samples_per_second': 525.235, 'eval_steps_per_second': 65.869, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0, 'learning_rate': 5e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9376, 'eval_samples_per_second': 521.171, 'eval_steps_per_second': 65.359, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0, 'learning_rate': 2.5e-06, 'epoch': 19.0, 'step': 2565}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9084, 'eval_samples_per_second': 526.405, 'eval_steps_per_second': 66.016, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9266, 'eval_samples_per_second': 523.126, 'eval_steps_per_second': 65.604, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 237.4908, 'train_samples_per_second': 727.102, 'train_steps_per_second': 11.369, 'total_flos': 399234715456896.0, 'train_loss': 0.0, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-xs
***** predict metrics *****
  predict_accuracy           =     0.9327
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:02.42
  predict_samples_per_second =    525.381
  predict_steps_per_second   =     65.673
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_00.json completed. F1: 0.0
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_02.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_02.json
01150927_tsa-bin_NorBERT_3_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6088.87 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6806.84 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6792.81 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6921.92 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 7017.18 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7155.45 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7312.97 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 7406.33 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6774.91 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7428.75 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7087.18 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7035.73 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6897.77 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.5187, 'learning_rate': 4.75e-05, 'epoch': 1.0}
{'eval_loss': 0.20607104897499084, 'eval_precision': 0.20088105726872246, 'eval_recall': 0.25997719498289623, 'eval_f1': 0.22664015904572563, 'eval_accuracy': 0.9373504207519494, 'eval_runtime': 3.0016, 'eval_samples_per_second': 510.067, 'eval_steps_per_second': 63.967, 'epoch': 1.0}
{'loss': 0.1955, 'learning_rate': 4.5e-05, 'epoch': 2.0}
{'eval_loss': 0.18799103796482086, 'eval_precision': 0.45217391304347826, 'eval_recall': 0.29646522234891676, 'eval_f1': 0.35812672176308535, 'eval_accuracy': 0.9498571759437968, 'eval_runtime': 2.9693, 'eval_samples_per_second': 515.604, 'eval_steps_per_second': 64.661, 'epoch': 2.0}
{'loss': 0.1197, 'learning_rate': 4.25e-05, 'epoch': 3.0}
{'eval_loss': 0.18143437802791595, 'eval_precision': 0.502127659574468, 'eval_recall': 0.40364880273660203, 'eval_f1': 0.44753476611883686, 'eval_accuracy': 0.9491623562109164, 'eval_runtime': 2.9623, 'eval_samples_per_second': 516.823, 'eval_steps_per_second': 64.814, 'epoch': 3.0}
{'loss': 0.0768, 'learning_rate': 4e-05, 'epoch': 4.0}
{'eval_loss': 0.1945512592792511, 'eval_precision': 0.500515995872033, 'eval_recall': 0.5530216647662486, 'eval_f1': 0.5254604550379198, 'eval_accuracy': 0.9498185748475256, 'eval_runtime': 2.9757, 'eval_samples_per_second': 514.503, 'eval_steps_per_second': 64.523, 'epoch': 4.0}
{'loss': 0.046, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0}
{'eval_loss': 0.2088797390460968, 'eval_precision': 0.4833869239013934, 'eval_recall': 0.5142531356898518, 'eval_f1': 0.4983425414364641, 'eval_accuracy': 0.9471550992048174, 'eval_runtime': 2.9646, 'eval_samples_per_second': 516.433, 'eval_steps_per_second': 64.765, 'epoch': 5.0}
{'loss': 0.0263, 'learning_rate': 3.5e-05, 'epoch': 6.0}
{'eval_loss': 0.2322062849998474, 'eval_precision': 0.4812182741116751, 'eval_recall': 0.540478905359179, 'eval_f1': 0.5091299677765844, 'eval_accuracy': 0.9488921485370184, 'eval_runtime': 2.9669, 'eval_samples_per_second': 516.019, 'eval_steps_per_second': 64.713, 'epoch': 6.0}
{'loss': 0.0166, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0}
{'eval_loss': 0.25187766551971436, 'eval_precision': 0.498416050686378, 'eval_recall': 0.5381984036488028, 'eval_f1': 0.5175438596491229, 'eval_accuracy': 0.9500887825214236, 'eval_runtime': 2.9637, 'eval_samples_per_second': 516.576, 'eval_steps_per_second': 64.783, 'epoch': 7.0}
{'loss': 0.0107, 'learning_rate': 3e-05, 'epoch': 8.0}
{'eval_loss': 0.2641489505767822, 'eval_precision': 0.4952481520591341, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.5142543859649122, 'eval_accuracy': 0.9496641704624411, 'eval_runtime': 2.9642, 'eval_samples_per_second': 516.504, 'eval_steps_per_second': 64.774, 'epoch': 8.0}
{'loss': 0.007, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0}
{'eval_loss': 0.2734643816947937, 'eval_precision': 0.49781181619256015, 'eval_recall': 0.5188141391106044, 'eval_f1': 0.5080960357342267, 'eval_accuracy': 0.9500115803288813, 'eval_runtime': 2.9634, 'eval_samples_per_second': 516.628, 'eval_steps_per_second': 64.789, 'epoch': 9.0}
{'loss': 0.0052, 'learning_rate': 2.5e-05, 'epoch': 10.0}
{'eval_loss': 0.28484585881233215, 'eval_precision': 0.4895259095920617, 'eval_recall': 0.5062713797035348, 'eval_f1': 0.4977578475336323, 'eval_accuracy': 0.9498957770400679, 'eval_runtime': 3.0551, 'eval_samples_per_second': 501.136, 'eval_steps_per_second': 62.847, 'epoch': 10.0}
{'loss': 0.0046, 'learning_rate': 2.25e-05, 'epoch': 11.0}
{'eval_loss': 0.29194822907447815, 'eval_precision': 0.48066298342541436, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.48821548821548827, 'eval_accuracy': 0.9492781594997298, 'eval_runtime': 2.9624, 'eval_samples_per_second': 516.81, 'eval_steps_per_second': 64.812, 'epoch': 11.0}
{'loss': 0.0033, 'learning_rate': 2e-05, 'epoch': 12.0}
{'eval_loss': 0.29905280470848083, 'eval_precision': 0.5084745762711864, 'eval_recall': 0.5131128848346637, 'eval_f1': 0.510783200908059, 'eval_accuracy': 0.9509766077356597, 'eval_runtime': 2.9609, 'eval_samples_per_second': 517.08, 'eval_steps_per_second': 64.846, 'epoch': 12.0}
{'loss': 0.0029, 'learning_rate': 1.75e-05, 'epoch': 13.0}
{'eval_loss': 0.295119971036911, 'eval_precision': 0.49213011542497376, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.5125683060109288, 'eval_accuracy': 0.9500115803288813, 'eval_runtime': 2.9615, 'eval_samples_per_second': 516.969, 'eval_steps_per_second': 64.832, 'epoch': 13.0}
{'loss': 0.0026, 'learning_rate': 1.5e-05, 'epoch': 14.0}
{'eval_loss': 0.3004675507545471, 'eval_precision': 0.5135135135135135, 'eval_recall': 0.5199543899657925, 'eval_f1': 0.5167138810198301, 'eval_accuracy': 0.9518644329498958, 'eval_runtime': 2.9539, 'eval_samples_per_second': 518.306, 'eval_steps_per_second': 65.0, 'epoch': 14.0}
{'loss': 0.002, 'learning_rate': 1.25e-05, 'epoch': 15.0}
{'eval_loss': 0.3012392818927765, 'eval_precision': 0.5077433628318584, 'eval_recall': 0.5233751425313569, 'eval_f1': 0.5154407636159462, 'eval_accuracy': 0.95167142746854, 'eval_runtime': 2.9669, 'eval_samples_per_second': 516.023, 'eval_steps_per_second': 64.714, 'epoch': 15.0}
{'loss': 0.0015, 'learning_rate': 1e-05, 'epoch': 16.0}
{'eval_loss': 0.30822303891181946, 'eval_precision': 0.5179775280898876, 'eval_recall': 0.5256556442417332, 'eval_f1': 0.5217883418222977, 'eval_accuracy': 0.9520960395275225, 'eval_runtime': 2.9721, 'eval_samples_per_second': 515.119, 'eval_steps_per_second': 64.6, 'epoch': 16.0}
{'loss': 0.0014, 'learning_rate': 7.5e-06, 'epoch': 17.0}
{'eval_loss': 0.3103625774383545, 'eval_precision': 0.5142857142857142, 'eval_recall': 0.5336374002280502, 'eval_f1': 0.5237828763290431, 'eval_accuracy': 0.9520574384312515, 'eval_runtime': 2.9604, 'eval_samples_per_second': 517.161, 'eval_steps_per_second': 64.856, 'epoch': 17.0}
{'loss': 0.001, 'learning_rate': 5e-06, 'epoch': 18.0}
{'eval_loss': 0.3153667747974396, 'eval_precision': 0.5076252723311547, 'eval_recall': 0.5313568985176739, 'eval_f1': 0.5192200557103064, 'eval_accuracy': 0.9508994055431175, 'eval_runtime': 2.9692, 'eval_samples_per_second': 515.626, 'eval_steps_per_second': 64.664, 'epoch': 18.0}
{'loss': 0.0009, 'learning_rate': 2.5e-06, 'epoch': 19.0}
{'eval_loss': 0.31754958629608154, 'eval_precision': 0.5144124168514412, 'eval_recall': 0.5290763968072976, 'eval_f1': 0.5216413715570545, 'eval_accuracy': 0.9514398208909133, 'eval_runtime': 2.9667, 'eval_samples_per_second': 516.057, 'eval_steps_per_second': 64.718, 'epoch': 19.0}
{'loss': 0.0008, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.31801822781562805, 'eval_precision': 0.5132743362831859, 'eval_recall': 0.5290763968072976, 'eval_f1': 0.5210555867490174, 'eval_accuracy': 0.951362618698371, 'eval_runtime': 2.9682, 'eval_samples_per_second': 515.802, 'eval_steps_per_second': 64.686, 'epoch': 20.0}
{'train_runtime': 704.6607, 'train_samples_per_second': 245.054, 'train_steps_per_second': 3.832, 'train_loss': 0.05216686487197876, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.0522
  train_runtime            = 0:11:44.66
  train_samples            =       8634
  train_samples_per_second =    245.054
  train_steps_per_second   =      3.832
[{'loss': 0.5187, 'learning_rate': 4.75e-05, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.20607104897499084, 'eval_precision': 0.20088105726872246, 'eval_recall': 0.25997719498289623, 'eval_f1': 0.22664015904572563, 'eval_accuracy': 0.9373504207519494, 'eval_runtime': 3.0016, 'eval_samples_per_second': 510.067, 'eval_steps_per_second': 63.967, 'epoch': 1.0, 'step': 135}, {'loss': 0.1955, 'learning_rate': 4.5e-05, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.18799103796482086, 'eval_precision': 0.45217391304347826, 'eval_recall': 0.29646522234891676, 'eval_f1': 0.35812672176308535, 'eval_accuracy': 0.9498571759437968, 'eval_runtime': 2.9693, 'eval_samples_per_second': 515.604, 'eval_steps_per_second': 64.661, 'epoch': 2.0, 'step': 270}, {'loss': 0.1197, 'learning_rate': 4.25e-05, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.18143437802791595, 'eval_precision': 0.502127659574468, 'eval_recall': 0.40364880273660203, 'eval_f1': 0.44753476611883686, 'eval_accuracy': 0.9491623562109164, 'eval_runtime': 2.9623, 'eval_samples_per_second': 516.823, 'eval_steps_per_second': 64.814, 'epoch': 3.0, 'step': 405}, {'loss': 0.0768, 'learning_rate': 4e-05, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.1945512592792511, 'eval_precision': 0.500515995872033, 'eval_recall': 0.5530216647662486, 'eval_f1': 0.5254604550379198, 'eval_accuracy': 0.9498185748475256, 'eval_runtime': 2.9757, 'eval_samples_per_second': 514.503, 'eval_steps_per_second': 64.523, 'epoch': 4.0, 'step': 540}, {'loss': 0.046, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.2088797390460968, 'eval_precision': 0.4833869239013934, 'eval_recall': 0.5142531356898518, 'eval_f1': 0.4983425414364641, 'eval_accuracy': 0.9471550992048174, 'eval_runtime': 2.9646, 'eval_samples_per_second': 516.433, 'eval_steps_per_second': 64.765, 'epoch': 5.0, 'step': 675}, {'loss': 0.0263, 'learning_rate': 3.5e-05, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.2322062849998474, 'eval_precision': 0.4812182741116751, 'eval_recall': 0.540478905359179, 'eval_f1': 0.5091299677765844, 'eval_accuracy': 0.9488921485370184, 'eval_runtime': 2.9669, 'eval_samples_per_second': 516.019, 'eval_steps_per_second': 64.713, 'epoch': 6.0, 'step': 810}, {'loss': 0.0166, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.25187766551971436, 'eval_precision': 0.498416050686378, 'eval_recall': 0.5381984036488028, 'eval_f1': 0.5175438596491229, 'eval_accuracy': 0.9500887825214236, 'eval_runtime': 2.9637, 'eval_samples_per_second': 516.576, 'eval_steps_per_second': 64.783, 'epoch': 7.0, 'step': 945}, {'loss': 0.0107, 'learning_rate': 3e-05, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.2641489505767822, 'eval_precision': 0.4952481520591341, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.5142543859649122, 'eval_accuracy': 0.9496641704624411, 'eval_runtime': 2.9642, 'eval_samples_per_second': 516.504, 'eval_steps_per_second': 64.774, 'epoch': 8.0, 'step': 1080}, {'loss': 0.007, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.2734643816947937, 'eval_precision': 0.49781181619256015, 'eval_recall': 0.5188141391106044, 'eval_f1': 0.5080960357342267, 'eval_accuracy': 0.9500115803288813, 'eval_runtime': 2.9634, 'eval_samples_per_second': 516.628, 'eval_steps_per_second': 64.789, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0052, 'learning_rate': 2.5e-05, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.28484585881233215, 'eval_precision': 0.4895259095920617, 'eval_recall': 0.5062713797035348, 'eval_f1': 0.4977578475336323, 'eval_accuracy': 0.9498957770400679, 'eval_runtime': 3.0551, 'eval_samples_per_second': 501.136, 'eval_steps_per_second': 62.847, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0046, 'learning_rate': 2.25e-05, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.29194822907447815, 'eval_precision': 0.48066298342541436, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.48821548821548827, 'eval_accuracy': 0.9492781594997298, 'eval_runtime': 2.9624, 'eval_samples_per_second': 516.81, 'eval_steps_per_second': 64.812, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0033, 'learning_rate': 2e-05, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.29905280470848083, 'eval_precision': 0.5084745762711864, 'eval_recall': 0.5131128848346637, 'eval_f1': 0.510783200908059, 'eval_accuracy': 0.9509766077356597, 'eval_runtime': 2.9609, 'eval_samples_per_second': 517.08, 'eval_steps_per_second': 64.846, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0029, 'learning_rate': 1.75e-05, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.295119971036911, 'eval_precision': 0.49213011542497376, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.5125683060109288, 'eval_accuracy': 0.9500115803288813, 'eval_runtime': 2.9615, 'eval_samples_per_second': 516.969, 'eval_steps_per_second': 64.832, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0026, 'learning_rate': 1.5e-05, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.3004675507545471, 'eval_precision': 0.5135135135135135, 'eval_recall': 0.5199543899657925, 'eval_f1': 0.5167138810198301, 'eval_accuracy': 0.9518644329498958, 'eval_runtime': 2.9539, 'eval_samples_per_second': 518.306, 'eval_steps_per_second': 65.0, 'epoch': 14.0, 'step': 1890}, {'loss': 0.002, 'learning_rate': 1.25e-05, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.3012392818927765, 'eval_precision': 0.5077433628318584, 'eval_recall': 0.5233751425313569, 'eval_f1': 0.5154407636159462, 'eval_accuracy': 0.95167142746854, 'eval_runtime': 2.9669, 'eval_samples_per_second': 516.023, 'eval_steps_per_second': 64.714, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0015, 'learning_rate': 1e-05, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.30822303891181946, 'eval_precision': 0.5179775280898876, 'eval_recall': 0.5256556442417332, 'eval_f1': 0.5217883418222977, 'eval_accuracy': 0.9520960395275225, 'eval_runtime': 2.9721, 'eval_samples_per_second': 515.119, 'eval_steps_per_second': 64.6, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0014, 'learning_rate': 7.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.3103625774383545, 'eval_precision': 0.5142857142857142, 'eval_recall': 0.5336374002280502, 'eval_f1': 0.5237828763290431, 'eval_accuracy': 0.9520574384312515, 'eval_runtime': 2.9604, 'eval_samples_per_second': 517.161, 'eval_steps_per_second': 64.856, 'epoch': 17.0, 'step': 2295}, {'loss': 0.001, 'learning_rate': 5e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.3153667747974396, 'eval_precision': 0.5076252723311547, 'eval_recall': 0.5313568985176739, 'eval_f1': 0.5192200557103064, 'eval_accuracy': 0.9508994055431175, 'eval_runtime': 2.9692, 'eval_samples_per_second': 515.626, 'eval_steps_per_second': 64.664, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0009, 'learning_rate': 2.5e-06, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.31754958629608154, 'eval_precision': 0.5144124168514412, 'eval_recall': 0.5290763968072976, 'eval_f1': 0.5216413715570545, 'eval_accuracy': 0.9514398208909133, 'eval_runtime': 2.9667, 'eval_samples_per_second': 516.057, 'eval_steps_per_second': 64.718, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0008, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.31801822781562805, 'eval_precision': 0.5132743362831859, 'eval_recall': 0.5290763968072976, 'eval_f1': 0.5210555867490174, 'eval_accuracy': 0.951362618698371, 'eval_runtime': 2.9682, 'eval_samples_per_second': 515.802, 'eval_steps_per_second': 64.686, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 704.6607, 'train_samples_per_second': 245.054, 'train_steps_per_second': 3.832, 'total_flos': 6363267648107904.0, 'train_loss': 0.05216686487197876, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-base
***** predict metrics *****
  predict_accuracy           =     0.9493
  predict_f1                 =     0.4178
  predict_loss               =     0.1924
  predict_precision          =     0.5019
  predict_recall             =     0.3578
  predict_runtime            = 0:00:02.47
  predict_samples_per_second =    514.208
  predict_steps_per_second   =     64.276
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_02.json completed. F1: 0.4177918983320095
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_19.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_19.json
config.json:   0%|          | 0.00/518 [00:00<?, ?B/s]config.json: 100%|██████████| 518/518 [00:00<00:00, 5.09MB/s]
tokenizer_config.json:   0%|          | 0.00/389 [00:00<?, ?B/s]tokenizer_config.json: 100%|██████████| 389/389 [00:00<00:00, 4.53MB/s]
vocab.txt:   0%|          | 0.00/395k [00:00<?, ?B/s]vocab.txt: 100%|██████████| 395k/395k [00:00<00:00, 1.99MB/s]vocab.txt: 100%|██████████| 395k/395k [00:00<00:00, 1.99MB/s]
model.safetensors:   0%|          | 0.00/1.42G [00:00<?, ?B/s]model.safetensors:   1%|▏         | 21.0M/1.42G [00:00<00:12, 115MB/s]model.safetensors:   3%|▎         | 41.9M/1.42G [00:00<00:12, 114MB/s]model.safetensors:   4%|▍         | 62.9M/1.42G [00:00<00:11, 115MB/s]model.safetensors:   6%|▌         | 83.9M/1.42G [00:00<00:11, 115MB/s]model.safetensors:   7%|▋         | 105M/1.42G [00:00<00:11, 116MB/s] model.safetensors:   9%|▉         | 126M/1.42G [00:01<00:11, 117MB/s]model.safetensors:  10%|█         | 147M/1.42G [00:01<00:10, 117MB/s]model.safetensors:  12%|█▏        | 168M/1.42G [00:01<00:10, 117MB/s]model.safetensors:  13%|█▎        | 189M/1.42G [00:01<00:10, 117MB/s]model.safetensors:  15%|█▍        | 210M/1.42G [00:01<00:10, 117MB/s]model.safetensors:  16%|█▌        | 231M/1.42G [00:01<00:10, 117MB/s]model.safetensors:  18%|█▊        | 252M/1.42G [00:02<00:10, 117MB/s]model.safetensors:  19%|█▉        | 273M/1.42G [00:02<00:09, 117MB/s]model.safetensors:  21%|██        | 294M/1.42G [00:02<00:09, 117MB/s]model.safetensors:  22%|██▏       | 315M/1.42G [00:02<00:09, 117MB/s]model.safetensors:  24%|██▎       | 336M/1.42G [00:02<00:09, 117MB/s]model.safetensors:  25%|██▌       | 357M/1.42G [00:03<00:09, 117MB/s]model.safetensors:  26%|██▋       | 377M/1.42G [00:03<00:08, 117MB/s]model.safetensors:  28%|██▊       | 398M/1.42G [00:03<00:08, 117MB/s]model.safetensors:  29%|██▉       | 419M/1.42G [00:03<00:08, 117MB/s]model.safetensors:  31%|███       | 440M/1.42G [00:03<00:08, 117MB/s]model.safetensors:  32%|███▏      | 461M/1.42G [00:03<00:08, 117MB/s]model.safetensors:  34%|███▍      | 482M/1.42G [00:04<00:08, 117MB/s]model.safetensors:  35%|███▌      | 503M/1.42G [00:04<00:07, 117MB/s]model.safetensors:  37%|███▋      | 524M/1.42G [00:04<00:07, 117MB/s]model.safetensors:  38%|███▊      | 545M/1.42G [00:04<00:07, 117MB/s]model.safetensors:  40%|███▉      | 566M/1.42G [00:04<00:07, 117MB/s]model.safetensors:  41%|████      | 587M/1.42G [00:05<00:07, 116MB/s]model.safetensors:  43%|████▎     | 608M/1.42G [00:05<00:07, 116MB/s]model.safetensors:  44%|████▍     | 629M/1.42G [00:05<00:06, 115MB/s]model.safetensors:  46%|████▌     | 650M/1.42G [00:05<00:06, 115MB/s]model.safetensors:  47%|████▋     | 671M/1.42G [00:05<00:06, 114MB/s]model.safetensors:  49%|████▊     | 692M/1.42G [00:05<00:06, 115MB/s]model.safetensors:  50%|█████     | 713M/1.42G [00:06<00:06, 114MB/s]model.safetensors:  52%|█████▏    | 734M/1.42G [00:06<00:06, 108MB/s]model.safetensors:  53%|█████▎    | 755M/1.42G [00:06<00:06, 110MB/s]model.safetensors:  54%|█████▍    | 776M/1.42G [00:06<00:05, 112MB/s]model.safetensors:  56%|█████▌    | 797M/1.42G [00:06<00:05, 114MB/s]model.safetensors:  57%|█████▋    | 818M/1.42G [00:07<00:05, 115MB/s]model.safetensors:  59%|█████▉    | 839M/1.42G [00:07<00:05, 116MB/s]model.safetensors:  60%|██████    | 860M/1.42G [00:07<00:04, 116MB/s]model.safetensors:  62%|██████▏   | 881M/1.42G [00:07<00:04, 117MB/s]model.safetensors:  63%|██████▎   | 902M/1.42G [00:07<00:04, 117MB/s]model.safetensors:  65%|██████▍   | 923M/1.42G [00:07<00:04, 117MB/s]model.safetensors:  66%|██████▌   | 944M/1.42G [00:08<00:04, 117MB/s]model.safetensors:  68%|██████▊   | 965M/1.42G [00:08<00:03, 117MB/s]model.safetensors:  69%|██████▉   | 986M/1.42G [00:08<00:03, 117MB/s]model.safetensors:  71%|███████   | 1.01G/1.42G [00:08<00:03, 117MB/s]model.safetensors:  72%|███████▏  | 1.03G/1.42G [00:08<00:03, 116MB/s]model.safetensors:  74%|███████▎  | 1.05G/1.42G [00:09<00:03, 115MB/s]model.safetensors:  75%|███████▌  | 1.07G/1.42G [00:09<00:03, 115MB/s]model.safetensors:  77%|███████▋  | 1.09G/1.42G [00:09<00:02, 116MB/s]model.safetensors:  78%|███████▊  | 1.11G/1.42G [00:09<00:02, 116MB/s]model.safetensors:  79%|███████▉  | 1.13G/1.42G [00:09<00:02, 117MB/s]model.safetensors:  81%|████████  | 1.15G/1.42G [00:09<00:02, 117MB/s]model.safetensors:  82%|████████▏ | 1.17G/1.42G [00:10<00:02, 88.6MB/s]model.safetensors:  84%|████████▍ | 1.20G/1.42G [00:10<00:02, 95.0MB/s]model.safetensors:  85%|████████▌ | 1.22G/1.42G [00:10<00:02, 100MB/s] model.safetensors:  87%|████████▋ | 1.24G/1.42G [00:10<00:01, 104MB/s]model.safetensors:  88%|████████▊ | 1.26G/1.42G [00:11<00:01, 107MB/s]model.safetensors:  90%|████████▉ | 1.28G/1.42G [00:11<00:01, 100MB/s]model.safetensors:  91%|█████████▏| 1.30G/1.42G [00:11<00:01, 105MB/s]model.safetensors:  93%|█████████▎| 1.32G/1.42G [00:11<00:00, 108MB/s]model.safetensors:  94%|█████████▍| 1.34G/1.42G [00:11<00:00, 111MB/s]model.safetensors:  96%|█████████▌| 1.36G/1.42G [00:11<00:00, 113MB/s]model.safetensors:  97%|█████████▋| 1.38G/1.42G [00:12<00:00, 114MB/s]model.safetensors:  99%|█████████▊| 1.41G/1.42G [00:12<00:00, 115MB/s]model.safetensors: 100%|██████████| 1.42G/1.42G [00:12<00:00, 116MB/s]model.safetensors: 100%|██████████| 1.42G/1.42G [00:12<00:00, 114MB/s]
Some weights of BertForTokenClassification were not initialized from the model checkpoint at NbAiLab/nb-bert-large and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
01150927_tsa-bin_NB-BERT_large Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6222.86 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 7016.66 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6946.72 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 7064.24 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 7159.34 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7289.97 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 6301.18 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6688.76 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6842.36 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7533.12 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7167.75 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7267.67 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 7101.15 examples/s]
You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NB-BERT_large Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.5555, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0}
{'eval_loss': 0.29050397872924805, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341465297614452, 'eval_runtime': 4.6759, 'eval_samples_per_second': 327.422, 'eval_steps_per_second': 41.061, 'epoch': 1.0}
{'loss': 0.2813, 'learning_rate': 9e-07, 'epoch': 2.0}
{'eval_loss': 0.251107394695282, 'eval_precision': 0.1527777777777778, 'eval_recall': 0.012542759407069556, 'eval_f1': 0.023182297154899893, 'eval_accuracy': 0.9344167374353431, 'eval_runtime': 4.6547, 'eval_samples_per_second': 328.914, 'eval_steps_per_second': 41.249, 'epoch': 2.0}
{'loss': 0.2478, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0}
{'eval_loss': 0.22573541104793549, 'eval_precision': 0.2882882882882883, 'eval_recall': 0.10946408209806158, 'eval_f1': 0.1586776859504132, 'eval_accuracy': 0.9371960163668648, 'eval_runtime': 4.652, 'eval_samples_per_second': 329.103, 'eval_steps_per_second': 41.272, 'epoch': 3.0}
{'loss': 0.2234, 'learning_rate': 8e-07, 'epoch': 4.0}
{'eval_loss': 0.2063935548067093, 'eval_precision': 0.3403846153846154, 'eval_recall': 0.20182440136830102, 'eval_f1': 0.2534001431639227, 'eval_accuracy': 0.9402069018760133, 'eval_runtime': 4.6524, 'eval_samples_per_second': 329.076, 'eval_steps_per_second': 41.269, 'epoch': 4.0}
{'loss': 0.2054, 'learning_rate': 7.5e-07, 'epoch': 5.0}
{'eval_loss': 0.19154804944992065, 'eval_precision': 0.3668730650154799, 'eval_recall': 0.2702394526795895, 'eval_f1': 0.3112278397898884, 'eval_accuracy': 0.9432177873851617, 'eval_runtime': 4.6534, 'eval_samples_per_second': 329.004, 'eval_steps_per_second': 41.26, 'epoch': 5.0}
{'loss': 0.1913, 'learning_rate': 7e-07, 'epoch': 6.0}
{'eval_loss': 0.18045024573802948, 'eval_precision': 0.38161209068010077, 'eval_recall': 0.34549600912200684, 'eval_f1': 0.362657091561939, 'eval_accuracy': 0.9446074268509226, 'eval_runtime': 4.6435, 'eval_samples_per_second': 329.711, 'eval_steps_per_second': 41.348, 'epoch': 6.0}
{'loss': 0.1788, 'learning_rate': 6.5e-07, 'epoch': 7.0}
{'eval_loss': 0.171584814786911, 'eval_precision': 0.3946449359720605, 'eval_recall': 0.3865450399087799, 'eval_f1': 0.390552995391705, 'eval_accuracy': 0.9463830772793947, 'eval_runtime': 4.6583, 'eval_samples_per_second': 328.664, 'eval_steps_per_second': 41.217, 'epoch': 7.0}
{'loss': 0.169, 'learning_rate': 6e-07, 'epoch': 8.0}
{'eval_loss': 0.16626209020614624, 'eval_precision': 0.3956756756756757, 'eval_recall': 0.41733181299885974, 'eval_f1': 0.4062153163152053, 'eval_accuracy': 0.9465374816644793, 'eval_runtime': 4.6641, 'eval_samples_per_second': 328.252, 'eval_steps_per_second': 41.165, 'epoch': 8.0}
{'loss': 0.1623, 'learning_rate': 5.5e-07, 'epoch': 9.0}
{'eval_loss': 0.16298706829547882, 'eval_precision': 0.39710444674250256, 'eval_recall': 0.4378563283922463, 'eval_f1': 0.4164859002169197, 'eval_accuracy': 0.946460279471937, 'eval_runtime': 4.669, 'eval_samples_per_second': 327.909, 'eval_steps_per_second': 41.122, 'epoch': 9.0}
{'loss': 0.157, 'learning_rate': 5e-07, 'epoch': 10.0}
{'eval_loss': 0.15895351767539978, 'eval_precision': 0.4323094425483504, 'eval_recall': 0.43329532497149376, 'eval_f1': 0.4328018223234624, 'eval_accuracy': 0.9481201266115957, 'eval_runtime': 4.662, 'eval_samples_per_second': 328.401, 'eval_steps_per_second': 41.184, 'epoch': 10.0}
{'loss': 0.1516, 'learning_rate': 4.5e-07, 'epoch': 11.0}
{'eval_loss': 0.15775039792060852, 'eval_precision': 0.42340425531914894, 'eval_recall': 0.45381984036488027, 'eval_f1': 0.4380847550908091, 'eval_accuracy': 0.9478113178414267, 'eval_runtime': 4.6542, 'eval_samples_per_second': 328.949, 'eval_steps_per_second': 41.253, 'epoch': 11.0}
{'loss': 0.1484, 'learning_rate': 4e-07, 'epoch': 12.0}
{'eval_loss': 0.15567921102046967, 'eval_precision': 0.43952483801295894, 'eval_recall': 0.4640820980615735, 'eval_f1': 0.4514697726012202, 'eval_accuracy': 0.948197328804138, 'eval_runtime': 4.6627, 'eval_samples_per_second': 328.35, 'eval_steps_per_second': 41.178, 'epoch': 12.0}
{'loss': 0.1458, 'learning_rate': 3.5e-07, 'epoch': 13.0}
{'eval_loss': 0.1548585146665573, 'eval_precision': 0.44139387539598735, 'eval_recall': 0.4766248574686431, 'eval_f1': 0.4583333333333333, 'eval_accuracy': 0.9480429244190535, 'eval_runtime': 4.6567, 'eval_samples_per_second': 328.771, 'eval_steps_per_second': 41.231, 'epoch': 13.0}
{'loss': 0.1429, 'learning_rate': 3e-07, 'epoch': 14.0}
{'eval_loss': 0.1547013819217682, 'eval_precision': 0.43782117163412126, 'eval_recall': 0.48574686431014824, 'eval_f1': 0.46054054054054056, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 4.6555, 'eval_samples_per_second': 328.859, 'eval_steps_per_second': 41.242, 'epoch': 14.0}
{'loss': 0.1416, 'learning_rate': 2.5e-07, 'epoch': 15.0}
{'eval_loss': 0.15401248633861542, 'eval_precision': 0.4402061855670103, 'eval_recall': 0.4868871151653364, 'eval_f1': 0.4623714131023281, 'eval_accuracy': 0.948197328804138, 'eval_runtime': 4.6534, 'eval_samples_per_second': 329.009, 'eval_steps_per_second': 41.26, 'epoch': 15.0}
{'loss': 0.1394, 'learning_rate': 2e-07, 'epoch': 16.0}
{'eval_loss': 0.15284034609794617, 'eval_precision': 0.4442105263157895, 'eval_recall': 0.4811858608893957, 'eval_f1': 0.46195949644225515, 'eval_accuracy': 0.9487763452482051, 'eval_runtime': 4.6444, 'eval_samples_per_second': 329.645, 'eval_steps_per_second': 41.34, 'epoch': 16.0}
{'loss': 0.1384, 'learning_rate': 1.5e-07, 'epoch': 17.0}
{'eval_loss': 0.15382274985313416, 'eval_precision': 0.43478260869565216, 'eval_recall': 0.5017103762827823, 'eval_f1': 0.4658549497088406, 'eval_accuracy': 0.9479657222265112, 'eval_runtime': 4.6632, 'eval_samples_per_second': 328.316, 'eval_steps_per_second': 41.174, 'epoch': 17.0}
{'loss': 0.1367, 'learning_rate': 1e-07, 'epoch': 18.0}
{'eval_loss': 0.15261703729629517, 'eval_precision': 0.4454828660436137, 'eval_recall': 0.48916761687571264, 'eval_f1': 0.46630434782608693, 'eval_accuracy': 0.9489307496332896, 'eval_runtime': 4.6643, 'eval_samples_per_second': 328.24, 'eval_steps_per_second': 41.164, 'epoch': 18.0}
{'loss': 0.1364, 'learning_rate': 5e-08, 'epoch': 19.0}
{'eval_loss': 0.1522795855998993, 'eval_precision': 0.44676409185803756, 'eval_recall': 0.4880273660205245, 'eval_f1': 0.46648501362397815, 'eval_accuracy': 0.9490079518258319, 'eval_runtime': 4.6545, 'eval_samples_per_second': 328.93, 'eval_steps_per_second': 41.251, 'epoch': 19.0}
{'loss': 0.1357, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.15260790288448334, 'eval_precision': 0.4455852156057495, 'eval_recall': 0.49486887115165334, 'eval_f1': 0.4689357104267963, 'eval_accuracy': 0.9485061375743071, 'eval_runtime': 4.7266, 'eval_samples_per_second': 323.913, 'eval_steps_per_second': 40.621, 'epoch': 20.0}
{'train_runtime': 1740.1117, 'train_samples_per_second': 99.235, 'train_steps_per_second': 1.552, 'train_loss': 0.1894424424348054, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.1894
  train_runtime            = 0:29:00.11
  train_samples            =       8634
  train_samples_per_second =     99.235
  train_steps_per_second   =      1.552
[{'loss': 0.5555, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.29050397872924805, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341465297614452, 'eval_runtime': 4.6759, 'eval_samples_per_second': 327.422, 'eval_steps_per_second': 41.061, 'epoch': 1.0, 'step': 135}, {'loss': 0.2813, 'learning_rate': 9e-07, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.251107394695282, 'eval_precision': 0.1527777777777778, 'eval_recall': 0.012542759407069556, 'eval_f1': 0.023182297154899893, 'eval_accuracy': 0.9344167374353431, 'eval_runtime': 4.6547, 'eval_samples_per_second': 328.914, 'eval_steps_per_second': 41.249, 'epoch': 2.0, 'step': 270}, {'loss': 0.2478, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.22573541104793549, 'eval_precision': 0.2882882882882883, 'eval_recall': 0.10946408209806158, 'eval_f1': 0.1586776859504132, 'eval_accuracy': 0.9371960163668648, 'eval_runtime': 4.652, 'eval_samples_per_second': 329.103, 'eval_steps_per_second': 41.272, 'epoch': 3.0, 'step': 405}, {'loss': 0.2234, 'learning_rate': 8e-07, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.2063935548067093, 'eval_precision': 0.3403846153846154, 'eval_recall': 0.20182440136830102, 'eval_f1': 0.2534001431639227, 'eval_accuracy': 0.9402069018760133, 'eval_runtime': 4.6524, 'eval_samples_per_second': 329.076, 'eval_steps_per_second': 41.269, 'epoch': 4.0, 'step': 540}, {'loss': 0.2054, 'learning_rate': 7.5e-07, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.19154804944992065, 'eval_precision': 0.3668730650154799, 'eval_recall': 0.2702394526795895, 'eval_f1': 0.3112278397898884, 'eval_accuracy': 0.9432177873851617, 'eval_runtime': 4.6534, 'eval_samples_per_second': 329.004, 'eval_steps_per_second': 41.26, 'epoch': 5.0, 'step': 675}, {'loss': 0.1913, 'learning_rate': 7e-07, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.18045024573802948, 'eval_precision': 0.38161209068010077, 'eval_recall': 0.34549600912200684, 'eval_f1': 0.362657091561939, 'eval_accuracy': 0.9446074268509226, 'eval_runtime': 4.6435, 'eval_samples_per_second': 329.711, 'eval_steps_per_second': 41.348, 'epoch': 6.0, 'step': 810}, {'loss': 0.1788, 'learning_rate': 6.5e-07, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.171584814786911, 'eval_precision': 0.3946449359720605, 'eval_recall': 0.3865450399087799, 'eval_f1': 0.390552995391705, 'eval_accuracy': 0.9463830772793947, 'eval_runtime': 4.6583, 'eval_samples_per_second': 328.664, 'eval_steps_per_second': 41.217, 'epoch': 7.0, 'step': 945}, {'loss': 0.169, 'learning_rate': 6e-07, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.16626209020614624, 'eval_precision': 0.3956756756756757, 'eval_recall': 0.41733181299885974, 'eval_f1': 0.4062153163152053, 'eval_accuracy': 0.9465374816644793, 'eval_runtime': 4.6641, 'eval_samples_per_second': 328.252, 'eval_steps_per_second': 41.165, 'epoch': 8.0, 'step': 1080}, {'loss': 0.1623, 'learning_rate': 5.5e-07, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.16298706829547882, 'eval_precision': 0.39710444674250256, 'eval_recall': 0.4378563283922463, 'eval_f1': 0.4164859002169197, 'eval_accuracy': 0.946460279471937, 'eval_runtime': 4.669, 'eval_samples_per_second': 327.909, 'eval_steps_per_second': 41.122, 'epoch': 9.0, 'step': 1215}, {'loss': 0.157, 'learning_rate': 5e-07, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.15895351767539978, 'eval_precision': 0.4323094425483504, 'eval_recall': 0.43329532497149376, 'eval_f1': 0.4328018223234624, 'eval_accuracy': 0.9481201266115957, 'eval_runtime': 4.662, 'eval_samples_per_second': 328.401, 'eval_steps_per_second': 41.184, 'epoch': 10.0, 'step': 1350}, {'loss': 0.1516, 'learning_rate': 4.5e-07, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.15775039792060852, 'eval_precision': 0.42340425531914894, 'eval_recall': 0.45381984036488027, 'eval_f1': 0.4380847550908091, 'eval_accuracy': 0.9478113178414267, 'eval_runtime': 4.6542, 'eval_samples_per_second': 328.949, 'eval_steps_per_second': 41.253, 'epoch': 11.0, 'step': 1485}, {'loss': 0.1484, 'learning_rate': 4e-07, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.15567921102046967, 'eval_precision': 0.43952483801295894, 'eval_recall': 0.4640820980615735, 'eval_f1': 0.4514697726012202, 'eval_accuracy': 0.948197328804138, 'eval_runtime': 4.6627, 'eval_samples_per_second': 328.35, 'eval_steps_per_second': 41.178, 'epoch': 12.0, 'step': 1620}, {'loss': 0.1458, 'learning_rate': 3.5e-07, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.1548585146665573, 'eval_precision': 0.44139387539598735, 'eval_recall': 0.4766248574686431, 'eval_f1': 0.4583333333333333, 'eval_accuracy': 0.9480429244190535, 'eval_runtime': 4.6567, 'eval_samples_per_second': 328.771, 'eval_steps_per_second': 41.231, 'epoch': 13.0, 'step': 1755}, {'loss': 0.1429, 'learning_rate': 3e-07, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.1547013819217682, 'eval_precision': 0.43782117163412126, 'eval_recall': 0.48574686431014824, 'eval_f1': 0.46054054054054056, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 4.6555, 'eval_samples_per_second': 328.859, 'eval_steps_per_second': 41.242, 'epoch': 14.0, 'step': 1890}, {'loss': 0.1416, 'learning_rate': 2.5e-07, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.15401248633861542, 'eval_precision': 0.4402061855670103, 'eval_recall': 0.4868871151653364, 'eval_f1': 0.4623714131023281, 'eval_accuracy': 0.948197328804138, 'eval_runtime': 4.6534, 'eval_samples_per_second': 329.009, 'eval_steps_per_second': 41.26, 'epoch': 15.0, 'step': 2025}, {'loss': 0.1394, 'learning_rate': 2e-07, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.15284034609794617, 'eval_precision': 0.4442105263157895, 'eval_recall': 0.4811858608893957, 'eval_f1': 0.46195949644225515, 'eval_accuracy': 0.9487763452482051, 'eval_runtime': 4.6444, 'eval_samples_per_second': 329.645, 'eval_steps_per_second': 41.34, 'epoch': 16.0, 'step': 2160}, {'loss': 0.1384, 'learning_rate': 1.5e-07, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.15382274985313416, 'eval_precision': 0.43478260869565216, 'eval_recall': 0.5017103762827823, 'eval_f1': 0.4658549497088406, 'eval_accuracy': 0.9479657222265112, 'eval_runtime': 4.6632, 'eval_samples_per_second': 328.316, 'eval_steps_per_second': 41.174, 'epoch': 17.0, 'step': 2295}, {'loss': 0.1367, 'learning_rate': 1e-07, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.15261703729629517, 'eval_precision': 0.4454828660436137, 'eval_recall': 0.48916761687571264, 'eval_f1': 0.46630434782608693, 'eval_accuracy': 0.9489307496332896, 'eval_runtime': 4.6643, 'eval_samples_per_second': 328.24, 'eval_steps_per_second': 41.164, 'epoch': 18.0, 'step': 2430}, {'loss': 0.1364, 'learning_rate': 5e-08, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.1522795855998993, 'eval_precision': 0.44676409185803756, 'eval_recall': 0.4880273660205245, 'eval_f1': 0.46648501362397815, 'eval_accuracy': 0.9490079518258319, 'eval_runtime': 4.6545, 'eval_samples_per_second': 328.93, 'eval_steps_per_second': 41.251, 'epoch': 19.0, 'step': 2565}, {'loss': 0.1357, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.15260790288448334, 'eval_precision': 0.4455852156057495, 'eval_recall': 0.49486887115165334, 'eval_f1': 0.4689357104267963, 'eval_accuracy': 0.9485061375743071, 'eval_runtime': 4.7266, 'eval_samples_per_second': 323.913, 'eval_steps_per_second': 40.621, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 1740.1117, 'train_samples_per_second': 99.235, 'train_steps_per_second': 1.552, 'total_flos': 2.164333754205036e+16, 'train_loss': 0.1894424424348054, 'epoch': 20.0, 'step': 2700}]

Evaluation, NbAiLab/nb-bert-large
***** predict metrics *****
  predict_accuracy           =     0.9522
  predict_f1                 =     0.4541
  predict_loss               =     0.1553
  predict_precision          =     0.4472
  predict_recall             =     0.4612
  predict_runtime            = 0:00:03.91
  predict_samples_per_second =    324.768
  predict_steps_per_second   =     40.596
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_19.json completed. F1: 0.45411922304085733
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_09.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_09.json
01150927_tsa-bin_NorBERT_3_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6009.53 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6769.20 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6782.70 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6932.30 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 7006.20 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7165.60 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7334.66 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 7411.95 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6772.93 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7427.58 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7081.68 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7110.58 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6945.27 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 1.2186, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': 0.794398844242096, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0542, 'eval_samples_per_second': 501.269, 'eval_steps_per_second': 62.863, 'epoch': 1.0}
{'loss': 0.5609, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': 0.4007306396961212, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.998, 'eval_samples_per_second': 510.67, 'eval_steps_per_second': 64.042, 'epoch': 2.0}
{'loss': 0.3411, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': 0.2630884647369385, 'eval_precision': 0.2403846153846154, 'eval_recall': 0.028506271379703536, 'eval_f1': 0.0509683995922528, 'eval_accuracy': 0.9351115571682236, 'eval_runtime': 2.9904, 'eval_samples_per_second': 511.98, 'eval_steps_per_second': 64.206, 'epoch': 3.0}
{'loss': 0.2396, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': 0.21266146004199982, 'eval_precision': 0.21408839779005526, 'eval_recall': 0.17673888255416192, 'eval_f1': 0.19362898188632105, 'eval_accuracy': 0.9393962788543194, 'eval_runtime': 2.9916, 'eval_samples_per_second': 511.764, 'eval_steps_per_second': 64.179, 'epoch': 4.0}
{'loss': 0.1948, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': 0.1934785395860672, 'eval_precision': 0.42168674698795183, 'eval_recall': 0.3990877993158495, 'eval_f1': 0.41007615700058586, 'eval_accuracy': 0.9475797112637999, 'eval_runtime': 2.9913, 'eval_samples_per_second': 511.823, 'eval_steps_per_second': 64.187, 'epoch': 5.0}
{'loss': 0.1513, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': 0.18155480921268463, 'eval_precision': 0.4806701030927835, 'eval_recall': 0.42531356898517675, 'eval_f1': 0.4513006654567453, 'eval_accuracy': 0.9493553616922721, 'eval_runtime': 2.9915, 'eval_samples_per_second': 511.777, 'eval_steps_per_second': 64.181, 'epoch': 6.0}
{'loss': 0.124, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': 0.18265573680400848, 'eval_precision': 0.4635352286773795, 'eval_recall': 0.427594070695553, 'eval_f1': 0.44483985765124556, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 2.9969, 'eval_samples_per_second': 510.868, 'eval_steps_per_second': 64.067, 'epoch': 7.0}
{'loss': 0.1034, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': 0.18246355652809143, 'eval_precision': 0.49410377358490565, 'eval_recall': 0.47776510832383123, 'eval_f1': 0.48579710144927535, 'eval_accuracy': 0.9500501814251525, 'eval_runtime': 2.9853, 'eval_samples_per_second': 512.848, 'eval_steps_per_second': 64.315, 'epoch': 8.0}
{'loss': 0.0847, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': 0.1840629130601883, 'eval_precision': 0.5168918918918919, 'eval_recall': 0.5233751425313569, 'eval_f1': 0.520113314447592, 'eval_accuracy': 0.9515942252759978, 'eval_runtime': 2.9854, 'eval_samples_per_second': 512.826, 'eval_steps_per_second': 64.313, 'epoch': 9.0}
{'loss': 0.0723, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': 0.1860300749540329, 'eval_precision': 0.5067114093959731, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.5115753811405985, 'eval_accuracy': 0.9517872307573535, 'eval_runtime': 3.0595, 'eval_samples_per_second': 500.412, 'eval_steps_per_second': 62.756, 'epoch': 10.0}
{'loss': 0.0617, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': 0.19247600436210632, 'eval_precision': 0.4968220338983051, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.5151015925315761, 'eval_accuracy': 0.9507064000617618, 'eval_runtime': 2.9902, 'eval_samples_per_second': 512.012, 'eval_steps_per_second': 64.211, 'epoch': 11.0}
{'loss': 0.0549, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': 0.19970732927322388, 'eval_precision': 0.5064239828693791, 'eval_recall': 0.5393386545039909, 'eval_f1': 0.5223633351739371, 'eval_accuracy': 0.9500115803288813, 'eval_runtime': 2.985, 'eval_samples_per_second': 512.895, 'eval_steps_per_second': 64.321, 'epoch': 12.0}
{'loss': 0.0485, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': 0.19920185208320618, 'eval_precision': 0.5184770436730123, 'eval_recall': 0.5279361459521095, 'eval_f1': 0.5231638418079096, 'eval_accuracy': 0.9512854165058288, 'eval_runtime': 2.9992, 'eval_samples_per_second': 510.467, 'eval_steps_per_second': 64.017, 'epoch': 13.0}
{'loss': 0.0439, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': 0.20209525525569916, 'eval_precision': 0.523094688221709, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.5197934595524958, 'eval_accuracy': 0.9515942252759978, 'eval_runtime': 2.9759, 'eval_samples_per_second': 514.465, 'eval_steps_per_second': 64.518, 'epoch': 14.0}
{'loss': 0.0397, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': 0.2101035714149475, 'eval_precision': 0.4973432518597237, 'eval_recall': 0.5336374002280502, 'eval_f1': 0.5148514851485149, 'eval_accuracy': 0.9486219408631205, 'eval_runtime': 2.9862, 'eval_samples_per_second': 512.691, 'eval_steps_per_second': 64.296, 'epoch': 15.0}
{'loss': 0.0365, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': 0.2092127650976181, 'eval_precision': 0.5010940919037199, 'eval_recall': 0.5222348916761688, 'eval_f1': 0.5114461194863205, 'eval_accuracy': 0.9495869682698989, 'eval_runtime': 2.9691, 'eval_samples_per_second': 515.642, 'eval_steps_per_second': 64.666, 'epoch': 16.0}
{'loss': 0.034, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': 0.21336588263511658, 'eval_precision': 0.49264705882352944, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.512848551120831, 'eval_accuracy': 0.9491623562109164, 'eval_runtime': 2.9727, 'eval_samples_per_second': 515.014, 'eval_steps_per_second': 64.587, 'epoch': 17.0}
{'loss': 0.032, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': 0.2124256044626236, 'eval_precision': 0.49731471535982813, 'eval_recall': 0.5279361459521095, 'eval_f1': 0.5121681415929203, 'eval_accuracy': 0.9497799737512546, 'eval_runtime': 2.9734, 'eval_samples_per_second': 514.905, 'eval_steps_per_second': 64.573, 'epoch': 18.0}
{'loss': 0.0308, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': 0.21333663165569305, 'eval_precision': 0.5010964912280702, 'eval_recall': 0.5210946408209807, 'eval_f1': 0.5108999441028508, 'eval_accuracy': 0.9501273836176948, 'eval_runtime': 2.9786, 'eval_samples_per_second': 513.999, 'eval_steps_per_second': 64.46, 'epoch': 19.0}
{'loss': 0.0301, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.21402469277381897, 'eval_precision': 0.49623250807319697, 'eval_recall': 0.5256556442417332, 'eval_f1': 0.5105204872646733, 'eval_accuracy': 0.9498571759437968, 'eval_runtime': 2.9842, 'eval_samples_per_second': 513.035, 'eval_steps_per_second': 64.339, 'epoch': 20.0}
{'train_runtime': 706.5014, 'train_samples_per_second': 244.416, 'train_steps_per_second': 3.822, 'train_loss': 0.17514460934533013, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.1751
  train_runtime            = 0:11:46.50
  train_samples            =       8634
  train_samples_per_second =    244.416
  train_steps_per_second   =      3.822
[{'loss': 1.2186, 'learning_rate': 9.5e-06, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.794398844242096, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0542, 'eval_samples_per_second': 501.269, 'eval_steps_per_second': 62.863, 'epoch': 1.0, 'step': 135}, {'loss': 0.5609, 'learning_rate': 9e-06, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.4007306396961212, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.998, 'eval_samples_per_second': 510.67, 'eval_steps_per_second': 64.042, 'epoch': 2.0, 'step': 270}, {'loss': 0.3411, 'learning_rate': 8.5e-06, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.2630884647369385, 'eval_precision': 0.2403846153846154, 'eval_recall': 0.028506271379703536, 'eval_f1': 0.0509683995922528, 'eval_accuracy': 0.9351115571682236, 'eval_runtime': 2.9904, 'eval_samples_per_second': 511.98, 'eval_steps_per_second': 64.206, 'epoch': 3.0, 'step': 405}, {'loss': 0.2396, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.21266146004199982, 'eval_precision': 0.21408839779005526, 'eval_recall': 0.17673888255416192, 'eval_f1': 0.19362898188632105, 'eval_accuracy': 0.9393962788543194, 'eval_runtime': 2.9916, 'eval_samples_per_second': 511.764, 'eval_steps_per_second': 64.179, 'epoch': 4.0, 'step': 540}, {'loss': 0.1948, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.1934785395860672, 'eval_precision': 0.42168674698795183, 'eval_recall': 0.3990877993158495, 'eval_f1': 0.41007615700058586, 'eval_accuracy': 0.9475797112637999, 'eval_runtime': 2.9913, 'eval_samples_per_second': 511.823, 'eval_steps_per_second': 64.187, 'epoch': 5.0, 'step': 675}, {'loss': 0.1513, 'learning_rate': 7e-06, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.18155480921268463, 'eval_precision': 0.4806701030927835, 'eval_recall': 0.42531356898517675, 'eval_f1': 0.4513006654567453, 'eval_accuracy': 0.9493553616922721, 'eval_runtime': 2.9915, 'eval_samples_per_second': 511.777, 'eval_steps_per_second': 64.181, 'epoch': 6.0, 'step': 810}, {'loss': 0.124, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.18265573680400848, 'eval_precision': 0.4635352286773795, 'eval_recall': 0.427594070695553, 'eval_f1': 0.44483985765124556, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 2.9969, 'eval_samples_per_second': 510.868, 'eval_steps_per_second': 64.067, 'epoch': 7.0, 'step': 945}, {'loss': 0.1034, 'learning_rate': 6e-06, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.18246355652809143, 'eval_precision': 0.49410377358490565, 'eval_recall': 0.47776510832383123, 'eval_f1': 0.48579710144927535, 'eval_accuracy': 0.9500501814251525, 'eval_runtime': 2.9853, 'eval_samples_per_second': 512.848, 'eval_steps_per_second': 64.315, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0847, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.1840629130601883, 'eval_precision': 0.5168918918918919, 'eval_recall': 0.5233751425313569, 'eval_f1': 0.520113314447592, 'eval_accuracy': 0.9515942252759978, 'eval_runtime': 2.9854, 'eval_samples_per_second': 512.826, 'eval_steps_per_second': 64.313, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0723, 'learning_rate': 5e-06, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.1860300749540329, 'eval_precision': 0.5067114093959731, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.5115753811405985, 'eval_accuracy': 0.9517872307573535, 'eval_runtime': 3.0595, 'eval_samples_per_second': 500.412, 'eval_steps_per_second': 62.756, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0617, 'learning_rate': 4.5e-06, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.19247600436210632, 'eval_precision': 0.4968220338983051, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.5151015925315761, 'eval_accuracy': 0.9507064000617618, 'eval_runtime': 2.9902, 'eval_samples_per_second': 512.012, 'eval_steps_per_second': 64.211, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0549, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.19970732927322388, 'eval_precision': 0.5064239828693791, 'eval_recall': 0.5393386545039909, 'eval_f1': 0.5223633351739371, 'eval_accuracy': 0.9500115803288813, 'eval_runtime': 2.985, 'eval_samples_per_second': 512.895, 'eval_steps_per_second': 64.321, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0485, 'learning_rate': 3.5e-06, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.19920185208320618, 'eval_precision': 0.5184770436730123, 'eval_recall': 0.5279361459521095, 'eval_f1': 0.5231638418079096, 'eval_accuracy': 0.9512854165058288, 'eval_runtime': 2.9992, 'eval_samples_per_second': 510.467, 'eval_steps_per_second': 64.017, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0439, 'learning_rate': 3e-06, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.20209525525569916, 'eval_precision': 0.523094688221709, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.5197934595524958, 'eval_accuracy': 0.9515942252759978, 'eval_runtime': 2.9759, 'eval_samples_per_second': 514.465, 'eval_steps_per_second': 64.518, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0397, 'learning_rate': 2.5e-06, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.2101035714149475, 'eval_precision': 0.4973432518597237, 'eval_recall': 0.5336374002280502, 'eval_f1': 0.5148514851485149, 'eval_accuracy': 0.9486219408631205, 'eval_runtime': 2.9862, 'eval_samples_per_second': 512.691, 'eval_steps_per_second': 64.296, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0365, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.2092127650976181, 'eval_precision': 0.5010940919037199, 'eval_recall': 0.5222348916761688, 'eval_f1': 0.5114461194863205, 'eval_accuracy': 0.9495869682698989, 'eval_runtime': 2.9691, 'eval_samples_per_second': 515.642, 'eval_steps_per_second': 64.666, 'epoch': 16.0, 'step': 2160}, {'loss': 0.034, 'learning_rate': 1.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.21336588263511658, 'eval_precision': 0.49264705882352944, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.512848551120831, 'eval_accuracy': 0.9491623562109164, 'eval_runtime': 2.9727, 'eval_samples_per_second': 515.014, 'eval_steps_per_second': 64.587, 'epoch': 17.0, 'step': 2295}, {'loss': 0.032, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.2124256044626236, 'eval_precision': 0.49731471535982813, 'eval_recall': 0.5279361459521095, 'eval_f1': 0.5121681415929203, 'eval_accuracy': 0.9497799737512546, 'eval_runtime': 2.9734, 'eval_samples_per_second': 514.905, 'eval_steps_per_second': 64.573, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0308, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.21333663165569305, 'eval_precision': 0.5010964912280702, 'eval_recall': 0.5210946408209807, 'eval_f1': 0.5108999441028508, 'eval_accuracy': 0.9501273836176948, 'eval_runtime': 2.9786, 'eval_samples_per_second': 513.999, 'eval_steps_per_second': 64.46, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0301, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.21402469277381897, 'eval_precision': 0.49623250807319697, 'eval_recall': 0.5256556442417332, 'eval_f1': 0.5105204872646733, 'eval_accuracy': 0.9498571759437968, 'eval_runtime': 2.9842, 'eval_samples_per_second': 513.035, 'eval_steps_per_second': 64.339, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 706.5014, 'train_samples_per_second': 244.416, 'train_steps_per_second': 3.822, 'total_flos': 6363267648107904.0, 'train_loss': 0.17514460934533013, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-base
***** predict metrics *****
  predict_accuracy           =     0.9511
  predict_f1                 =     0.4288
  predict_loss               =     0.1829
  predict_precision          =     0.4904
  predict_recall             =      0.381
  predict_runtime            = 0:00:02.48
  predict_samples_per_second =     511.36
  predict_steps_per_second   =      63.92
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_base_09.json completed. F1: 0.4287901990811639
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_06.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_06.json
config.json:   0%|          | 0.00/951 [00:00<?, ?B/s]config.json: 100%|██████████| 951/951 [00:00<00:00, 9.59MB/s]
configuration_norbert.py:   0%|          | 0.00/1.23k [00:00<?, ?B/s]configuration_norbert.py: 100%|██████████| 1.23k/1.23k [00:00<00:00, 9.07MB/s]
tokenizer_config.json:   0%|          | 0.00/51.0 [00:00<?, ?B/s]tokenizer_config.json: 100%|██████████| 51.0/51.0 [00:00<00:00, 526kB/s]
tokenizer.json:   0%|          | 0.00/1.26M [00:00<?, ?B/s]tokenizer.json: 100%|██████████| 1.26M/1.26M [00:00<00:00, 6.19MB/s]tokenizer.json: 100%|██████████| 1.26M/1.26M [00:00<00:00, 6.18MB/s]
special_tokens_map.json:   0%|          | 0.00/157 [00:00<?, ?B/s]special_tokens_map.json: 100%|██████████| 157/157 [00:00<00:00, 1.94MB/s]
pytorch_model.bin:   0%|          | 0.00/1.47G [00:00<?, ?B/s]pytorch_model.bin:   1%|          | 10.5M/1.47G [00:00<00:33, 43.2MB/s]pytorch_model.bin:   1%|▏         | 21.0M/1.47G [00:00<00:23, 62.2MB/s]pytorch_model.bin:   2%|▏         | 31.5M/1.47G [00:00<00:19, 75.3MB/s]pytorch_model.bin:   4%|▎         | 52.4M/1.47G [00:00<00:15, 93.0MB/s]pytorch_model.bin:   5%|▍         | 73.4M/1.47G [00:00<00:13, 102MB/s] pytorch_model.bin:   6%|▋         | 94.4M/1.47G [00:01<00:12, 107MB/s]pytorch_model.bin:   8%|▊         | 115M/1.47G [00:01<00:12, 111MB/s] pytorch_model.bin:   9%|▉         | 136M/1.47G [00:01<00:11, 113MB/s]pytorch_model.bin:  11%|█         | 157M/1.47G [00:01<00:11, 114MB/s]pytorch_model.bin:  12%|█▏        | 178M/1.47G [00:01<00:11, 115MB/s]pytorch_model.bin:  14%|█▎        | 199M/1.47G [00:01<00:10, 116MB/s]pytorch_model.bin:  15%|█▍        | 220M/1.47G [00:02<00:10, 116MB/s]pytorch_model.bin:  16%|█▋        | 241M/1.47G [00:02<00:10, 117MB/s]pytorch_model.bin:  18%|█▊        | 262M/1.47G [00:02<00:10, 117MB/s]pytorch_model.bin:  19%|█▉        | 283M/1.47G [00:02<00:10, 117MB/s]pytorch_model.bin:  21%|██        | 304M/1.47G [00:02<00:09, 117MB/s]pytorch_model.bin:  22%|██▏       | 325M/1.47G [00:02<00:09, 117MB/s]pytorch_model.bin:  24%|██▎       | 346M/1.47G [00:03<00:09, 117MB/s]pytorch_model.bin:  25%|██▍       | 367M/1.47G [00:03<00:09, 117MB/s]pytorch_model.bin:  26%|██▋       | 388M/1.47G [00:03<00:09, 117MB/s]pytorch_model.bin:  28%|██▊       | 409M/1.47G [00:03<00:09, 117MB/s]pytorch_model.bin:  29%|██▉       | 430M/1.47G [00:03<00:08, 117MB/s]pytorch_model.bin:  31%|███       | 451M/1.47G [00:04<00:08, 117MB/s]pytorch_model.bin:  32%|███▏      | 472M/1.47G [00:04<00:08, 117MB/s]pytorch_model.bin:  34%|███▎      | 493M/1.47G [00:04<00:08, 117MB/s]pytorch_model.bin:  35%|███▍      | 514M/1.47G [00:04<00:08, 116MB/s]pytorch_model.bin:  36%|███▋      | 535M/1.47G [00:04<00:08, 114MB/s]pytorch_model.bin:  38%|███▊      | 556M/1.47G [00:04<00:08, 113MB/s]pytorch_model.bin:  39%|███▉      | 577M/1.47G [00:05<00:07, 113MB/s]pytorch_model.bin:  41%|████      | 598M/1.47G [00:05<00:07, 114MB/s]pytorch_model.bin:  42%|████▏     | 619M/1.47G [00:05<00:07, 112MB/s]pytorch_model.bin:  44%|████▎     | 640M/1.47G [00:05<00:07, 111MB/s]pytorch_model.bin:  45%|████▍     | 661M/1.47G [00:05<00:07, 112MB/s]pytorch_model.bin:  46%|████▋     | 682M/1.47G [00:06<00:06, 113MB/s]pytorch_model.bin:  48%|████▊     | 703M/1.47G [00:06<00:06, 114MB/s]pytorch_model.bin:  49%|████▉     | 724M/1.47G [00:06<00:06, 115MB/s]pytorch_model.bin:  51%|█████     | 744M/1.47G [00:06<00:06, 115MB/s]pytorch_model.bin:  52%|█████▏    | 765M/1.47G [00:06<00:06, 114MB/s]pytorch_model.bin:  54%|█████▎    | 786M/1.47G [00:07<00:06, 113MB/s]pytorch_model.bin:  55%|█████▍    | 807M/1.47G [00:07<00:05, 113MB/s]pytorch_model.bin:  56%|█████▋    | 828M/1.47G [00:07<00:05, 114MB/s]pytorch_model.bin:  58%|█████▊    | 849M/1.47G [00:07<00:05, 113MB/s]pytorch_model.bin:  59%|█████▉    | 870M/1.47G [00:07<00:05, 111MB/s]pytorch_model.bin:  61%|██████    | 891M/1.47G [00:07<00:05, 111MB/s]pytorch_model.bin:  62%|██████▏   | 912M/1.47G [00:08<00:05, 111MB/s]pytorch_model.bin:  64%|██████▎   | 933M/1.47G [00:08<00:04, 112MB/s]pytorch_model.bin:  65%|██████▍   | 954M/1.47G [00:08<00:04, 114MB/s]pytorch_model.bin:  66%|██████▋   | 975M/1.47G [00:08<00:04, 115MB/s]pytorch_model.bin:  68%|██████▊   | 996M/1.47G [00:08<00:04, 115MB/s]pytorch_model.bin:  69%|██████▉   | 1.02G/1.47G [00:09<00:03, 116MB/s]pytorch_model.bin:  71%|███████   | 1.04G/1.47G [00:09<00:03, 114MB/s]pytorch_model.bin:  72%|███████▏  | 1.06G/1.47G [00:09<00:03, 113MB/s]pytorch_model.bin:  74%|███████▎  | 1.08G/1.47G [00:09<00:03, 113MB/s]pytorch_model.bin:  75%|███████▍  | 1.10G/1.47G [00:09<00:03, 111MB/s]pytorch_model.bin:  76%|███████▋  | 1.12G/1.47G [00:09<00:03, 112MB/s]pytorch_model.bin:  78%|███████▊  | 1.14G/1.47G [00:10<00:03, 86.8MB/s]pytorch_model.bin:  79%|███████▊  | 1.15G/1.47G [00:10<00:03, 80.1MB/s]pytorch_model.bin:  79%|███████▉  | 1.16G/1.47G [00:10<00:03, 83.5MB/s]pytorch_model.bin:  80%|███████▉  | 1.17G/1.47G [00:10<00:03, 84.3MB/s]pytorch_model.bin:  81%|████████▏ | 1.20G/1.47G [00:10<00:03, 88.5MB/s]pytorch_model.bin:  82%|████████▏ | 1.21G/1.47G [00:11<00:03, 75.3MB/s]pytorch_model.bin:  83%|████████▎ | 1.22G/1.47G [00:11<00:03, 74.9MB/s]pytorch_model.bin:  84%|████████▎ | 1.23G/1.47G [00:11<00:03, 64.9MB/s]pytorch_model.bin:  84%|████████▍ | 1.24G/1.47G [00:11<00:03, 66.8MB/s]pytorch_model.bin:  85%|████████▍ | 1.25G/1.47G [00:11<00:03, 64.4MB/s]pytorch_model.bin:  86%|████████▌ | 1.26G/1.47G [00:12<00:03, 64.9MB/s]pytorch_model.bin:  86%|████████▋ | 1.27G/1.47G [00:12<00:03, 65.8MB/s]pytorch_model.bin:  87%|████████▋ | 1.28G/1.47G [00:12<00:02, 66.0MB/s]pytorch_model.bin:  89%|████████▊ | 1.30G/1.47G [00:12<00:02, 71.3MB/s]pytorch_model.bin:  89%|████████▉ | 1.31G/1.47G [00:12<00:02, 72.4MB/s]pytorch_model.bin:  91%|█████████ | 1.33G/1.47G [00:12<00:01, 85.1MB/s]pytorch_model.bin:  92%|█████████▏| 1.35G/1.47G [00:13<00:01, 94.2MB/s]pytorch_model.bin:  94%|█████████▎| 1.37G/1.47G [00:13<00:00, 99.1MB/s]pytorch_model.bin:  94%|█████████▍| 1.38G/1.47G [00:13<00:00, 99.9MB/s]pytorch_model.bin:  96%|█████████▌| 1.41G/1.47G [00:13<00:00, 104MB/s] pytorch_model.bin:  97%|█████████▋| 1.43G/1.47G [00:13<00:00, 107MB/s]pytorch_model.bin:  99%|█████████▊| 1.45G/1.47G [00:13<00:00, 107MB/s]pytorch_model.bin: 100%|█████████▉| 1.47G/1.47G [00:14<00:00, 109MB/s]pytorch_model.bin: 100%|██████████| 1.47G/1.47G [00:14<00:00, 104MB/s]
01150927_tsa-bin_NorBERT_3_large Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6082.68 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6853.10 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6795.89 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6897.84 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6977.61 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7121.55 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7299.72 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6387.48 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6741.10 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7303.42 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6987.04 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7051.83 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6887.55 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_large Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'learning_rate': 4.75e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7911, 'eval_samples_per_second': 264.371, 'eval_steps_per_second': 33.154, 'epoch': 1.0}
{'loss': 0.0, 'learning_rate': 4.5e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7369, 'eval_samples_per_second': 266.867, 'eval_steps_per_second': 33.467, 'epoch': 2.0}
{'loss': 0.0, 'learning_rate': 4.25e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7269, 'eval_samples_per_second': 267.335, 'eval_steps_per_second': 33.526, 'epoch': 3.0}
{'loss': 0.0, 'learning_rate': 4e-05, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7366, 'eval_samples_per_second': 266.882, 'eval_steps_per_second': 33.469, 'epoch': 4.0}
{'loss': 0.0, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7453, 'eval_samples_per_second': 266.477, 'eval_steps_per_second': 33.418, 'epoch': 5.0}
{'loss': 0.0, 'learning_rate': 3.5e-05, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7613, 'eval_samples_per_second': 265.738, 'eval_steps_per_second': 33.326, 'epoch': 6.0}
{'loss': 0.0, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7352, 'eval_samples_per_second': 266.947, 'eval_steps_per_second': 33.477, 'epoch': 7.0}
{'loss': 0.0, 'learning_rate': 3e-05, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7323, 'eval_samples_per_second': 267.081, 'eval_steps_per_second': 33.494, 'epoch': 8.0}
{'loss': 0.0, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.811, 'eval_samples_per_second': 263.466, 'eval_steps_per_second': 33.041, 'epoch': 9.0}
{'loss': 0.0, 'learning_rate': 2.5e-05, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7241, 'eval_samples_per_second': 267.465, 'eval_steps_per_second': 33.542, 'epoch': 10.0}
{'loss': 0.0, 'learning_rate': 2.25e-05, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7353, 'eval_samples_per_second': 266.944, 'eval_steps_per_second': 33.477, 'epoch': 11.0}
{'loss': 0.0, 'learning_rate': 2e-05, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.745, 'eval_samples_per_second': 266.494, 'eval_steps_per_second': 33.421, 'epoch': 12.0}
{'loss': 0.0, 'learning_rate': 1.75e-05, 'epoch': 13.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7369, 'eval_samples_per_second': 266.868, 'eval_steps_per_second': 33.467, 'epoch': 13.0}
{'loss': 0.0, 'learning_rate': 1.5e-05, 'epoch': 14.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7664, 'eval_samples_per_second': 265.504, 'eval_steps_per_second': 33.296, 'epoch': 14.0}
{'loss': 0.0, 'learning_rate': 1.25e-05, 'epoch': 15.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8037, 'eval_samples_per_second': 263.796, 'eval_steps_per_second': 33.082, 'epoch': 15.0}
{'loss': 0.0, 'learning_rate': 1e-05, 'epoch': 16.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7629, 'eval_samples_per_second': 265.664, 'eval_steps_per_second': 33.316, 'epoch': 16.0}
{'loss': 0.0, 'learning_rate': 7.5e-06, 'epoch': 17.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.721, 'eval_samples_per_second': 267.609, 'eval_steps_per_second': 33.56, 'epoch': 17.0}
{'loss': 0.0, 'learning_rate': 5e-06, 'epoch': 18.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7061, 'eval_samples_per_second': 268.309, 'eval_steps_per_second': 33.648, 'epoch': 18.0}
{'loss': 0.0, 'learning_rate': 2.5e-06, 'epoch': 19.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7388, 'eval_samples_per_second': 266.781, 'eval_steps_per_second': 33.457, 'epoch': 19.0}
{'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8185, 'eval_samples_per_second': 263.128, 'eval_steps_per_second': 32.998, 'epoch': 20.0}
{'train_runtime': 2027.4307, 'train_samples_per_second': 85.172, 'train_steps_per_second': 1.332, 'train_loss': 0.0, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =        0.0
  train_runtime            = 0:33:47.43
  train_samples            =       8634
  train_samples_per_second =     85.172
  train_steps_per_second   =      1.332
[{'loss': 0.0, 'learning_rate': 4.75e-05, 'epoch': 1.0, 'step': 135}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7911, 'eval_samples_per_second': 264.371, 'eval_steps_per_second': 33.154, 'epoch': 1.0, 'step': 135}, {'loss': 0.0, 'learning_rate': 4.5e-05, 'epoch': 2.0, 'step': 270}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7369, 'eval_samples_per_second': 266.867, 'eval_steps_per_second': 33.467, 'epoch': 2.0, 'step': 270}, {'loss': 0.0, 'learning_rate': 4.25e-05, 'epoch': 3.0, 'step': 405}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7269, 'eval_samples_per_second': 267.335, 'eval_steps_per_second': 33.526, 'epoch': 3.0, 'step': 405}, {'loss': 0.0, 'learning_rate': 4e-05, 'epoch': 4.0, 'step': 540}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7366, 'eval_samples_per_second': 266.882, 'eval_steps_per_second': 33.469, 'epoch': 4.0, 'step': 540}, {'loss': 0.0, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0, 'step': 675}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7453, 'eval_samples_per_second': 266.477, 'eval_steps_per_second': 33.418, 'epoch': 5.0, 'step': 675}, {'loss': 0.0, 'learning_rate': 3.5e-05, 'epoch': 6.0, 'step': 810}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7613, 'eval_samples_per_second': 265.738, 'eval_steps_per_second': 33.326, 'epoch': 6.0, 'step': 810}, {'loss': 0.0, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0, 'step': 945}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7352, 'eval_samples_per_second': 266.947, 'eval_steps_per_second': 33.477, 'epoch': 7.0, 'step': 945}, {'loss': 0.0, 'learning_rate': 3e-05, 'epoch': 8.0, 'step': 1080}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7323, 'eval_samples_per_second': 267.081, 'eval_steps_per_second': 33.494, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0, 'step': 1215}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.811, 'eval_samples_per_second': 263.466, 'eval_steps_per_second': 33.041, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0, 'learning_rate': 2.5e-05, 'epoch': 10.0, 'step': 1350}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7241, 'eval_samples_per_second': 267.465, 'eval_steps_per_second': 33.542, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0, 'learning_rate': 2.25e-05, 'epoch': 11.0, 'step': 1485}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7353, 'eval_samples_per_second': 266.944, 'eval_steps_per_second': 33.477, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0, 'learning_rate': 2e-05, 'epoch': 12.0, 'step': 1620}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.745, 'eval_samples_per_second': 266.494, 'eval_steps_per_second': 33.421, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0, 'learning_rate': 1.75e-05, 'epoch': 13.0, 'step': 1755}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7369, 'eval_samples_per_second': 266.868, 'eval_steps_per_second': 33.467, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0, 'learning_rate': 1.5e-05, 'epoch': 14.0, 'step': 1890}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7664, 'eval_samples_per_second': 265.504, 'eval_steps_per_second': 33.296, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0, 'learning_rate': 1.25e-05, 'epoch': 15.0, 'step': 2025}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8037, 'eval_samples_per_second': 263.796, 'eval_steps_per_second': 33.082, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0, 'learning_rate': 1e-05, 'epoch': 16.0, 'step': 2160}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7629, 'eval_samples_per_second': 265.664, 'eval_steps_per_second': 33.316, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0, 'learning_rate': 7.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.721, 'eval_samples_per_second': 267.609, 'eval_steps_per_second': 33.56, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0, 'learning_rate': 5e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7061, 'eval_samples_per_second': 268.309, 'eval_steps_per_second': 33.648, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0, 'learning_rate': 2.5e-06, 'epoch': 19.0, 'step': 2565}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7388, 'eval_samples_per_second': 266.781, 'eval_steps_per_second': 33.457, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8185, 'eval_samples_per_second': 263.128, 'eval_steps_per_second': 32.998, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 2027.4307, 'train_samples_per_second': 85.172, 'train_steps_per_second': 1.332, 'total_flos': 2.253072487096051e+16, 'train_loss': 0.0, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9327
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.79
  predict_samples_per_second =    265.123
  predict_steps_per_second   =      33.14
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_06.json completed. F1: 0.0
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_11.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_11.json
config.json:   0%|          | 0.00/746 [00:00<?, ?B/s]config.json: 100%|██████████| 746/746 [00:00<00:00, 6.03MB/s]
tokenizer_config.json:   0%|          | 0.00/363 [00:00<?, ?B/s]tokenizer_config.json: 100%|██████████| 363/363 [00:00<00:00, 3.38MB/s]
vocab.txt:   0%|          | 0.00/996k [00:00<?, ?B/s]vocab.txt: 100%|██████████| 996k/996k [00:00<00:00, 4.91MB/s]vocab.txt: 100%|██████████| 996k/996k [00:00<00:00, 4.90MB/s]
special_tokens_map.json:   0%|          | 0.00/112 [00:00<?, ?B/s]special_tokens_map.json: 100%|██████████| 112/112 [00:00<00:00, 344kB/s]
model.safetensors:   0%|          | 0.00/714M [00:00<?, ?B/s]model.safetensors:   1%|▏         | 10.5M/714M [00:00<00:55, 12.6MB/s]model.safetensors:   3%|▎         | 21.0M/714M [00:01<00:31, 22.2MB/s]model.safetensors:   4%|▍         | 31.5M/714M [00:01<00:24, 28.0MB/s]model.safetensors:   6%|▌         | 41.9M/714M [00:01<00:21, 31.2MB/s]model.safetensors:   7%|▋         | 52.4M/714M [00:01<00:19, 33.7MB/s]model.safetensors:   9%|▉         | 62.9M/714M [00:02<00:20, 31.6MB/s]model.safetensors:  10%|█         | 73.4M/714M [00:02<00:17, 36.0MB/s]model.safetensors:  12%|█▏        | 83.9M/714M [00:02<00:17, 37.0MB/s]model.safetensors:  13%|█▎        | 94.4M/714M [00:02<00:15, 40.3MB/s]model.safetensors:  15%|█▍        | 105M/714M [00:03<00:15, 40.0MB/s] model.safetensors:  16%|█▌        | 115M/714M [00:03<00:14, 42.8MB/s]model.safetensors:  18%|█▊        | 126M/714M [00:03<00:15, 37.5MB/s]model.safetensors:  19%|█▉        | 136M/714M [00:04<00:15, 38.0MB/s]model.safetensors:  21%|██        | 147M/714M [00:04<00:13, 41.1MB/s]model.safetensors:  22%|██▏       | 157M/714M [00:04<00:13, 40.4MB/s]model.safetensors:  23%|██▎       | 168M/714M [00:04<00:13, 40.0MB/s]model.safetensors:  25%|██▍       | 178M/714M [00:04<00:12, 42.7MB/s]model.safetensors:  26%|██▋       | 189M/714M [00:05<00:12, 41.6MB/s]model.safetensors:  28%|██▊       | 199M/714M [00:05<00:11, 44.0MB/s]model.safetensors:  29%|██▉       | 210M/714M [00:05<00:13, 38.4MB/s]model.safetensors:  31%|███       | 220M/714M [00:06<00:13, 37.9MB/s]model.safetensors:  32%|███▏      | 231M/714M [00:06<00:13, 34.8MB/s]model.safetensors:  34%|███▍      | 241M/714M [00:06<00:13, 35.8MB/s]model.safetensors:  35%|███▌      | 252M/714M [00:06<00:12, 36.1MB/s]model.safetensors:  37%|███▋      | 262M/714M [00:07<00:13, 34.0MB/s]model.safetensors:  38%|███▊      | 273M/714M [00:07<00:12, 35.0MB/s]model.safetensors:  40%|███▉      | 283M/714M [00:07<00:12, 35.5MB/s]model.safetensors:  41%|████      | 294M/714M [00:08<00:11, 36.1MB/s]model.safetensors:  43%|████▎     | 304M/714M [00:08<00:11, 34.6MB/s]model.safetensors:  44%|████▍     | 315M/714M [00:08<00:11, 35.5MB/s]model.safetensors:  46%|████▌     | 325M/714M [00:09<00:10, 36.1MB/s]model.safetensors:  47%|████▋     | 336M/714M [00:09<00:10, 36.1MB/s]model.safetensors:  48%|████▊     | 346M/714M [00:09<00:10, 36.3MB/s]model.safetensors:  50%|████▉     | 357M/714M [00:09<00:09, 36.6MB/s]model.safetensors:  51%|█████▏    | 367M/714M [00:10<00:09, 36.9MB/s]model.safetensors:  53%|█████▎    | 377M/714M [00:10<00:09, 37.0MB/s]model.safetensors:  54%|█████▍    | 388M/714M [00:10<00:08, 37.3MB/s]model.safetensors:  56%|█████▌    | 398M/714M [00:11<00:08, 37.4MB/s]model.safetensors:  57%|█████▋    | 409M/714M [00:11<00:08, 37.5MB/s]model.safetensors:  59%|█████▊    | 419M/714M [00:11<00:08, 34.5MB/s]model.safetensors:  60%|██████    | 430M/714M [00:12<00:08, 32.6MB/s]model.safetensors:  62%|██████▏   | 440M/714M [00:12<00:08, 31.4MB/s]model.safetensors:  63%|██████▎   | 451M/714M [00:12<00:08, 30.7MB/s]model.safetensors:  65%|██████▍   | 461M/714M [00:13<00:08, 30.3MB/s]model.safetensors:  66%|██████▌   | 472M/714M [00:13<00:07, 30.5MB/s]model.safetensors:  68%|██████▊   | 482M/714M [00:13<00:07, 31.4MB/s]model.safetensors:  69%|██████▉   | 493M/714M [00:14<00:07, 30.7MB/s]model.safetensors:  70%|███████   | 503M/714M [00:14<00:06, 30.7MB/s]model.safetensors:  72%|███████▏  | 514M/714M [00:14<00:06, 31.8MB/s]model.safetensors:  73%|███████▎  | 524M/714M [00:15<00:06, 31.1MB/s]model.safetensors:  75%|███████▍  | 535M/714M [00:15<00:05, 31.7MB/s]model.safetensors:  76%|███████▋  | 545M/714M [00:15<00:05, 31.9MB/s]model.safetensors:  78%|███████▊  | 556M/714M [00:16<00:04, 32.3MB/s]model.safetensors:  79%|███████▉  | 566M/714M [00:16<00:04, 32.3MB/s]model.safetensors:  81%|████████  | 577M/714M [00:16<00:04, 32.7MB/s]model.safetensors:  82%|████████▏ | 587M/714M [00:17<00:03, 32.6MB/s]model.safetensors:  84%|████████▎ | 598M/714M [00:17<00:03, 32.9MB/s]model.safetensors:  85%|████████▌ | 608M/714M [00:17<00:03, 32.7MB/s]model.safetensors:  87%|████████▋ | 619M/714M [00:17<00:02, 33.8MB/s]model.safetensors:  88%|████████▊ | 629M/714M [00:18<00:02, 32.9MB/s]model.safetensors:  90%|████████▉ | 640M/714M [00:18<00:02, 33.6MB/s]model.safetensors:  91%|█████████ | 650M/714M [00:18<00:01, 32.8MB/s]model.safetensors:  92%|█████████▏| 661M/714M [00:19<00:01, 33.5MB/s]model.safetensors:  94%|█████████▍| 671M/714M [00:19<00:01, 33.5MB/s]model.safetensors:  95%|█████████▌| 682M/714M [00:19<00:00, 33.2MB/s]model.safetensors:  97%|█████████▋| 692M/714M [00:20<00:00, 34.2MB/s]model.safetensors:  98%|█████████▊| 703M/714M [00:20<00:00, 30.2MB/s]model.safetensors: 100%|█████████▉| 713M/714M [00:21<00:00, 28.0MB/s]model.safetensors: 100%|██████████| 714M/714M [00:21<00:00, 33.9MB/s]
Some weights of BertForTokenClassification were not initialized from the model checkpoint at NbAiLab/nb-bert-base and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
01150927_tsa-bin_NB-BERT_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5526.08 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:01, 6563.05 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6646.78 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6786.81 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6878.93 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7037.13 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 7220.41 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6212.92 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6580.37 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7241.78 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6911.15 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 6998.53 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6811.06 examples/s]
You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NB-BERT_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.2923, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': 0.19126799702644348, 'eval_precision': 0.3562152133580705, 'eval_recall': 0.21892816419612315, 'eval_f1': 0.2711864406779661, 'eval_accuracy': 0.9411719292827916, 'eval_runtime': 2.422, 'eval_samples_per_second': 632.127, 'eval_steps_per_second': 79.274, 'epoch': 1.0}
{'loss': 0.1803, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': 0.16828987002372742, 'eval_precision': 0.4261437908496732, 'eval_recall': 0.3717217787913341, 'eval_f1': 0.3970767356881852, 'eval_accuracy': 0.9454180498726164, 'eval_runtime': 2.3915, 'eval_samples_per_second': 640.176, 'eval_steps_per_second': 80.283, 'epoch': 2.0}
{'loss': 0.1451, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': 0.1582133024930954, 'eval_precision': 0.4686746987951807, 'eval_recall': 0.443557582668187, 'eval_f1': 0.45577035735207966, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 2.3862, 'eval_samples_per_second': 641.593, 'eval_steps_per_second': 80.461, 'epoch': 3.0}
{'loss': 0.1191, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': 0.16601243615150452, 'eval_precision': 0.44308943089430897, 'eval_recall': 0.49714937286202965, 'eval_f1': 0.46856528747984955, 'eval_accuracy': 0.9455338531614298, 'eval_runtime': 2.3829, 'eval_samples_per_second': 642.492, 'eval_steps_per_second': 80.574, 'epoch': 4.0}
{'loss': 0.098, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': 0.17357729375362396, 'eval_precision': 0.4423076923076923, 'eval_recall': 0.4982896237172178, 'eval_f1': 0.4686327077747989, 'eval_accuracy': 0.9436037983478731, 'eval_runtime': 2.3843, 'eval_samples_per_second': 642.129, 'eval_steps_per_second': 80.528, 'epoch': 5.0}
{'loss': 0.0804, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': 0.18111777305603027, 'eval_precision': 0.4783118405627198, 'eval_recall': 0.4652223489167617, 'eval_f1': 0.4716763005780346, 'eval_accuracy': 0.9468076893383772, 'eval_runtime': 2.3848, 'eval_samples_per_second': 641.994, 'eval_steps_per_second': 80.511, 'epoch': 6.0}
{'loss': 0.0686, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': 0.193013533949852, 'eval_precision': 0.46511627906976744, 'eval_recall': 0.5245153933865451, 'eval_f1': 0.4930332261521972, 'eval_accuracy': 0.9470006948197329, 'eval_runtime': 2.3831, 'eval_samples_per_second': 642.45, 'eval_steps_per_second': 80.568, 'epoch': 7.0}
{'loss': 0.0596, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': 0.20017755031585693, 'eval_precision': 0.4858342077649528, 'eval_recall': 0.5279361459521095, 'eval_f1': 0.5060109289617486, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 2.382, 'eval_samples_per_second': 642.725, 'eval_steps_per_second': 80.603, 'epoch': 8.0}
{'loss': 0.0516, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': 0.20797017216682434, 'eval_precision': 0.4766050054406964, 'eval_recall': 0.49942987457240595, 'eval_f1': 0.48775055679287305, 'eval_accuracy': 0.946730487145835, 'eval_runtime': 2.3868, 'eval_samples_per_second': 641.454, 'eval_steps_per_second': 80.444, 'epoch': 9.0}
{'loss': 0.045, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': 0.2166699469089508, 'eval_precision': 0.48586956521739133, 'eval_recall': 0.5096921322690992, 'eval_f1': 0.49749582637729545, 'eval_accuracy': 0.948197328804138, 'eval_runtime': 2.3767, 'eval_samples_per_second': 644.166, 'eval_steps_per_second': 80.784, 'epoch': 10.0}
{'loss': 0.0405, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': 0.22474779188632965, 'eval_precision': 0.45622568093385213, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.4923884514435696, 'eval_accuracy': 0.9454180498726164, 'eval_runtime': 2.3738, 'eval_samples_per_second': 644.961, 'eval_steps_per_second': 80.883, 'epoch': 11.0}
{'loss': 0.036, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': 0.23287120461463928, 'eval_precision': 0.4780388151174668, 'eval_recall': 0.5336374002280502, 'eval_f1': 0.5043103448275862, 'eval_accuracy': 0.947618312360071, 'eval_runtime': 2.3755, 'eval_samples_per_second': 644.49, 'eval_steps_per_second': 80.824, 'epoch': 12.0}
{'loss': 0.0324, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': 0.23942556977272034, 'eval_precision': 0.482646420824295, 'eval_recall': 0.507411630558723, 'eval_f1': 0.4947192884936076, 'eval_accuracy': 0.9472323013973597, 'eval_runtime': 2.379, 'eval_samples_per_second': 643.548, 'eval_steps_per_second': 80.706, 'epoch': 13.0}
{'loss': 0.0304, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': 0.2421601265668869, 'eval_precision': 0.4792099792099792, 'eval_recall': 0.5256556442417332, 'eval_f1': 0.5013594344752582, 'eval_accuracy': 0.9476955145526132, 'eval_runtime': 2.3761, 'eval_samples_per_second': 644.333, 'eval_steps_per_second': 80.805, 'epoch': 14.0}
{'loss': 0.0276, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': 0.2499151974916458, 'eval_precision': 0.4604878048780488, 'eval_recall': 0.5381984036488028, 'eval_f1': 0.4963196635120926, 'eval_accuracy': 0.9454566509688875, 'eval_runtime': 2.3776, 'eval_samples_per_second': 643.923, 'eval_steps_per_second': 80.753, 'epoch': 15.0}
{'loss': 0.0259, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': 0.2553388476371765, 'eval_precision': 0.4691848906560636, 'eval_recall': 0.5381984036488028, 'eval_f1': 0.501327668613914, 'eval_accuracy': 0.9463444761831236, 'eval_runtime': 2.3824, 'eval_samples_per_second': 642.636, 'eval_steps_per_second': 80.592, 'epoch': 16.0}
{'loss': 0.0249, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': 0.2551979124546051, 'eval_precision': 0.4873417721518987, 'eval_recall': 0.5267958950969214, 'eval_f1': 0.5063013698630138, 'eval_accuracy': 0.9474639079749865, 'eval_runtime': 2.3838, 'eval_samples_per_second': 642.256, 'eval_steps_per_second': 80.544, 'epoch': 17.0}
{'loss': 0.0235, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': 0.25813600420951843, 'eval_precision': 0.47373737373737373, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.5024102838778789, 'eval_accuracy': 0.947039295916004, 'eval_runtime': 2.3876, 'eval_samples_per_second': 641.224, 'eval_steps_per_second': 80.415, 'epoch': 18.0}
{'loss': 0.0223, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': 0.26015570759773254, 'eval_precision': 0.47459349593495936, 'eval_recall': 0.5324971493728621, 'eval_f1': 0.5018807092960774, 'eval_accuracy': 0.9468462904346483, 'eval_runtime': 2.3978, 'eval_samples_per_second': 638.495, 'eval_steps_per_second': 80.072, 'epoch': 19.0}
{'loss': 0.0221, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.2603799104690552, 'eval_precision': 0.4838709677419355, 'eval_recall': 0.5302166476624858, 'eval_f1': 0.5059847660500545, 'eval_accuracy': 0.9471550992048174, 'eval_runtime': 2.3847, 'eval_samples_per_second': 642.018, 'eval_steps_per_second': 80.514, 'epoch': 20.0}
{'train_runtime': 700.6763, 'train_samples_per_second': 246.448, 'train_steps_per_second': 3.853, 'train_loss': 0.07128089216020372, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.0713
  train_runtime            = 0:11:40.67
  train_samples            =       8634
  train_samples_per_second =    246.448
  train_steps_per_second   =      3.853
[{'loss': 0.2923, 'learning_rate': 9.5e-06, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.19126799702644348, 'eval_precision': 0.3562152133580705, 'eval_recall': 0.21892816419612315, 'eval_f1': 0.2711864406779661, 'eval_accuracy': 0.9411719292827916, 'eval_runtime': 2.422, 'eval_samples_per_second': 632.127, 'eval_steps_per_second': 79.274, 'epoch': 1.0, 'step': 135}, {'loss': 0.1803, 'learning_rate': 9e-06, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.16828987002372742, 'eval_precision': 0.4261437908496732, 'eval_recall': 0.3717217787913341, 'eval_f1': 0.3970767356881852, 'eval_accuracy': 0.9454180498726164, 'eval_runtime': 2.3915, 'eval_samples_per_second': 640.176, 'eval_steps_per_second': 80.283, 'epoch': 2.0, 'step': 270}, {'loss': 0.1451, 'learning_rate': 8.5e-06, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.1582133024930954, 'eval_precision': 0.4686746987951807, 'eval_recall': 0.443557582668187, 'eval_f1': 0.45577035735207966, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 2.3862, 'eval_samples_per_second': 641.593, 'eval_steps_per_second': 80.461, 'epoch': 3.0, 'step': 405}, {'loss': 0.1191, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.16601243615150452, 'eval_precision': 0.44308943089430897, 'eval_recall': 0.49714937286202965, 'eval_f1': 0.46856528747984955, 'eval_accuracy': 0.9455338531614298, 'eval_runtime': 2.3829, 'eval_samples_per_second': 642.492, 'eval_steps_per_second': 80.574, 'epoch': 4.0, 'step': 540}, {'loss': 0.098, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.17357729375362396, 'eval_precision': 0.4423076923076923, 'eval_recall': 0.4982896237172178, 'eval_f1': 0.4686327077747989, 'eval_accuracy': 0.9436037983478731, 'eval_runtime': 2.3843, 'eval_samples_per_second': 642.129, 'eval_steps_per_second': 80.528, 'epoch': 5.0, 'step': 675}, {'loss': 0.0804, 'learning_rate': 7e-06, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.18111777305603027, 'eval_precision': 0.4783118405627198, 'eval_recall': 0.4652223489167617, 'eval_f1': 0.4716763005780346, 'eval_accuracy': 0.9468076893383772, 'eval_runtime': 2.3848, 'eval_samples_per_second': 641.994, 'eval_steps_per_second': 80.511, 'epoch': 6.0, 'step': 810}, {'loss': 0.0686, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.193013533949852, 'eval_precision': 0.46511627906976744, 'eval_recall': 0.5245153933865451, 'eval_f1': 0.4930332261521972, 'eval_accuracy': 0.9470006948197329, 'eval_runtime': 2.3831, 'eval_samples_per_second': 642.45, 'eval_steps_per_second': 80.568, 'epoch': 7.0, 'step': 945}, {'loss': 0.0596, 'learning_rate': 6e-06, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.20017755031585693, 'eval_precision': 0.4858342077649528, 'eval_recall': 0.5279361459521095, 'eval_f1': 0.5060109289617486, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 2.382, 'eval_samples_per_second': 642.725, 'eval_steps_per_second': 80.603, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0516, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.20797017216682434, 'eval_precision': 0.4766050054406964, 'eval_recall': 0.49942987457240595, 'eval_f1': 0.48775055679287305, 'eval_accuracy': 0.946730487145835, 'eval_runtime': 2.3868, 'eval_samples_per_second': 641.454, 'eval_steps_per_second': 80.444, 'epoch': 9.0, 'step': 1215}, {'loss': 0.045, 'learning_rate': 5e-06, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.2166699469089508, 'eval_precision': 0.48586956521739133, 'eval_recall': 0.5096921322690992, 'eval_f1': 0.49749582637729545, 'eval_accuracy': 0.948197328804138, 'eval_runtime': 2.3767, 'eval_samples_per_second': 644.166, 'eval_steps_per_second': 80.784, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0405, 'learning_rate': 4.5e-06, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.22474779188632965, 'eval_precision': 0.45622568093385213, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.4923884514435696, 'eval_accuracy': 0.9454180498726164, 'eval_runtime': 2.3738, 'eval_samples_per_second': 644.961, 'eval_steps_per_second': 80.883, 'epoch': 11.0, 'step': 1485}, {'loss': 0.036, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.23287120461463928, 'eval_precision': 0.4780388151174668, 'eval_recall': 0.5336374002280502, 'eval_f1': 0.5043103448275862, 'eval_accuracy': 0.947618312360071, 'eval_runtime': 2.3755, 'eval_samples_per_second': 644.49, 'eval_steps_per_second': 80.824, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0324, 'learning_rate': 3.5e-06, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.23942556977272034, 'eval_precision': 0.482646420824295, 'eval_recall': 0.507411630558723, 'eval_f1': 0.4947192884936076, 'eval_accuracy': 0.9472323013973597, 'eval_runtime': 2.379, 'eval_samples_per_second': 643.548, 'eval_steps_per_second': 80.706, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0304, 'learning_rate': 3e-06, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.2421601265668869, 'eval_precision': 0.4792099792099792, 'eval_recall': 0.5256556442417332, 'eval_f1': 0.5013594344752582, 'eval_accuracy': 0.9476955145526132, 'eval_runtime': 2.3761, 'eval_samples_per_second': 644.333, 'eval_steps_per_second': 80.805, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0276, 'learning_rate': 2.5e-06, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.2499151974916458, 'eval_precision': 0.4604878048780488, 'eval_recall': 0.5381984036488028, 'eval_f1': 0.4963196635120926, 'eval_accuracy': 0.9454566509688875, 'eval_runtime': 2.3776, 'eval_samples_per_second': 643.923, 'eval_steps_per_second': 80.753, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0259, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.2553388476371765, 'eval_precision': 0.4691848906560636, 'eval_recall': 0.5381984036488028, 'eval_f1': 0.501327668613914, 'eval_accuracy': 0.9463444761831236, 'eval_runtime': 2.3824, 'eval_samples_per_second': 642.636, 'eval_steps_per_second': 80.592, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0249, 'learning_rate': 1.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.2551979124546051, 'eval_precision': 0.4873417721518987, 'eval_recall': 0.5267958950969214, 'eval_f1': 0.5063013698630138, 'eval_accuracy': 0.9474639079749865, 'eval_runtime': 2.3838, 'eval_samples_per_second': 642.256, 'eval_steps_per_second': 80.544, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0235, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.25813600420951843, 'eval_precision': 0.47373737373737373, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.5024102838778789, 'eval_accuracy': 0.947039295916004, 'eval_runtime': 2.3876, 'eval_samples_per_second': 641.224, 'eval_steps_per_second': 80.415, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0223, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.26015570759773254, 'eval_precision': 0.47459349593495936, 'eval_recall': 0.5324971493728621, 'eval_f1': 0.5018807092960774, 'eval_accuracy': 0.9468462904346483, 'eval_runtime': 2.3978, 'eval_samples_per_second': 638.495, 'eval_steps_per_second': 80.072, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0221, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.2603799104690552, 'eval_precision': 0.4838709677419355, 'eval_recall': 0.5302166476624858, 'eval_f1': 0.5059847660500545, 'eval_accuracy': 0.9471550992048174, 'eval_runtime': 2.3847, 'eval_samples_per_second': 642.018, 'eval_steps_per_second': 80.514, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 700.6763, 'train_samples_per_second': 246.448, 'train_steps_per_second': 3.853, 'total_flos': 7445008896319020.0, 'train_loss': 0.07128089216020372, 'epoch': 20.0, 'step': 2700}]

Evaluation, NbAiLab/nb-bert-base
***** predict metrics *****
  predict_accuracy           =     0.9496
  predict_f1                 =     0.4406
  predict_loss               =     0.1543
  predict_precision          =     0.4713
  predict_recall             =     0.4136
  predict_runtime            = 0:00:01.98
  predict_samples_per_second =    639.241
  predict_steps_per_second   =     79.905
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_11.json completed. F1: 0.4405797101449276
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_01.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_01.json
01150927_tsa-bin_NorBERT_3_small Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6065.94 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6778.27 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6737.19 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6768.06 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6889.39 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7043.03 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 7196.99 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 7290.22 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6675.88 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7424.45 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7027.41 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7089.90 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6884.89 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_small Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.6566, 'learning_rate': 4.75e-05, 'epoch': 1.0}
{'eval_loss': 0.26881811022758484, 'eval_precision': 0.2524850894632207, 'eval_recall': 0.14481185860889395, 'eval_f1': 0.18405797101449275, 'eval_accuracy': 0.9343781363390721, 'eval_runtime': 3.0004, 'eval_samples_per_second': 510.258, 'eval_steps_per_second': 63.991, 'epoch': 1.0}
{'loss': 0.2316, 'learning_rate': 4.5e-05, 'epoch': 2.0}
{'eval_loss': 0.20267100632190704, 'eval_precision': 0.17971014492753623, 'eval_recall': 0.14139110604332952, 'eval_f1': 0.15826419910657308, 'eval_accuracy': 0.9376592295221184, 'eval_runtime': 2.9799, 'eval_samples_per_second': 513.777, 'eval_steps_per_second': 64.432, 'epoch': 2.0}
{'loss': 0.1899, 'learning_rate': 4.25e-05, 'epoch': 3.0}
{'eval_loss': 0.1941685825586319, 'eval_precision': 0.5020161290322581, 'eval_recall': 0.2839224629418472, 'eval_f1': 0.3627093954843409, 'eval_accuracy': 0.9495097660773566, 'eval_runtime': 2.9706, 'eval_samples_per_second': 515.39, 'eval_steps_per_second': 64.634, 'epoch': 3.0}
{'loss': 0.1401, 'learning_rate': 4e-05, 'epoch': 4.0}
{'eval_loss': 0.19103623926639557, 'eval_precision': 0.43902439024390244, 'eval_recall': 0.3899657924743444, 'eval_f1': 0.41304347826086957, 'eval_accuracy': 0.9441828147919401, 'eval_runtime': 2.9799, 'eval_samples_per_second': 513.778, 'eval_steps_per_second': 64.432, 'epoch': 4.0}
{'loss': 0.1041, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0}
{'eval_loss': 0.20059506595134735, 'eval_precision': 0.4108053007135576, 'eval_recall': 0.45952109464082097, 'eval_f1': 0.43379978471474706, 'eval_accuracy': 0.9406315139349958, 'eval_runtime': 2.9678, 'eval_samples_per_second': 515.874, 'eval_steps_per_second': 64.695, 'epoch': 5.0}
{'loss': 0.0878, 'learning_rate': 3.5e-05, 'epoch': 6.0}
{'eval_loss': 0.20648419857025146, 'eval_precision': 0.4165680473372781, 'eval_recall': 0.4013683010262258, 'eval_f1': 0.4088269454123113, 'eval_accuracy': 0.9437582027329576, 'eval_runtime': 2.9753, 'eval_samples_per_second': 514.564, 'eval_steps_per_second': 64.531, 'epoch': 6.0}
{'loss': 0.0737, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0}
{'eval_loss': 0.23373204469680786, 'eval_precision': 0.3848888888888889, 'eval_recall': 0.49372862029646525, 'eval_f1': 0.43256743256743263, 'eval_accuracy': 0.9402841040685556, 'eval_runtime': 2.9675, 'eval_samples_per_second': 515.915, 'eval_steps_per_second': 64.7, 'epoch': 7.0}
{'loss': 0.0591, 'learning_rate': 3e-05, 'epoch': 8.0}
{'eval_loss': 0.2301080822944641, 'eval_precision': 0.4261682242990654, 'eval_recall': 0.5199543899657925, 'eval_f1': 0.4684129429892142, 'eval_accuracy': 0.9427931753261792, 'eval_runtime': 2.9753, 'eval_samples_per_second': 514.575, 'eval_steps_per_second': 64.532, 'epoch': 8.0}
{'loss': 0.0471, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0}
{'eval_loss': 0.22963295876979828, 'eval_precision': 0.481859410430839, 'eval_recall': 0.4846066134549601, 'eval_f1': 0.4832291074474133, 'eval_accuracy': 0.9484289353817649, 'eval_runtime': 2.9755, 'eval_samples_per_second': 514.54, 'eval_steps_per_second': 64.528, 'epoch': 9.0}
{'loss': 0.0369, 'learning_rate': 2.5e-05, 'epoch': 10.0}
{'eval_loss': 0.2365628331899643, 'eval_precision': 0.4501510574018127, 'eval_recall': 0.5096921322690992, 'eval_f1': 0.4780748663101604, 'eval_accuracy': 0.9463058750868525, 'eval_runtime': 3.0402, 'eval_samples_per_second': 503.591, 'eval_steps_per_second': 63.154, 'epoch': 10.0}
{'loss': 0.0282, 'learning_rate': 2.25e-05, 'epoch': 11.0}
{'eval_loss': 0.2566903233528137, 'eval_precision': 0.46346555323590816, 'eval_recall': 0.5062713797035348, 'eval_f1': 0.48392370572207083, 'eval_accuracy': 0.945611055353972, 'eval_runtime': 2.9755, 'eval_samples_per_second': 514.529, 'eval_steps_per_second': 64.526, 'epoch': 11.0}
{'loss': 0.0235, 'learning_rate': 2e-05, 'epoch': 12.0}
{'eval_loss': 0.2569412887096405, 'eval_precision': 0.4671201814058957, 'eval_recall': 0.4697833523375142, 'eval_f1': 0.4684479818078453, 'eval_accuracy': 0.9465374816644793, 'eval_runtime': 2.9679, 'eval_samples_per_second': 515.858, 'eval_steps_per_second': 64.693, 'epoch': 12.0}
{'loss': 0.0197, 'learning_rate': 1.75e-05, 'epoch': 13.0}
{'eval_loss': 0.2592025399208069, 'eval_precision': 0.4579533941236069, 'eval_recall': 0.5153933865450399, 'eval_f1': 0.48497854077253216, 'eval_accuracy': 0.9459198641241411, 'eval_runtime': 2.9585, 'eval_samples_per_second': 517.498, 'eval_steps_per_second': 64.898, 'epoch': 13.0}
{'loss': 0.0163, 'learning_rate': 1.5e-05, 'epoch': 14.0}
{'eval_loss': 0.26188281178474426, 'eval_precision': 0.43968095712861416, 'eval_recall': 0.5028506271379704, 'eval_f1': 0.46914893617021275, 'eval_accuracy': 0.9443758202732958, 'eval_runtime': 2.9664, 'eval_samples_per_second': 516.117, 'eval_steps_per_second': 64.725, 'epoch': 14.0}
{'loss': 0.0138, 'learning_rate': 1.25e-05, 'epoch': 15.0}
{'eval_loss': 0.2702302932739258, 'eval_precision': 0.4537725823591923, 'eval_recall': 0.4868871151653364, 'eval_f1': 0.4697469746974698, 'eval_accuracy': 0.9456882575465143, 'eval_runtime': 2.9745, 'eval_samples_per_second': 514.714, 'eval_steps_per_second': 64.549, 'epoch': 15.0}
{'loss': 0.0127, 'learning_rate': 1e-05, 'epoch': 16.0}
{'eval_loss': 0.273278146982193, 'eval_precision': 0.4772209567198178, 'eval_recall': 0.47776510832383123, 'eval_f1': 0.4774928774928775, 'eval_accuracy': 0.9474253068787154, 'eval_runtime': 2.9742, 'eval_samples_per_second': 514.768, 'eval_steps_per_second': 64.556, 'epoch': 16.0}
{'loss': 0.0111, 'learning_rate': 7.5e-06, 'epoch': 17.0}
{'eval_loss': 0.2753908932209015, 'eval_precision': 0.4633077765607886, 'eval_recall': 0.4823261117445838, 'eval_f1': 0.47262569832402235, 'eval_accuracy': 0.9464988805682082, 'eval_runtime': 2.9594, 'eval_samples_per_second': 517.333, 'eval_steps_per_second': 64.878, 'epoch': 17.0}
{'loss': 0.0105, 'learning_rate': 5e-06, 'epoch': 18.0}
{'eval_loss': 0.2792641818523407, 'eval_precision': 0.4491869918699187, 'eval_recall': 0.5039908779931584, 'eval_f1': 0.4750134336378291, 'eval_accuracy': 0.945611055353972, 'eval_runtime': 2.9819, 'eval_samples_per_second': 513.427, 'eval_steps_per_second': 64.388, 'epoch': 18.0}
{'loss': 0.0094, 'learning_rate': 2.5e-06, 'epoch': 19.0}
{'eval_loss': 0.2764546275138855, 'eval_precision': 0.45708376421923474, 'eval_recall': 0.5039908779931584, 'eval_f1': 0.47939262472885025, 'eval_accuracy': 0.9464216783756658, 'eval_runtime': 2.968, 'eval_samples_per_second': 515.836, 'eval_steps_per_second': 64.69, 'epoch': 19.0}
{'loss': 0.0088, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.2767915725708008, 'eval_precision': 0.45134575569358176, 'eval_recall': 0.49714937286202965, 'eval_f1': 0.47314161692892026, 'eval_accuracy': 0.9464216783756658, 'eval_runtime': 2.9665, 'eval_samples_per_second': 516.096, 'eval_steps_per_second': 64.723, 'epoch': 20.0}
{'train_runtime': 342.1029, 'train_samples_per_second': 504.76, 'train_steps_per_second': 7.892, 'train_loss': 0.08904421784259654, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =      0.089
  train_runtime            = 0:05:42.10
  train_samples            =       8634
  train_samples_per_second =     504.76
  train_steps_per_second   =      7.892
[{'loss': 0.6566, 'learning_rate': 4.75e-05, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.26881811022758484, 'eval_precision': 0.2524850894632207, 'eval_recall': 0.14481185860889395, 'eval_f1': 0.18405797101449275, 'eval_accuracy': 0.9343781363390721, 'eval_runtime': 3.0004, 'eval_samples_per_second': 510.258, 'eval_steps_per_second': 63.991, 'epoch': 1.0, 'step': 135}, {'loss': 0.2316, 'learning_rate': 4.5e-05, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.20267100632190704, 'eval_precision': 0.17971014492753623, 'eval_recall': 0.14139110604332952, 'eval_f1': 0.15826419910657308, 'eval_accuracy': 0.9376592295221184, 'eval_runtime': 2.9799, 'eval_samples_per_second': 513.777, 'eval_steps_per_second': 64.432, 'epoch': 2.0, 'step': 270}, {'loss': 0.1899, 'learning_rate': 4.25e-05, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.1941685825586319, 'eval_precision': 0.5020161290322581, 'eval_recall': 0.2839224629418472, 'eval_f1': 0.3627093954843409, 'eval_accuracy': 0.9495097660773566, 'eval_runtime': 2.9706, 'eval_samples_per_second': 515.39, 'eval_steps_per_second': 64.634, 'epoch': 3.0, 'step': 405}, {'loss': 0.1401, 'learning_rate': 4e-05, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.19103623926639557, 'eval_precision': 0.43902439024390244, 'eval_recall': 0.3899657924743444, 'eval_f1': 0.41304347826086957, 'eval_accuracy': 0.9441828147919401, 'eval_runtime': 2.9799, 'eval_samples_per_second': 513.778, 'eval_steps_per_second': 64.432, 'epoch': 4.0, 'step': 540}, {'loss': 0.1041, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.20059506595134735, 'eval_precision': 0.4108053007135576, 'eval_recall': 0.45952109464082097, 'eval_f1': 0.43379978471474706, 'eval_accuracy': 0.9406315139349958, 'eval_runtime': 2.9678, 'eval_samples_per_second': 515.874, 'eval_steps_per_second': 64.695, 'epoch': 5.0, 'step': 675}, {'loss': 0.0878, 'learning_rate': 3.5e-05, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.20648419857025146, 'eval_precision': 0.4165680473372781, 'eval_recall': 0.4013683010262258, 'eval_f1': 0.4088269454123113, 'eval_accuracy': 0.9437582027329576, 'eval_runtime': 2.9753, 'eval_samples_per_second': 514.564, 'eval_steps_per_second': 64.531, 'epoch': 6.0, 'step': 810}, {'loss': 0.0737, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.23373204469680786, 'eval_precision': 0.3848888888888889, 'eval_recall': 0.49372862029646525, 'eval_f1': 0.43256743256743263, 'eval_accuracy': 0.9402841040685556, 'eval_runtime': 2.9675, 'eval_samples_per_second': 515.915, 'eval_steps_per_second': 64.7, 'epoch': 7.0, 'step': 945}, {'loss': 0.0591, 'learning_rate': 3e-05, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.2301080822944641, 'eval_precision': 0.4261682242990654, 'eval_recall': 0.5199543899657925, 'eval_f1': 0.4684129429892142, 'eval_accuracy': 0.9427931753261792, 'eval_runtime': 2.9753, 'eval_samples_per_second': 514.575, 'eval_steps_per_second': 64.532, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0471, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.22963295876979828, 'eval_precision': 0.481859410430839, 'eval_recall': 0.4846066134549601, 'eval_f1': 0.4832291074474133, 'eval_accuracy': 0.9484289353817649, 'eval_runtime': 2.9755, 'eval_samples_per_second': 514.54, 'eval_steps_per_second': 64.528, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0369, 'learning_rate': 2.5e-05, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.2365628331899643, 'eval_precision': 0.4501510574018127, 'eval_recall': 0.5096921322690992, 'eval_f1': 0.4780748663101604, 'eval_accuracy': 0.9463058750868525, 'eval_runtime': 3.0402, 'eval_samples_per_second': 503.591, 'eval_steps_per_second': 63.154, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0282, 'learning_rate': 2.25e-05, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.2566903233528137, 'eval_precision': 0.46346555323590816, 'eval_recall': 0.5062713797035348, 'eval_f1': 0.48392370572207083, 'eval_accuracy': 0.945611055353972, 'eval_runtime': 2.9755, 'eval_samples_per_second': 514.529, 'eval_steps_per_second': 64.526, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0235, 'learning_rate': 2e-05, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.2569412887096405, 'eval_precision': 0.4671201814058957, 'eval_recall': 0.4697833523375142, 'eval_f1': 0.4684479818078453, 'eval_accuracy': 0.9465374816644793, 'eval_runtime': 2.9679, 'eval_samples_per_second': 515.858, 'eval_steps_per_second': 64.693, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0197, 'learning_rate': 1.75e-05, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.2592025399208069, 'eval_precision': 0.4579533941236069, 'eval_recall': 0.5153933865450399, 'eval_f1': 0.48497854077253216, 'eval_accuracy': 0.9459198641241411, 'eval_runtime': 2.9585, 'eval_samples_per_second': 517.498, 'eval_steps_per_second': 64.898, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0163, 'learning_rate': 1.5e-05, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.26188281178474426, 'eval_precision': 0.43968095712861416, 'eval_recall': 0.5028506271379704, 'eval_f1': 0.46914893617021275, 'eval_accuracy': 0.9443758202732958, 'eval_runtime': 2.9664, 'eval_samples_per_second': 516.117, 'eval_steps_per_second': 64.725, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0138, 'learning_rate': 1.25e-05, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.2702302932739258, 'eval_precision': 0.4537725823591923, 'eval_recall': 0.4868871151653364, 'eval_f1': 0.4697469746974698, 'eval_accuracy': 0.9456882575465143, 'eval_runtime': 2.9745, 'eval_samples_per_second': 514.714, 'eval_steps_per_second': 64.549, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0127, 'learning_rate': 1e-05, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.273278146982193, 'eval_precision': 0.4772209567198178, 'eval_recall': 0.47776510832383123, 'eval_f1': 0.4774928774928775, 'eval_accuracy': 0.9474253068787154, 'eval_runtime': 2.9742, 'eval_samples_per_second': 514.768, 'eval_steps_per_second': 64.556, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0111, 'learning_rate': 7.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.2753908932209015, 'eval_precision': 0.4633077765607886, 'eval_recall': 0.4823261117445838, 'eval_f1': 0.47262569832402235, 'eval_accuracy': 0.9464988805682082, 'eval_runtime': 2.9594, 'eval_samples_per_second': 517.333, 'eval_steps_per_second': 64.878, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0105, 'learning_rate': 5e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.2792641818523407, 'eval_precision': 0.4491869918699187, 'eval_recall': 0.5039908779931584, 'eval_f1': 0.4750134336378291, 'eval_accuracy': 0.945611055353972, 'eval_runtime': 2.9819, 'eval_samples_per_second': 513.427, 'eval_steps_per_second': 64.388, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0094, 'learning_rate': 2.5e-06, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.2764546275138855, 'eval_precision': 0.45708376421923474, 'eval_recall': 0.5039908779931584, 'eval_f1': 0.47939262472885025, 'eval_accuracy': 0.9464216783756658, 'eval_runtime': 2.968, 'eval_samples_per_second': 515.836, 'eval_steps_per_second': 64.69, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0088, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.2767915725708008, 'eval_precision': 0.45134575569358176, 'eval_recall': 0.49714937286202965, 'eval_f1': 0.47314161692892026, 'eval_accuracy': 0.9464216783756658, 'eval_runtime': 2.9665, 'eval_samples_per_second': 516.096, 'eval_steps_per_second': 64.723, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 342.1029, 'train_samples_per_second': 504.76, 'train_steps_per_second': 7.892, 'total_flos': 1592857376191872.0, 'train_loss': 0.08904421784259654, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-small
***** predict metrics *****
  predict_accuracy           =     0.9451
  predict_f1                 =     0.3865
  predict_loss               =     0.1973
  predict_precision          =     0.4201
  predict_recall             =     0.3578
  predict_runtime            = 0:00:02.45
  predict_samples_per_second =    517.562
  predict_steps_per_second   =     64.695
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_01.json completed. F1: 0.3864805290227774
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_04.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Some weights of BertForTokenClassification were not initialized from the model checkpoint at NbAiLab/nb-bert-base and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_04.json
01150927_tsa-bin_NB-BERT_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5971.85 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6765.87 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6725.93 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6813.73 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6901.02 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7019.74 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 6225.84 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6543.76 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6649.95 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7312.03 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6937.77 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 6999.49 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6810.73 examples/s]
You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
01150927_tsa-bin_NB-BERT_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.2257, 'learning_rate': 4.75e-05, 'epoch': 1.0}
{'eval_loss': 0.15540875494480133, 'eval_precision': 0.4718004338394794, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.48360200111172874, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 2.39, 'eval_samples_per_second': 640.599, 'eval_steps_per_second': 80.336, 'epoch': 1.0}
{'loss': 0.134, 'learning_rate': 4.5e-05, 'epoch': 2.0}
{'eval_loss': 0.15156914293766022, 'eval_precision': 0.43980582524271844, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.47509176717357104, 'eval_accuracy': 0.9466532849532927, 'eval_runtime': 2.3765, 'eval_samples_per_second': 644.238, 'eval_steps_per_second': 80.793, 'epoch': 2.0}
{'loss': 0.0782, 'learning_rate': 4.25e-05, 'epoch': 3.0}
{'eval_loss': 0.1733073890209198, 'eval_precision': 0.5432569974554707, 'eval_recall': 0.4868871151653364, 'eval_f1': 0.5135297654840649, 'eval_accuracy': 0.951941635142438, 'eval_runtime': 2.3666, 'eval_samples_per_second': 646.933, 'eval_steps_per_second': 81.131, 'epoch': 3.0}
{'loss': 0.0479, 'learning_rate': 4e-05, 'epoch': 4.0}
{'eval_loss': 0.19317366182804108, 'eval_precision': 0.49211711711711714, 'eval_recall': 0.4982896237172178, 'eval_f1': 0.4951841359773371, 'eval_accuracy': 0.9491623562109164, 'eval_runtime': 2.3723, 'eval_samples_per_second': 645.366, 'eval_steps_per_second': 80.934, 'epoch': 4.0}
{'loss': 0.0278, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0}
{'eval_loss': 0.22131089866161346, 'eval_precision': 0.47304170905391657, 'eval_recall': 0.5302166476624858, 'eval_f1': 0.5, 'eval_accuracy': 0.9481587277078669, 'eval_runtime': 2.3674, 'eval_samples_per_second': 646.702, 'eval_steps_per_second': 81.102, 'epoch': 5.0}
{'loss': 0.0168, 'learning_rate': 3.5e-05, 'epoch': 6.0}
{'eval_loss': 0.24740761518478394, 'eval_precision': 0.4614643545279383, 'eval_recall': 0.5461801596351197, 'eval_f1': 0.5002610966057441, 'eval_accuracy': 0.9457654597390566, 'eval_runtime': 2.3636, 'eval_samples_per_second': 647.741, 'eval_steps_per_second': 81.232, 'epoch': 6.0}
{'loss': 0.0109, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0}
{'eval_loss': 0.2762564718723297, 'eval_precision': 0.4531974050046339, 'eval_recall': 0.5575826681870011, 'eval_f1': 0.5, 'eval_accuracy': 0.9463444761831236, 'eval_runtime': 2.374, 'eval_samples_per_second': 644.915, 'eval_steps_per_second': 80.878, 'epoch': 7.0}
{'loss': 0.0071, 'learning_rate': 3e-05, 'epoch': 8.0}
{'eval_loss': 0.2978799343109131, 'eval_precision': 0.49130434782608695, 'eval_recall': 0.5153933865450399, 'eval_f1': 0.5030606566499721, 'eval_accuracy': 0.9486219408631205, 'eval_runtime': 2.8232, 'eval_samples_per_second': 542.295, 'eval_steps_per_second': 68.008, 'epoch': 8.0}
{'loss': 0.0055, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0}
{'eval_loss': 0.31073200702667236, 'eval_precision': 0.5046403712296984, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.5002875215641173, 'eval_accuracy': 0.9500501814251525, 'eval_runtime': 2.3641, 'eval_samples_per_second': 647.613, 'eval_steps_per_second': 81.216, 'epoch': 9.0}
{'loss': 0.0042, 'learning_rate': 2.5e-05, 'epoch': 10.0}
{'eval_loss': 0.3137021064758301, 'eval_precision': 0.46558704453441296, 'eval_recall': 0.5245153933865451, 'eval_f1': 0.49329758713136734, 'eval_accuracy': 0.9471164981085463, 'eval_runtime': 2.3576, 'eval_samples_per_second': 649.384, 'eval_steps_per_second': 81.438, 'epoch': 10.0}
{'loss': 0.0036, 'learning_rate': 2.25e-05, 'epoch': 11.0}
{'eval_loss': 0.3183577358722687, 'eval_precision': 0.49375709421112374, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.49488054607508536, 'eval_accuracy': 0.9487763452482051, 'eval_runtime': 2.4811, 'eval_samples_per_second': 617.061, 'eval_steps_per_second': 77.385, 'epoch': 11.0}
{'loss': 0.0025, 'learning_rate': 2e-05, 'epoch': 12.0}
{'eval_loss': 0.3416106104850769, 'eval_precision': 0.5151515151515151, 'eval_recall': 0.4846066134549601, 'eval_f1': 0.4994124559341951, 'eval_accuracy': 0.9495097660773566, 'eval_runtime': 2.3616, 'eval_samples_per_second': 648.286, 'eval_steps_per_second': 81.3, 'epoch': 12.0}
{'loss': 0.002, 'learning_rate': 1.75e-05, 'epoch': 13.0}
{'eval_loss': 0.3540022373199463, 'eval_precision': 0.4716599190283401, 'eval_recall': 0.5313568985176739, 'eval_f1': 0.49973190348525465, 'eval_accuracy': 0.9461128696054968, 'eval_runtime': 2.36, 'eval_samples_per_second': 648.738, 'eval_steps_per_second': 81.357, 'epoch': 13.0}
{'loss': 0.0015, 'learning_rate': 1.5e-05, 'epoch': 14.0}
{'eval_loss': 0.36123353242874146, 'eval_precision': 0.490174672489083, 'eval_recall': 0.5119726339794755, 'eval_f1': 0.5008365867261573, 'eval_accuracy': 0.9484675364780359, 'eval_runtime': 2.4633, 'eval_samples_per_second': 621.528, 'eval_steps_per_second': 77.945, 'epoch': 14.0}
{'loss': 0.0011, 'learning_rate': 1.25e-05, 'epoch': 15.0}
{'eval_loss': 0.3581058979034424, 'eval_precision': 0.4929270946681175, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.5044543429844098, 'eval_accuracy': 0.9480815255153247, 'eval_runtime': 2.3615, 'eval_samples_per_second': 648.313, 'eval_steps_per_second': 81.304, 'epoch': 15.0}
{'loss': 0.0011, 'learning_rate': 1e-05, 'epoch': 16.0}
{'eval_loss': 0.3631477355957031, 'eval_precision': 0.5023148148148148, 'eval_recall': 0.49486887115165334, 'eval_f1': 0.4985640436530729, 'eval_accuracy': 0.9500501814251525, 'eval_runtime': 2.358, 'eval_samples_per_second': 649.287, 'eval_steps_per_second': 81.426, 'epoch': 16.0}
{'loss': 0.0011, 'learning_rate': 7.5e-06, 'epoch': 17.0}
{'eval_loss': 0.3635826110839844, 'eval_precision': 0.507411630558723, 'eval_recall': 0.507411630558723, 'eval_f1': 0.507411630558723, 'eval_accuracy': 0.9504361923878638, 'eval_runtime': 2.3621, 'eval_samples_per_second': 648.165, 'eval_steps_per_second': 81.285, 'epoch': 17.0}
{'loss': 0.0008, 'learning_rate': 5e-06, 'epoch': 18.0}
{'eval_loss': 0.3648892641067505, 'eval_precision': 0.5156794425087108, 'eval_recall': 0.5062713797035348, 'eval_f1': 0.5109321058688148, 'eval_accuracy': 0.9508608044468463, 'eval_runtime': 2.3586, 'eval_samples_per_second': 649.12, 'eval_steps_per_second': 81.405, 'epoch': 18.0}
{'loss': 0.0007, 'learning_rate': 2.5e-06, 'epoch': 19.0}
{'eval_loss': 0.36551550030708313, 'eval_precision': 0.49404117009750814, 'eval_recall': 0.5199543899657925, 'eval_f1': 0.5066666666666666, 'eval_accuracy': 0.9491237551146453, 'eval_runtime': 2.3597, 'eval_samples_per_second': 648.823, 'eval_steps_per_second': 81.368, 'epoch': 19.0}
{'loss': 0.0006, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.3668171167373657, 'eval_precision': 0.5005586592178771, 'eval_recall': 0.5108323831242874, 'eval_f1': 0.5056433408577877, 'eval_accuracy': 0.9498185748475256, 'eval_runtime': 2.3585, 'eval_samples_per_second': 649.14, 'eval_steps_per_second': 81.407, 'epoch': 20.0}
{'train_runtime': 701.4658, 'train_samples_per_second': 246.17, 'train_steps_per_second': 3.849, 'train_loss': 0.028660726781796524, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.0287
  train_runtime            = 0:11:41.46
  train_samples            =       8634
  train_samples_per_second =     246.17
  train_steps_per_second   =      3.849
[{'loss': 0.2257, 'learning_rate': 4.75e-05, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.15540875494480133, 'eval_precision': 0.4718004338394794, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.48360200111172874, 'eval_accuracy': 0.9478499189376979, 'eval_runtime': 2.39, 'eval_samples_per_second': 640.599, 'eval_steps_per_second': 80.336, 'epoch': 1.0, 'step': 135}, {'loss': 0.134, 'learning_rate': 4.5e-05, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.15156914293766022, 'eval_precision': 0.43980582524271844, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.47509176717357104, 'eval_accuracy': 0.9466532849532927, 'eval_runtime': 2.3765, 'eval_samples_per_second': 644.238, 'eval_steps_per_second': 80.793, 'epoch': 2.0, 'step': 270}, {'loss': 0.0782, 'learning_rate': 4.25e-05, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.1733073890209198, 'eval_precision': 0.5432569974554707, 'eval_recall': 0.4868871151653364, 'eval_f1': 0.5135297654840649, 'eval_accuracy': 0.951941635142438, 'eval_runtime': 2.3666, 'eval_samples_per_second': 646.933, 'eval_steps_per_second': 81.131, 'epoch': 3.0, 'step': 405}, {'loss': 0.0479, 'learning_rate': 4e-05, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.19317366182804108, 'eval_precision': 0.49211711711711714, 'eval_recall': 0.4982896237172178, 'eval_f1': 0.4951841359773371, 'eval_accuracy': 0.9491623562109164, 'eval_runtime': 2.3723, 'eval_samples_per_second': 645.366, 'eval_steps_per_second': 80.934, 'epoch': 4.0, 'step': 540}, {'loss': 0.0278, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.22131089866161346, 'eval_precision': 0.47304170905391657, 'eval_recall': 0.5302166476624858, 'eval_f1': 0.5, 'eval_accuracy': 0.9481587277078669, 'eval_runtime': 2.3674, 'eval_samples_per_second': 646.702, 'eval_steps_per_second': 81.102, 'epoch': 5.0, 'step': 675}, {'loss': 0.0168, 'learning_rate': 3.5e-05, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.24740761518478394, 'eval_precision': 0.4614643545279383, 'eval_recall': 0.5461801596351197, 'eval_f1': 0.5002610966057441, 'eval_accuracy': 0.9457654597390566, 'eval_runtime': 2.3636, 'eval_samples_per_second': 647.741, 'eval_steps_per_second': 81.232, 'epoch': 6.0, 'step': 810}, {'loss': 0.0109, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.2762564718723297, 'eval_precision': 0.4531974050046339, 'eval_recall': 0.5575826681870011, 'eval_f1': 0.5, 'eval_accuracy': 0.9463444761831236, 'eval_runtime': 2.374, 'eval_samples_per_second': 644.915, 'eval_steps_per_second': 80.878, 'epoch': 7.0, 'step': 945}, {'loss': 0.0071, 'learning_rate': 3e-05, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.2978799343109131, 'eval_precision': 0.49130434782608695, 'eval_recall': 0.5153933865450399, 'eval_f1': 0.5030606566499721, 'eval_accuracy': 0.9486219408631205, 'eval_runtime': 2.8232, 'eval_samples_per_second': 542.295, 'eval_steps_per_second': 68.008, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0055, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.31073200702667236, 'eval_precision': 0.5046403712296984, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.5002875215641173, 'eval_accuracy': 0.9500501814251525, 'eval_runtime': 2.3641, 'eval_samples_per_second': 647.613, 'eval_steps_per_second': 81.216, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0042, 'learning_rate': 2.5e-05, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.3137021064758301, 'eval_precision': 0.46558704453441296, 'eval_recall': 0.5245153933865451, 'eval_f1': 0.49329758713136734, 'eval_accuracy': 0.9471164981085463, 'eval_runtime': 2.3576, 'eval_samples_per_second': 649.384, 'eval_steps_per_second': 81.438, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0036, 'learning_rate': 2.25e-05, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.3183577358722687, 'eval_precision': 0.49375709421112374, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.49488054607508536, 'eval_accuracy': 0.9487763452482051, 'eval_runtime': 2.4811, 'eval_samples_per_second': 617.061, 'eval_steps_per_second': 77.385, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0025, 'learning_rate': 2e-05, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.3416106104850769, 'eval_precision': 0.5151515151515151, 'eval_recall': 0.4846066134549601, 'eval_f1': 0.4994124559341951, 'eval_accuracy': 0.9495097660773566, 'eval_runtime': 2.3616, 'eval_samples_per_second': 648.286, 'eval_steps_per_second': 81.3, 'epoch': 12.0, 'step': 1620}, {'loss': 0.002, 'learning_rate': 1.75e-05, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.3540022373199463, 'eval_precision': 0.4716599190283401, 'eval_recall': 0.5313568985176739, 'eval_f1': 0.49973190348525465, 'eval_accuracy': 0.9461128696054968, 'eval_runtime': 2.36, 'eval_samples_per_second': 648.738, 'eval_steps_per_second': 81.357, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0015, 'learning_rate': 1.5e-05, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.36123353242874146, 'eval_precision': 0.490174672489083, 'eval_recall': 0.5119726339794755, 'eval_f1': 0.5008365867261573, 'eval_accuracy': 0.9484675364780359, 'eval_runtime': 2.4633, 'eval_samples_per_second': 621.528, 'eval_steps_per_second': 77.945, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0011, 'learning_rate': 1.25e-05, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.3581058979034424, 'eval_precision': 0.4929270946681175, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.5044543429844098, 'eval_accuracy': 0.9480815255153247, 'eval_runtime': 2.3615, 'eval_samples_per_second': 648.313, 'eval_steps_per_second': 81.304, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0011, 'learning_rate': 1e-05, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.3631477355957031, 'eval_precision': 0.5023148148148148, 'eval_recall': 0.49486887115165334, 'eval_f1': 0.4985640436530729, 'eval_accuracy': 0.9500501814251525, 'eval_runtime': 2.358, 'eval_samples_per_second': 649.287, 'eval_steps_per_second': 81.426, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0011, 'learning_rate': 7.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.3635826110839844, 'eval_precision': 0.507411630558723, 'eval_recall': 0.507411630558723, 'eval_f1': 0.507411630558723, 'eval_accuracy': 0.9504361923878638, 'eval_runtime': 2.3621, 'eval_samples_per_second': 648.165, 'eval_steps_per_second': 81.285, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0008, 'learning_rate': 5e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.3648892641067505, 'eval_precision': 0.5156794425087108, 'eval_recall': 0.5062713797035348, 'eval_f1': 0.5109321058688148, 'eval_accuracy': 0.9508608044468463, 'eval_runtime': 2.3586, 'eval_samples_per_second': 649.12, 'eval_steps_per_second': 81.405, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0007, 'learning_rate': 2.5e-06, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.36551550030708313, 'eval_precision': 0.49404117009750814, 'eval_recall': 0.5199543899657925, 'eval_f1': 0.5066666666666666, 'eval_accuracy': 0.9491237551146453, 'eval_runtime': 2.3597, 'eval_samples_per_second': 648.823, 'eval_steps_per_second': 81.368, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0006, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.3668171167373657, 'eval_precision': 0.5005586592178771, 'eval_recall': 0.5108323831242874, 'eval_f1': 0.5056433408577877, 'eval_accuracy': 0.9498185748475256, 'eval_runtime': 2.3585, 'eval_samples_per_second': 649.14, 'eval_steps_per_second': 81.407, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 701.4658, 'train_samples_per_second': 246.17, 'train_steps_per_second': 3.849, 'total_flos': 7445008896319020.0, 'train_loss': 0.028660726781796524, 'epoch': 20.0, 'step': 2700}]

Evaluation, NbAiLab/nb-bert-base
***** predict metrics *****
  predict_accuracy           =     0.9483
  predict_f1                 =     0.4773
  predict_loss               =     0.1495
  predict_precision          =     0.4505
  predict_recall             =     0.5075
  predict_runtime            = 0:00:01.96
  predict_samples_per_second =    646.054
  predict_steps_per_second   =     80.757
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_04.json completed. F1: 0.47728726807421623
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_17.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_17.json
config.json:   0%|          | 0.00/615 [00:00<?, ?B/s]config.json: 100%|██████████| 615/615 [00:00<00:00, 4.72MB/s]
sentencepiece.bpe.model:   0%|          | 0.00/5.07M [00:00<?, ?B/s]sentencepiece.bpe.model: 100%|██████████| 5.07M/5.07M [00:00<00:00, 8.24MB/s]sentencepiece.bpe.model: 100%|██████████| 5.07M/5.07M [00:00<00:00, 8.22MB/s]
tokenizer.json:   0%|          | 0.00/9.10M [00:00<?, ?B/s]tokenizer.json: 100%|██████████| 9.10M/9.10M [00:00<00:00, 12.4MB/s]tokenizer.json: 100%|██████████| 9.10M/9.10M [00:00<00:00, 12.4MB/s]
model.safetensors:   0%|          | 0.00/1.12G [00:00<?, ?B/s]model.safetensors:   1%|          | 10.5M/1.12G [00:00<00:13, 83.9MB/s]model.safetensors:   3%|▎         | 31.5M/1.12G [00:00<00:10, 102MB/s] model.safetensors:   5%|▍         | 52.4M/1.12G [00:00<00:09, 108MB/s]model.safetensors:   7%|▋         | 73.4M/1.12G [00:00<00:09, 111MB/s]model.safetensors:   8%|▊         | 94.4M/1.12G [00:00<00:09, 113MB/s]model.safetensors:  10%|█         | 115M/1.12G [00:01<00:08, 115MB/s] model.safetensors:  12%|█▏        | 136M/1.12G [00:01<00:08, 116MB/s]model.safetensors:  14%|█▍        | 157M/1.12G [00:01<00:08, 116MB/s]model.safetensors:  16%|█▌        | 178M/1.12G [00:01<00:08, 117MB/s]model.safetensors:  18%|█▊        | 199M/1.12G [00:01<00:07, 117MB/s]model.safetensors:  20%|█▉        | 220M/1.12G [00:01<00:07, 117MB/s]model.safetensors:  22%|██▏       | 241M/1.12G [00:02<00:07, 117MB/s]model.safetensors:  23%|██▎       | 262M/1.12G [00:02<00:07, 117MB/s]model.safetensors:  25%|██▌       | 283M/1.12G [00:02<00:07, 117MB/s]model.safetensors:  27%|██▋       | 304M/1.12G [00:02<00:06, 117MB/s]model.safetensors:  29%|██▉       | 325M/1.12G [00:02<00:06, 117MB/s]model.safetensors:  31%|███       | 346M/1.12G [00:03<00:06, 117MB/s]model.safetensors:  33%|███▎      | 367M/1.12G [00:03<00:06, 117MB/s]model.safetensors:  35%|███▍      | 388M/1.12G [00:03<00:06, 117MB/s]model.safetensors:  37%|███▋      | 409M/1.12G [00:03<00:06, 117MB/s]model.safetensors:  39%|███▊      | 430M/1.12G [00:03<00:05, 117MB/s]model.safetensors:  40%|████      | 451M/1.12G [00:03<00:05, 117MB/s]model.safetensors:  42%|████▏     | 472M/1.12G [00:04<00:05, 117MB/s]model.safetensors:  44%|████▍     | 493M/1.12G [00:04<00:05, 117MB/s]model.safetensors:  46%|████▌     | 514M/1.12G [00:04<00:05, 117MB/s]model.safetensors:  48%|████▊     | 535M/1.12G [00:04<00:04, 117MB/s]model.safetensors:  50%|████▉     | 556M/1.12G [00:04<00:04, 117MB/s]model.safetensors:  52%|█████▏    | 577M/1.12G [00:04<00:04, 117MB/s]model.safetensors:  54%|█████▎    | 598M/1.12G [00:05<00:04, 117MB/s]model.safetensors:  55%|█████▌    | 619M/1.12G [00:05<00:04, 117MB/s]model.safetensors:  57%|█████▋    | 640M/1.12G [00:05<00:04, 117MB/s]model.safetensors:  59%|█████▉    | 661M/1.12G [00:05<00:03, 117MB/s]model.safetensors:  61%|██████    | 682M/1.12G [00:05<00:03, 117MB/s]model.safetensors:  63%|██████▎   | 703M/1.12G [00:06<00:03, 117MB/s]model.safetensors:  65%|██████▍   | 724M/1.12G [00:06<00:03, 117MB/s]model.safetensors:  67%|██████▋   | 744M/1.12G [00:06<00:03, 117MB/s]model.safetensors:  69%|██████▊   | 765M/1.12G [00:06<00:02, 117MB/s]model.safetensors:  70%|███████   | 786M/1.12G [00:06<00:02, 117MB/s]model.safetensors:  72%|███████▏  | 807M/1.12G [00:06<00:02, 117MB/s]model.safetensors:  74%|███████▍  | 828M/1.12G [00:07<00:02, 117MB/s]model.safetensors:  76%|███████▌  | 849M/1.12G [00:07<00:02, 117MB/s]model.safetensors:  78%|███████▊  | 870M/1.12G [00:07<00:02, 117MB/s]model.safetensors:  80%|███████▉  | 891M/1.12G [00:07<00:01, 117MB/s]model.safetensors:  82%|████████▏ | 912M/1.12G [00:07<00:01, 117MB/s]model.safetensors:  84%|████████▎ | 933M/1.12G [00:08<00:01, 117MB/s]model.safetensors:  86%|████████▌ | 954M/1.12G [00:08<00:01, 117MB/s]model.safetensors:  87%|████████▋ | 975M/1.12G [00:08<00:01, 117MB/s]model.safetensors:  89%|████████▉ | 996M/1.12G [00:08<00:01, 117MB/s]model.safetensors:  91%|█████████ | 1.02G/1.12G [00:08<00:00, 117MB/s]model.safetensors:  93%|█████████▎| 1.04G/1.12G [00:08<00:00, 117MB/s]model.safetensors:  95%|█████████▍| 1.06G/1.12G [00:09<00:00, 117MB/s]model.safetensors:  97%|█████████▋| 1.08G/1.12G [00:09<00:00, 117MB/s]model.safetensors:  99%|█████████▊| 1.10G/1.12G [00:09<00:00, 117MB/s]model.safetensors: 100%|██████████| 1.12G/1.12G [00:09<00:00, 117MB/s]model.safetensors: 100%|██████████| 1.12G/1.12G [00:09<00:00, 117MB/s]
Some weights of XLMRobertaForTokenClassification were not initialized from the model checkpoint at xlm-roberta-base and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
01150927_tsa-bin_XLM-R_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 4718.75 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:01, 5758.56 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 5956.18 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6128.02 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6300.02 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 6440.30 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 6644.17 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6727.69 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6029.75 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 6841.02 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6498.53 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 6503.18 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6322.34 examples/s]
You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_XLM-R_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'attention_mask', 'labels']
{'loss': 1.3024, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0}
{'eval_loss': 0.34087398648262024, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341079286651741, 'eval_runtime': 2.6508, 'eval_samples_per_second': 577.554, 'eval_steps_per_second': 72.43, 'epoch': 1.0}
{'loss': 0.3169, 'learning_rate': 9e-07, 'epoch': 2.0}
{'eval_loss': 0.26387396454811096, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.3114, 'eval_samples_per_second': 662.371, 'eval_steps_per_second': 83.067, 'epoch': 2.0}
{'loss': 0.2787, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0}
{'eval_loss': 0.24456392228603363, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.3271, 'eval_samples_per_second': 657.903, 'eval_steps_per_second': 82.506, 'epoch': 3.0}
{'loss': 0.2638, 'learning_rate': 8e-07, 'epoch': 4.0}
{'eval_loss': 0.23787154257297516, 'eval_precision': 1.0, 'eval_recall': 0.0011402508551881414, 'eval_f1': 0.0022779043280182236, 'eval_accuracy': 0.9342237319539874, 'eval_runtime': 2.3056, 'eval_samples_per_second': 664.049, 'eval_steps_per_second': 83.277, 'epoch': 4.0}
{'loss': 0.2548, 'learning_rate': 7.5e-07, 'epoch': 5.0}
{'eval_loss': 0.2288656085729599, 'eval_precision': 0.25, 'eval_recall': 0.002280501710376283, 'eval_f1': 0.004519774011299435, 'eval_accuracy': 0.9344167374353431, 'eval_runtime': 2.3165, 'eval_samples_per_second': 660.923, 'eval_steps_per_second': 82.885, 'epoch': 5.0}
{'loss': 0.2461, 'learning_rate': 7e-07, 'epoch': 6.0}
{'eval_loss': 0.22483903169631958, 'eval_precision': 0.14285714285714285, 'eval_recall': 0.004561003420752566, 'eval_f1': 0.008839779005524863, 'eval_accuracy': 0.9348413494943256, 'eval_runtime': 2.3115, 'eval_samples_per_second': 662.329, 'eval_steps_per_second': 83.061, 'epoch': 6.0}
{'loss': 0.2402, 'learning_rate': 6.5e-07, 'epoch': 7.0}
{'eval_loss': 0.22122418880462646, 'eval_precision': 0.16326530612244897, 'eval_recall': 0.009122006841505131, 'eval_f1': 0.017278617710583154, 'eval_accuracy': 0.935227360457037, 'eval_runtime': 2.3105, 'eval_samples_per_second': 662.618, 'eval_steps_per_second': 83.098, 'epoch': 7.0}
{'loss': 0.2352, 'learning_rate': 6e-07, 'epoch': 8.0}
{'eval_loss': 0.2187120020389557, 'eval_precision': 0.21052631578947367, 'eval_recall': 0.027366020524515394, 'eval_f1': 0.0484359233097881, 'eval_accuracy': 0.9361537867675442, 'eval_runtime': 2.3043, 'eval_samples_per_second': 664.397, 'eval_steps_per_second': 83.321, 'epoch': 8.0}
{'loss': 0.229, 'learning_rate': 5.5e-07, 'epoch': 9.0}
{'eval_loss': 0.21435393393039703, 'eval_precision': 0.26119402985074625, 'eval_recall': 0.039908779931584946, 'eval_f1': 0.06923837784371908, 'eval_accuracy': 0.9367714043078823, 'eval_runtime': 2.3825, 'eval_samples_per_second': 642.593, 'eval_steps_per_second': 80.586, 'epoch': 9.0}
{'loss': 0.2259, 'learning_rate': 5e-07, 'epoch': 10.0}
{'eval_loss': 0.21155305206775665, 'eval_precision': 0.31868131868131866, 'eval_recall': 0.0661345496009122, 'eval_f1': 0.10953729933899904, 'eval_accuracy': 0.9378908360997452, 'eval_runtime': 2.3043, 'eval_samples_per_second': 664.424, 'eval_steps_per_second': 83.324, 'epoch': 10.0}
{'loss': 0.2221, 'learning_rate': 4.5e-07, 'epoch': 11.0}
{'eval_loss': 0.20886090397834778, 'eval_precision': 0.3413654618473896, 'eval_recall': 0.09692132269099202, 'eval_f1': 0.15097690941385433, 'eval_accuracy': 0.9385470547363545, 'eval_runtime': 2.3185, 'eval_samples_per_second': 660.353, 'eval_steps_per_second': 82.814, 'epoch': 11.0}
{'loss': 0.2191, 'learning_rate': 4e-07, 'epoch': 12.0}
{'eval_loss': 0.20673806965351105, 'eval_precision': 0.35782747603833864, 'eval_recall': 0.12770809578107184, 'eval_f1': 0.18823529411764706, 'eval_accuracy': 0.9390102678916081, 'eval_runtime': 2.3146, 'eval_samples_per_second': 661.468, 'eval_steps_per_second': 82.953, 'epoch': 12.0}
{'loss': 0.2159, 'learning_rate': 3.5e-07, 'epoch': 13.0}
{'eval_loss': 0.20498965680599213, 'eval_precision': 0.36813186813186816, 'eval_recall': 0.15279361459521096, 'eval_f1': 0.21595487510072525, 'eval_accuracy': 0.9390874700841504, 'eval_runtime': 2.3006, 'eval_samples_per_second': 665.465, 'eval_steps_per_second': 83.455, 'epoch': 13.0}
{'loss': 0.2142, 'learning_rate': 3e-07, 'epoch': 14.0}
{'eval_loss': 0.20339488983154297, 'eval_precision': 0.3525, 'eval_recall': 0.16077537058152794, 'eval_f1': 0.22083007047768205, 'eval_accuracy': 0.9394734810468617, 'eval_runtime': 2.3094, 'eval_samples_per_second': 662.943, 'eval_steps_per_second': 83.139, 'epoch': 14.0}
{'loss': 0.2126, 'learning_rate': 2.5e-07, 'epoch': 15.0}
{'eval_loss': 0.2020605355501175, 'eval_precision': 0.35167464114832536, 'eval_recall': 0.1676168757126568, 'eval_f1': 0.227027027027027, 'eval_accuracy': 0.940129699683471, 'eval_runtime': 2.3079, 'eval_samples_per_second': 663.37, 'eval_steps_per_second': 83.192, 'epoch': 15.0}
{'loss': 0.2111, 'learning_rate': 2e-07, 'epoch': 16.0}
{'eval_loss': 0.20122498273849487, 'eval_precision': 0.3488888888888889, 'eval_recall': 0.1790193842645382, 'eval_f1': 0.23662396382818388, 'eval_accuracy': 0.9402841040685556, 'eval_runtime': 2.3074, 'eval_samples_per_second': 663.518, 'eval_steps_per_second': 83.211, 'epoch': 16.0}
{'loss': 0.2094, 'learning_rate': 1.5e-07, 'epoch': 17.0}
{'eval_loss': 0.20076324045658112, 'eval_precision': 0.3531827515400411, 'eval_recall': 0.1961231470923603, 'eval_f1': 0.25219941348973607, 'eval_accuracy': 0.9404385084536401, 'eval_runtime': 2.3308, 'eval_samples_per_second': 656.867, 'eval_steps_per_second': 82.377, 'epoch': 17.0}
{'loss': 0.2082, 'learning_rate': 1e-07, 'epoch': 18.0}
{'eval_loss': 0.1998732089996338, 'eval_precision': 0.35789473684210527, 'eval_recall': 0.19384264538198404, 'eval_f1': 0.2514792899408284, 'eval_accuracy': 0.9405157106461823, 'eval_runtime': 2.3161, 'eval_samples_per_second': 661.027, 'eval_steps_per_second': 82.898, 'epoch': 18.0}
{'loss': 0.2068, 'learning_rate': 5e-08, 'epoch': 19.0}
{'eval_loss': 0.19941435754299164, 'eval_precision': 0.354639175257732, 'eval_recall': 0.1961231470923603, 'eval_f1': 0.2525697503671072, 'eval_accuracy': 0.940708716127538, 'eval_runtime': 2.3193, 'eval_samples_per_second': 660.116, 'eval_steps_per_second': 82.784, 'epoch': 19.0}
{'loss': 0.2053, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.1993967890739441, 'eval_precision': 0.35365853658536583, 'eval_recall': 0.19840364880273662, 'eval_f1': 0.25420014609203795, 'eval_accuracy': 0.9404771095499113, 'eval_runtime': 2.3148, 'eval_samples_per_second': 661.407, 'eval_steps_per_second': 82.946, 'epoch': 20.0}
{'train_runtime': 706.6896, 'train_samples_per_second': 244.351, 'train_steps_per_second': 3.821, 'train_loss': 0.28588256412082247, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.2859
  train_runtime            = 0:11:46.68
  train_samples            =       8634
  train_samples_per_second =    244.351
  train_steps_per_second   =      3.821
[{'loss': 1.3024, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.34087398648262024, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341079286651741, 'eval_runtime': 2.6508, 'eval_samples_per_second': 577.554, 'eval_steps_per_second': 72.43, 'epoch': 1.0, 'step': 135}, {'loss': 0.3169, 'learning_rate': 9e-07, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.26387396454811096, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.3114, 'eval_samples_per_second': 662.371, 'eval_steps_per_second': 83.067, 'epoch': 2.0, 'step': 270}, {'loss': 0.2787, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.24456392228603363, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.3271, 'eval_samples_per_second': 657.903, 'eval_steps_per_second': 82.506, 'epoch': 3.0, 'step': 405}, {'loss': 0.2638, 'learning_rate': 8e-07, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.23787154257297516, 'eval_precision': 1.0, 'eval_recall': 0.0011402508551881414, 'eval_f1': 0.0022779043280182236, 'eval_accuracy': 0.9342237319539874, 'eval_runtime': 2.3056, 'eval_samples_per_second': 664.049, 'eval_steps_per_second': 83.277, 'epoch': 4.0, 'step': 540}, {'loss': 0.2548, 'learning_rate': 7.5e-07, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.2288656085729599, 'eval_precision': 0.25, 'eval_recall': 0.002280501710376283, 'eval_f1': 0.004519774011299435, 'eval_accuracy': 0.9344167374353431, 'eval_runtime': 2.3165, 'eval_samples_per_second': 660.923, 'eval_steps_per_second': 82.885, 'epoch': 5.0, 'step': 675}, {'loss': 0.2461, 'learning_rate': 7e-07, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.22483903169631958, 'eval_precision': 0.14285714285714285, 'eval_recall': 0.004561003420752566, 'eval_f1': 0.008839779005524863, 'eval_accuracy': 0.9348413494943256, 'eval_runtime': 2.3115, 'eval_samples_per_second': 662.329, 'eval_steps_per_second': 83.061, 'epoch': 6.0, 'step': 810}, {'loss': 0.2402, 'learning_rate': 6.5e-07, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.22122418880462646, 'eval_precision': 0.16326530612244897, 'eval_recall': 0.009122006841505131, 'eval_f1': 0.017278617710583154, 'eval_accuracy': 0.935227360457037, 'eval_runtime': 2.3105, 'eval_samples_per_second': 662.618, 'eval_steps_per_second': 83.098, 'epoch': 7.0, 'step': 945}, {'loss': 0.2352, 'learning_rate': 6e-07, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.2187120020389557, 'eval_precision': 0.21052631578947367, 'eval_recall': 0.027366020524515394, 'eval_f1': 0.0484359233097881, 'eval_accuracy': 0.9361537867675442, 'eval_runtime': 2.3043, 'eval_samples_per_second': 664.397, 'eval_steps_per_second': 83.321, 'epoch': 8.0, 'step': 1080}, {'loss': 0.229, 'learning_rate': 5.5e-07, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.21435393393039703, 'eval_precision': 0.26119402985074625, 'eval_recall': 0.039908779931584946, 'eval_f1': 0.06923837784371908, 'eval_accuracy': 0.9367714043078823, 'eval_runtime': 2.3825, 'eval_samples_per_second': 642.593, 'eval_steps_per_second': 80.586, 'epoch': 9.0, 'step': 1215}, {'loss': 0.2259, 'learning_rate': 5e-07, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.21155305206775665, 'eval_precision': 0.31868131868131866, 'eval_recall': 0.0661345496009122, 'eval_f1': 0.10953729933899904, 'eval_accuracy': 0.9378908360997452, 'eval_runtime': 2.3043, 'eval_samples_per_second': 664.424, 'eval_steps_per_second': 83.324, 'epoch': 10.0, 'step': 1350}, {'loss': 0.2221, 'learning_rate': 4.5e-07, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.20886090397834778, 'eval_precision': 0.3413654618473896, 'eval_recall': 0.09692132269099202, 'eval_f1': 0.15097690941385433, 'eval_accuracy': 0.9385470547363545, 'eval_runtime': 2.3185, 'eval_samples_per_second': 660.353, 'eval_steps_per_second': 82.814, 'epoch': 11.0, 'step': 1485}, {'loss': 0.2191, 'learning_rate': 4e-07, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.20673806965351105, 'eval_precision': 0.35782747603833864, 'eval_recall': 0.12770809578107184, 'eval_f1': 0.18823529411764706, 'eval_accuracy': 0.9390102678916081, 'eval_runtime': 2.3146, 'eval_samples_per_second': 661.468, 'eval_steps_per_second': 82.953, 'epoch': 12.0, 'step': 1620}, {'loss': 0.2159, 'learning_rate': 3.5e-07, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.20498965680599213, 'eval_precision': 0.36813186813186816, 'eval_recall': 0.15279361459521096, 'eval_f1': 0.21595487510072525, 'eval_accuracy': 0.9390874700841504, 'eval_runtime': 2.3006, 'eval_samples_per_second': 665.465, 'eval_steps_per_second': 83.455, 'epoch': 13.0, 'step': 1755}, {'loss': 0.2142, 'learning_rate': 3e-07, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.20339488983154297, 'eval_precision': 0.3525, 'eval_recall': 0.16077537058152794, 'eval_f1': 0.22083007047768205, 'eval_accuracy': 0.9394734810468617, 'eval_runtime': 2.3094, 'eval_samples_per_second': 662.943, 'eval_steps_per_second': 83.139, 'epoch': 14.0, 'step': 1890}, {'loss': 0.2126, 'learning_rate': 2.5e-07, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.2020605355501175, 'eval_precision': 0.35167464114832536, 'eval_recall': 0.1676168757126568, 'eval_f1': 0.227027027027027, 'eval_accuracy': 0.940129699683471, 'eval_runtime': 2.3079, 'eval_samples_per_second': 663.37, 'eval_steps_per_second': 83.192, 'epoch': 15.0, 'step': 2025}, {'loss': 0.2111, 'learning_rate': 2e-07, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.20122498273849487, 'eval_precision': 0.3488888888888889, 'eval_recall': 0.1790193842645382, 'eval_f1': 0.23662396382818388, 'eval_accuracy': 0.9402841040685556, 'eval_runtime': 2.3074, 'eval_samples_per_second': 663.518, 'eval_steps_per_second': 83.211, 'epoch': 16.0, 'step': 2160}, {'loss': 0.2094, 'learning_rate': 1.5e-07, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.20076324045658112, 'eval_precision': 0.3531827515400411, 'eval_recall': 0.1961231470923603, 'eval_f1': 0.25219941348973607, 'eval_accuracy': 0.9404385084536401, 'eval_runtime': 2.3308, 'eval_samples_per_second': 656.867, 'eval_steps_per_second': 82.377, 'epoch': 17.0, 'step': 2295}, {'loss': 0.2082, 'learning_rate': 1e-07, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.1998732089996338, 'eval_precision': 0.35789473684210527, 'eval_recall': 0.19384264538198404, 'eval_f1': 0.2514792899408284, 'eval_accuracy': 0.9405157106461823, 'eval_runtime': 2.3161, 'eval_samples_per_second': 661.027, 'eval_steps_per_second': 82.898, 'epoch': 18.0, 'step': 2430}, {'loss': 0.2068, 'learning_rate': 5e-08, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.19941435754299164, 'eval_precision': 0.354639175257732, 'eval_recall': 0.1961231470923603, 'eval_f1': 0.2525697503671072, 'eval_accuracy': 0.940708716127538, 'eval_runtime': 2.3193, 'eval_samples_per_second': 660.116, 'eval_steps_per_second': 82.784, 'epoch': 19.0, 'step': 2565}, {'loss': 0.2053, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.1993967890739441, 'eval_precision': 0.35365853658536583, 'eval_recall': 0.19840364880273662, 'eval_f1': 0.25420014609203795, 'eval_accuracy': 0.9404771095499113, 'eval_runtime': 2.3148, 'eval_samples_per_second': 661.407, 'eval_steps_per_second': 82.946, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 706.6896, 'train_samples_per_second': 244.351, 'train_steps_per_second': 3.821, 'total_flos': 7230575408749680.0, 'train_loss': 0.28588256412082247, 'epoch': 20.0, 'step': 2700}]

Evaluation, xlm-roberta-base
***** predict metrics *****
  predict_accuracy           =     0.9437
  predict_f1                 =     0.2688
  predict_loss               =     0.1981
  predict_precision          =     0.3937
  predict_recall             =     0.2041
  predict_runtime            = 0:00:01.94
  predict_samples_per_second =    653.853
  predict_steps_per_second   =     81.732
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_17.json completed. F1: 0.2688172043010753
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_07.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_07.json
01150927_tsa-bin_NorBERT_3_x-small Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6530.95 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6993.76 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6841.59 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6819.11 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6891.00 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7020.57 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7173.99 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 7242.23 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6687.94 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7244.60 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6893.14 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7026.21 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6796.06 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/projects/ec30/egilron/tsa-hf/01150927_tsa-bin_NorBERT_3_x-small/checkpoint-135 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_x-small Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9891, 'eval_samples_per_second': 512.188, 'eval_steps_per_second': 64.233, 'epoch': 1.0}
{'loss': 0.0, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9862, 'eval_samples_per_second': 512.696, 'eval_steps_per_second': 64.296, 'epoch': 2.0}
{'loss': 0.0, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9766, 'eval_samples_per_second': 514.352, 'eval_steps_per_second': 64.504, 'epoch': 3.0}
{'loss': 0.0, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9752, 'eval_samples_per_second': 514.594, 'eval_steps_per_second': 64.534, 'epoch': 4.0}
{'loss': 0.0, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9726, 'eval_samples_per_second': 515.036, 'eval_steps_per_second': 64.59, 'epoch': 5.0}
{'loss': 0.0, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9673, 'eval_samples_per_second': 515.961, 'eval_steps_per_second': 64.706, 'epoch': 6.0}
{'loss': 0.0, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.979, 'eval_samples_per_second': 513.937, 'eval_steps_per_second': 64.452, 'epoch': 7.0}
{'loss': 0.0, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9662, 'eval_samples_per_second': 516.152, 'eval_steps_per_second': 64.73, 'epoch': 8.0}
{'loss': 0.0, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9825, 'eval_samples_per_second': 513.326, 'eval_steps_per_second': 64.375, 'epoch': 9.0}
{'loss': 0.0, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0463, 'eval_samples_per_second': 502.582, 'eval_steps_per_second': 63.028, 'epoch': 10.0}
{'loss': 0.0, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9444, 'eval_samples_per_second': 519.978, 'eval_steps_per_second': 65.21, 'epoch': 11.0}
{'loss': 0.0, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9928, 'eval_samples_per_second': 511.554, 'eval_steps_per_second': 64.153, 'epoch': 12.0}
{'loss': 0.0, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.948, 'eval_samples_per_second': 519.339, 'eval_steps_per_second': 65.129, 'epoch': 13.0}
{'loss': 0.0, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9553, 'eval_samples_per_second': 518.054, 'eval_steps_per_second': 64.968, 'epoch': 14.0}
{'loss': 0.0, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0712, 'eval_samples_per_second': 498.502, 'eval_steps_per_second': 62.516, 'epoch': 15.0}
{'loss': 0.0, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9563, 'eval_samples_per_second': 517.875, 'eval_steps_per_second': 64.946, 'epoch': 16.0}
{'loss': 0.0, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9661, 'eval_samples_per_second': 516.169, 'eval_steps_per_second': 64.732, 'epoch': 17.0}
{'loss': 0.0, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.1027, 'eval_samples_per_second': 493.442, 'eval_steps_per_second': 61.882, 'epoch': 18.0}
{'loss': 0.0, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9463, 'eval_samples_per_second': 519.633, 'eval_steps_per_second': 65.166, 'epoch': 19.0}
{'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9464, 'eval_samples_per_second': 519.609, 'eval_steps_per_second': 65.163, 'epoch': 20.0}
{'train_runtime': 240.9436, 'train_samples_per_second': 716.682, 'train_steps_per_second': 11.206, 'train_loss': 0.0, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =        0.0
  train_runtime            = 0:04:00.94
  train_samples            =       8634
  train_samples_per_second =    716.682
  train_steps_per_second   =     11.206
[{'loss': 0.0, 'learning_rate': 9.5e-06, 'epoch': 1.0, 'step': 135}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9891, 'eval_samples_per_second': 512.188, 'eval_steps_per_second': 64.233, 'epoch': 1.0, 'step': 135}, {'loss': 0.0, 'learning_rate': 9e-06, 'epoch': 2.0, 'step': 270}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9862, 'eval_samples_per_second': 512.696, 'eval_steps_per_second': 64.296, 'epoch': 2.0, 'step': 270}, {'loss': 0.0, 'learning_rate': 8.5e-06, 'epoch': 3.0, 'step': 405}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9766, 'eval_samples_per_second': 514.352, 'eval_steps_per_second': 64.504, 'epoch': 3.0, 'step': 405}, {'loss': 0.0, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0, 'step': 540}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9752, 'eval_samples_per_second': 514.594, 'eval_steps_per_second': 64.534, 'epoch': 4.0, 'step': 540}, {'loss': 0.0, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0, 'step': 675}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9726, 'eval_samples_per_second': 515.036, 'eval_steps_per_second': 64.59, 'epoch': 5.0, 'step': 675}, {'loss': 0.0, 'learning_rate': 7e-06, 'epoch': 6.0, 'step': 810}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9673, 'eval_samples_per_second': 515.961, 'eval_steps_per_second': 64.706, 'epoch': 6.0, 'step': 810}, {'loss': 0.0, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0, 'step': 945}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.979, 'eval_samples_per_second': 513.937, 'eval_steps_per_second': 64.452, 'epoch': 7.0, 'step': 945}, {'loss': 0.0, 'learning_rate': 6e-06, 'epoch': 8.0, 'step': 1080}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9662, 'eval_samples_per_second': 516.152, 'eval_steps_per_second': 64.73, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0, 'step': 1215}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9825, 'eval_samples_per_second': 513.326, 'eval_steps_per_second': 64.375, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0, 'learning_rate': 5e-06, 'epoch': 10.0, 'step': 1350}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0463, 'eval_samples_per_second': 502.582, 'eval_steps_per_second': 63.028, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0, 'learning_rate': 4.5e-06, 'epoch': 11.0, 'step': 1485}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9444, 'eval_samples_per_second': 519.978, 'eval_steps_per_second': 65.21, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0, 'step': 1620}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9928, 'eval_samples_per_second': 511.554, 'eval_steps_per_second': 64.153, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0, 'learning_rate': 3.5e-06, 'epoch': 13.0, 'step': 1755}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.948, 'eval_samples_per_second': 519.339, 'eval_steps_per_second': 65.129, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0, 'learning_rate': 3e-06, 'epoch': 14.0, 'step': 1890}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9553, 'eval_samples_per_second': 518.054, 'eval_steps_per_second': 64.968, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0, 'learning_rate': 2.5e-06, 'epoch': 15.0, 'step': 2025}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.0712, 'eval_samples_per_second': 498.502, 'eval_steps_per_second': 62.516, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0, 'step': 2160}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9563, 'eval_samples_per_second': 517.875, 'eval_steps_per_second': 64.946, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0, 'learning_rate': 1.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9661, 'eval_samples_per_second': 516.169, 'eval_steps_per_second': 64.732, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 3.1027, 'eval_samples_per_second': 493.442, 'eval_steps_per_second': 61.882, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0, 'step': 2565}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9463, 'eval_samples_per_second': 519.633, 'eval_steps_per_second': 65.166, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.9464, 'eval_samples_per_second': 519.609, 'eval_steps_per_second': 65.163, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 240.9436, 'train_samples_per_second': 716.682, 'train_steps_per_second': 11.206, 'total_flos': 399234715456896.0, 'train_loss': 0.0, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-xs
***** predict metrics *****
  predict_accuracy           =     0.9327
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:02.45
  predict_samples_per_second =    518.167
  predict_steps_per_second   =     64.771
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_x-small_07.json completed. F1: 0.0
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_20.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_20.json
01150927_tsa-bin_NorBERT_3_large Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6833.30 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 7199.65 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6995.53 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 7019.93 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 7028.04 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7198.06 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7337.01 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6378.55 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6826.43 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7439.61 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7071.52 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7096.52 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6934.60 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/projects/ec30/egilron/tsa-hf/01150927_tsa-bin_NorBERT_3_large/checkpoint-135 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_large Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 1.519, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0}
{'eval_loss': 1.4237232208251953, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8649, 'eval_samples_per_second': 261.043, 'eval_steps_per_second': 32.737, 'epoch': 1.0}
{'loss': 1.3392, 'learning_rate': 9e-07, 'epoch': 2.0}
{'eval_loss': 1.2558459043502808, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8374, 'eval_samples_per_second': 262.276, 'eval_steps_per_second': 32.892, 'epoch': 2.0}
{'loss': 1.1832, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0}
{'eval_loss': 1.109763503074646, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.811, 'eval_samples_per_second': 263.465, 'eval_steps_per_second': 33.041, 'epoch': 3.0}
{'loss': 1.0477, 'learning_rate': 8e-07, 'epoch': 4.0}
{'eval_loss': 0.9839034080505371, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7952, 'eval_samples_per_second': 264.185, 'eval_steps_per_second': 33.131, 'epoch': 4.0}
{'loss': 0.9317, 'learning_rate': 7.5e-07, 'epoch': 5.0}
{'eval_loss': 0.8766928911209106, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7542, 'eval_samples_per_second': 266.065, 'eval_steps_per_second': 33.367, 'epoch': 5.0}
{'loss': 0.8337, 'learning_rate': 7e-07, 'epoch': 6.0}
{'eval_loss': 0.7863522171974182, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.767, 'eval_samples_per_second': 265.477, 'eval_steps_per_second': 33.293, 'epoch': 6.0}
{'loss': 0.7512, 'learning_rate': 6.5e-07, 'epoch': 7.0}
{'eval_loss': 0.7109620571136475, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7711, 'eval_samples_per_second': 265.286, 'eval_steps_per_second': 33.269, 'epoch': 7.0}
{'loss': 0.6825, 'learning_rate': 6e-07, 'epoch': 8.0}
{'eval_loss': 0.6485874056816101, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.791, 'eval_samples_per_second': 264.376, 'eval_steps_per_second': 33.155, 'epoch': 8.0}
{'loss': 0.6263, 'learning_rate': 5.5e-07, 'epoch': 9.0}
{'eval_loss': 0.5973735451698303, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.85, 'eval_samples_per_second': 261.711, 'eval_steps_per_second': 32.821, 'epoch': 9.0}
{'loss': 0.5804, 'learning_rate': 5e-07, 'epoch': 10.0}
{'eval_loss': 0.5556123852729797, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7532, 'eval_samples_per_second': 266.115, 'eval_steps_per_second': 33.373, 'epoch': 10.0}
{'loss': 0.5427, 'learning_rate': 4.5e-07, 'epoch': 11.0}
{'eval_loss': 0.5217818021774292, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7534, 'eval_samples_per_second': 266.102, 'eval_steps_per_second': 33.371, 'epoch': 11.0}
{'loss': 0.5125, 'learning_rate': 4e-07, 'epoch': 12.0}
{'eval_loss': 0.49454542994499207, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7593, 'eval_samples_per_second': 265.83, 'eval_steps_per_second': 33.337, 'epoch': 12.0}
{'loss': 0.4887, 'learning_rate': 3.5e-07, 'epoch': 13.0}
{'eval_loss': 0.4727993309497833, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7329, 'eval_samples_per_second': 267.057, 'eval_steps_per_second': 33.491, 'epoch': 13.0}
{'loss': 0.4696, 'learning_rate': 3e-07, 'epoch': 14.0}
{'eval_loss': 0.4556021988391876, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7217, 'eval_samples_per_second': 267.578, 'eval_steps_per_second': 33.557, 'epoch': 14.0}
{'loss': 0.4543, 'learning_rate': 2.5e-07, 'epoch': 15.0}
{'eval_loss': 0.4422057271003723, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7248, 'eval_samples_per_second': 267.434, 'eval_steps_per_second': 33.538, 'epoch': 15.0}
{'loss': 0.4426, 'learning_rate': 2e-07, 'epoch': 16.0}
{'eval_loss': 0.43199867010116577, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7311, 'eval_samples_per_second': 267.141, 'eval_steps_per_second': 33.502, 'epoch': 16.0}
{'loss': 0.4337, 'learning_rate': 1.5e-07, 'epoch': 17.0}
{'eval_loss': 0.42451462149620056, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7655, 'eval_samples_per_second': 265.543, 'eval_steps_per_second': 33.301, 'epoch': 17.0}
{'loss': 0.4281, 'learning_rate': 1e-07, 'epoch': 18.0}
{'eval_loss': 0.41940510272979736, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7224, 'eval_samples_per_second': 267.544, 'eval_steps_per_second': 33.552, 'epoch': 18.0}
{'loss': 0.423, 'learning_rate': 5e-08, 'epoch': 19.0}
{'eval_loss': 0.41643083095550537, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7341, 'eval_samples_per_second': 267.0, 'eval_steps_per_second': 33.484, 'epoch': 19.0}
{'loss': 0.4214, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.4154490530490875, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7912, 'eval_samples_per_second': 264.366, 'eval_steps_per_second': 33.154, 'epoch': 20.0}
{'train_runtime': 2055.817, 'train_samples_per_second': 83.996, 'train_steps_per_second': 1.313, 'train_loss': 0.7055746036105686, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.7056
  train_runtime            = 0:34:15.81
  train_samples            =       8634
  train_samples_per_second =     83.996
  train_steps_per_second   =      1.313
[{'loss': 1.519, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0, 'step': 135}, {'eval_loss': 1.4237232208251953, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8649, 'eval_samples_per_second': 261.043, 'eval_steps_per_second': 32.737, 'epoch': 1.0, 'step': 135}, {'loss': 1.3392, 'learning_rate': 9e-07, 'epoch': 2.0, 'step': 270}, {'eval_loss': 1.2558459043502808, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8374, 'eval_samples_per_second': 262.276, 'eval_steps_per_second': 32.892, 'epoch': 2.0, 'step': 270}, {'loss': 1.1832, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0, 'step': 405}, {'eval_loss': 1.109763503074646, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.811, 'eval_samples_per_second': 263.465, 'eval_steps_per_second': 33.041, 'epoch': 3.0, 'step': 405}, {'loss': 1.0477, 'learning_rate': 8e-07, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.9839034080505371, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7952, 'eval_samples_per_second': 264.185, 'eval_steps_per_second': 33.131, 'epoch': 4.0, 'step': 540}, {'loss': 0.9317, 'learning_rate': 7.5e-07, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.8766928911209106, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7542, 'eval_samples_per_second': 266.065, 'eval_steps_per_second': 33.367, 'epoch': 5.0, 'step': 675}, {'loss': 0.8337, 'learning_rate': 7e-07, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.7863522171974182, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.767, 'eval_samples_per_second': 265.477, 'eval_steps_per_second': 33.293, 'epoch': 6.0, 'step': 810}, {'loss': 0.7512, 'learning_rate': 6.5e-07, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.7109620571136475, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7711, 'eval_samples_per_second': 265.286, 'eval_steps_per_second': 33.269, 'epoch': 7.0, 'step': 945}, {'loss': 0.6825, 'learning_rate': 6e-07, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.6485874056816101, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.791, 'eval_samples_per_second': 264.376, 'eval_steps_per_second': 33.155, 'epoch': 8.0, 'step': 1080}, {'loss': 0.6263, 'learning_rate': 5.5e-07, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.5973735451698303, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.85, 'eval_samples_per_second': 261.711, 'eval_steps_per_second': 32.821, 'epoch': 9.0, 'step': 1215}, {'loss': 0.5804, 'learning_rate': 5e-07, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.5556123852729797, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7532, 'eval_samples_per_second': 266.115, 'eval_steps_per_second': 33.373, 'epoch': 10.0, 'step': 1350}, {'loss': 0.5427, 'learning_rate': 4.5e-07, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.5217818021774292, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7534, 'eval_samples_per_second': 266.102, 'eval_steps_per_second': 33.371, 'epoch': 11.0, 'step': 1485}, {'loss': 0.5125, 'learning_rate': 4e-07, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.49454542994499207, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7593, 'eval_samples_per_second': 265.83, 'eval_steps_per_second': 33.337, 'epoch': 12.0, 'step': 1620}, {'loss': 0.4887, 'learning_rate': 3.5e-07, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.4727993309497833, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7329, 'eval_samples_per_second': 267.057, 'eval_steps_per_second': 33.491, 'epoch': 13.0, 'step': 1755}, {'loss': 0.4696, 'learning_rate': 3e-07, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.4556021988391876, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7217, 'eval_samples_per_second': 267.578, 'eval_steps_per_second': 33.557, 'epoch': 14.0, 'step': 1890}, {'loss': 0.4543, 'learning_rate': 2.5e-07, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.4422057271003723, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7248, 'eval_samples_per_second': 267.434, 'eval_steps_per_second': 33.538, 'epoch': 15.0, 'step': 2025}, {'loss': 0.4426, 'learning_rate': 2e-07, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.43199867010116577, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7311, 'eval_samples_per_second': 267.141, 'eval_steps_per_second': 33.502, 'epoch': 16.0, 'step': 2160}, {'loss': 0.4337, 'learning_rate': 1.5e-07, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.42451462149620056, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7655, 'eval_samples_per_second': 265.543, 'eval_steps_per_second': 33.301, 'epoch': 17.0, 'step': 2295}, {'loss': 0.4281, 'learning_rate': 1e-07, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.41940510272979736, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7224, 'eval_samples_per_second': 267.544, 'eval_steps_per_second': 33.552, 'epoch': 18.0, 'step': 2430}, {'loss': 0.423, 'learning_rate': 5e-08, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.41643083095550537, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7341, 'eval_samples_per_second': 267.0, 'eval_steps_per_second': 33.484, 'epoch': 19.0, 'step': 2565}, {'loss': 0.4214, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.4154490530490875, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7912, 'eval_samples_per_second': 264.366, 'eval_steps_per_second': 33.154, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 2055.817, 'train_samples_per_second': 83.996, 'train_steps_per_second': 1.313, 'total_flos': 2.253072487096051e+16, 'train_loss': 0.7055746036105686, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9327
  predict_f1                 =        0.0
  predict_loss               =      0.418
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.80
  predict_samples_per_second =    264.593
  predict_steps_per_second   =     33.074
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_20.json completed. F1: 0.0
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_12.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Some weights of BertForTokenClassification were not initialized from the model checkpoint at NbAiLab/nb-bert-large and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_12.json
01150927_tsa-bin_NB-BERT_large Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5523.67 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:01, 6607.12 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6694.17 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6874.92 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 7009.76 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7169.35 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 6329.48 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6708.10 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6731.40 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7481.07 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7107.30 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7185.77 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6986.08 examples/s]
You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
01150927_tsa-bin_NB-BERT_large Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.2739, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': 0.16601088643074036, 'eval_precision': 0.3716012084592145, 'eval_recall': 0.4207525655644242, 'eval_f1': 0.3946524064171123, 'eval_accuracy': 0.9455724542577009, 'eval_runtime': 4.7001, 'eval_samples_per_second': 325.74, 'eval_steps_per_second': 40.851, 'epoch': 1.0}
{'loss': 0.1531, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': 0.1395009458065033, 'eval_precision': 0.5168408826945412, 'eval_recall': 0.507411630558723, 'eval_f1': 0.5120828538550058, 'eval_accuracy': 0.9532154713193854, 'eval_runtime': 4.6858, 'eval_samples_per_second': 326.735, 'eval_steps_per_second': 40.975, 'epoch': 2.0}
{'loss': 0.1184, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': 0.14003601670265198, 'eval_precision': 0.5694050991501416, 'eval_recall': 0.4583808437856328, 'eval_f1': 0.5078963992419455, 'eval_accuracy': 0.955647340384467, 'eval_runtime': 4.6635, 'eval_samples_per_second': 328.296, 'eval_steps_per_second': 41.171, 'epoch': 3.0}
{'loss': 0.0911, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': 0.14706064760684967, 'eval_precision': 0.5241157556270096, 'eval_recall': 0.5575826681870011, 'eval_f1': 0.5403314917127071, 'eval_accuracy': 0.9542963020149772, 'eval_runtime': 4.6644, 'eval_samples_per_second': 328.228, 'eval_steps_per_second': 41.162, 'epoch': 4.0}
{'loss': 0.0696, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': 0.15417803823947906, 'eval_precision': 0.4979166666666667, 'eval_recall': 0.5450399087799316, 'eval_f1': 0.5204137180185084, 'eval_accuracy': 0.9527136570678607, 'eval_runtime': 4.6665, 'eval_samples_per_second': 328.082, 'eval_steps_per_second': 41.144, 'epoch': 5.0}
{'loss': 0.0544, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': 0.1663065105676651, 'eval_precision': 0.5223068552774756, 'eval_recall': 0.5473204104903079, 'eval_f1': 0.534521158129176, 'eval_accuracy': 0.954798116266502, 'eval_runtime': 4.6601, 'eval_samples_per_second': 328.537, 'eval_steps_per_second': 41.201, 'epoch': 6.0}
{'loss': 0.0439, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': 0.17919780313968658, 'eval_precision': 0.46798917944093776, 'eval_recall': 0.5917901938426454, 'eval_f1': 0.5226586102719033, 'eval_accuracy': 0.9500887825214236, 'eval_runtime': 4.6725, 'eval_samples_per_second': 327.661, 'eval_steps_per_second': 41.091, 'epoch': 7.0}
{'loss': 0.0361, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': 0.18477825820446014, 'eval_precision': 0.5055055055055055, 'eval_recall': 0.5758266818700114, 'eval_f1': 0.5383795309168443, 'eval_accuracy': 0.9538330888597236, 'eval_runtime': 4.664, 'eval_samples_per_second': 328.26, 'eval_steps_per_second': 41.167, 'epoch': 8.0}
{'loss': 0.0291, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': 0.19637644290924072, 'eval_precision': 0.4980430528375734, 'eval_recall': 0.580387685290764, 'eval_f1': 0.5360716166403371, 'eval_accuracy': 0.9527522581641319, 'eval_runtime': 4.661, 'eval_samples_per_second': 328.469, 'eval_steps_per_second': 41.193, 'epoch': 9.0}
{'loss': 0.0242, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': 0.2127441018819809, 'eval_precision': 0.4924385633270321, 'eval_recall': 0.5940706955530216, 'eval_f1': 0.538501291989664, 'eval_accuracy': 0.9533312746081989, 'eval_runtime': 4.6667, 'eval_samples_per_second': 328.072, 'eval_steps_per_second': 41.143, 'epoch': 10.0}
{'loss': 0.0205, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': 0.2231123149394989, 'eval_precision': 0.5055055055055055, 'eval_recall': 0.5758266818700114, 'eval_f1': 0.5383795309168443, 'eval_accuracy': 0.9529838647417587, 'eval_runtime': 4.6705, 'eval_samples_per_second': 327.805, 'eval_steps_per_second': 41.109, 'epoch': 11.0}
{'loss': 0.017, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': 0.23946259915828705, 'eval_precision': 0.5106837606837606, 'eval_recall': 0.5450399087799316, 'eval_f1': 0.5273028130170987, 'eval_accuracy': 0.9539874932448081, 'eval_runtime': 4.7108, 'eval_samples_per_second': 324.996, 'eval_steps_per_second': 40.757, 'epoch': 12.0}
{'loss': 0.0143, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': 0.24130569398403168, 'eval_precision': 0.5190677966101694, 'eval_recall': 0.5587229190421893, 'eval_f1': 0.5381658429434376, 'eval_accuracy': 0.9547209140739596, 'eval_runtime': 4.6796, 'eval_samples_per_second': 327.164, 'eval_steps_per_second': 41.029, 'epoch': 13.0}
{'loss': 0.0122, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': 0.2575514614582062, 'eval_precision': 0.5133744855967078, 'eval_recall': 0.5689851767388826, 'eval_f1': 0.539751216873986, 'eval_accuracy': 0.9542190998224349, 'eval_runtime': 4.6687, 'eval_samples_per_second': 327.93, 'eval_steps_per_second': 41.125, 'epoch': 14.0}
{'loss': 0.0105, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': 0.25844141840934753, 'eval_precision': 0.4946236559139785, 'eval_recall': 0.5769669327251995, 'eval_f1': 0.5326315789473685, 'eval_accuracy': 0.9532926735119277, 'eval_runtime': 4.6545, 'eval_samples_per_second': 328.929, 'eval_steps_per_second': 41.25, 'epoch': 15.0}
{'loss': 0.0095, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': 0.26672372221946716, 'eval_precision': 0.4916420845624385, 'eval_recall': 0.5701254275940707, 'eval_f1': 0.5279831045406546, 'eval_accuracy': 0.9536014822820968, 'eval_runtime': 4.6637, 'eval_samples_per_second': 328.281, 'eval_steps_per_second': 41.169, 'epoch': 16.0}
{'loss': 0.0085, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': 0.2724124491214752, 'eval_precision': 0.5020618556701031, 'eval_recall': 0.5553021664766249, 'eval_f1': 0.52734163508392, 'eval_accuracy': 0.9541418976298927, 'eval_runtime': 4.6574, 'eval_samples_per_second': 328.723, 'eval_steps_per_second': 41.225, 'epoch': 17.0}
{'loss': 0.0083, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': 0.27072009444236755, 'eval_precision': 0.5051020408163265, 'eval_recall': 0.56442417331813, 'eval_f1': 0.5331179321486267, 'eval_accuracy': 0.9538330888597236, 'eval_runtime': 4.6519, 'eval_samples_per_second': 329.116, 'eval_steps_per_second': 41.274, 'epoch': 18.0}
{'loss': 0.0073, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': 0.27804455161094666, 'eval_precision': 0.509926854754441, 'eval_recall': 0.556442417331813, 'eval_f1': 0.5321701199563796, 'eval_accuracy': 0.9540260943410793, 'eval_runtime': 4.6613, 'eval_samples_per_second': 328.45, 'eval_steps_per_second': 41.19, 'epoch': 19.0}
{'loss': 0.007, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.2768690586090088, 'eval_precision': 0.5104166666666666, 'eval_recall': 0.5587229190421893, 'eval_f1': 0.5334784975503538, 'eval_accuracy': 0.9542577009187061, 'eval_runtime': 4.7371, 'eval_samples_per_second': 323.193, 'eval_steps_per_second': 40.531, 'epoch': 20.0}
{'train_runtime': 1747.326, 'train_samples_per_second': 98.825, 'train_steps_per_second': 1.545, 'train_loss': 0.0504475055359028, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.0504
  train_runtime            = 0:29:07.32
  train_samples            =       8634
  train_samples_per_second =     98.825
  train_steps_per_second   =      1.545
[{'loss': 0.2739, 'learning_rate': 9.5e-06, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.16601088643074036, 'eval_precision': 0.3716012084592145, 'eval_recall': 0.4207525655644242, 'eval_f1': 0.3946524064171123, 'eval_accuracy': 0.9455724542577009, 'eval_runtime': 4.7001, 'eval_samples_per_second': 325.74, 'eval_steps_per_second': 40.851, 'epoch': 1.0, 'step': 135}, {'loss': 0.1531, 'learning_rate': 9e-06, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.1395009458065033, 'eval_precision': 0.5168408826945412, 'eval_recall': 0.507411630558723, 'eval_f1': 0.5120828538550058, 'eval_accuracy': 0.9532154713193854, 'eval_runtime': 4.6858, 'eval_samples_per_second': 326.735, 'eval_steps_per_second': 40.975, 'epoch': 2.0, 'step': 270}, {'loss': 0.1184, 'learning_rate': 8.5e-06, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.14003601670265198, 'eval_precision': 0.5694050991501416, 'eval_recall': 0.4583808437856328, 'eval_f1': 0.5078963992419455, 'eval_accuracy': 0.955647340384467, 'eval_runtime': 4.6635, 'eval_samples_per_second': 328.296, 'eval_steps_per_second': 41.171, 'epoch': 3.0, 'step': 405}, {'loss': 0.0911, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.14706064760684967, 'eval_precision': 0.5241157556270096, 'eval_recall': 0.5575826681870011, 'eval_f1': 0.5403314917127071, 'eval_accuracy': 0.9542963020149772, 'eval_runtime': 4.6644, 'eval_samples_per_second': 328.228, 'eval_steps_per_second': 41.162, 'epoch': 4.0, 'step': 540}, {'loss': 0.0696, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.15417803823947906, 'eval_precision': 0.4979166666666667, 'eval_recall': 0.5450399087799316, 'eval_f1': 0.5204137180185084, 'eval_accuracy': 0.9527136570678607, 'eval_runtime': 4.6665, 'eval_samples_per_second': 328.082, 'eval_steps_per_second': 41.144, 'epoch': 5.0, 'step': 675}, {'loss': 0.0544, 'learning_rate': 7e-06, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.1663065105676651, 'eval_precision': 0.5223068552774756, 'eval_recall': 0.5473204104903079, 'eval_f1': 0.534521158129176, 'eval_accuracy': 0.954798116266502, 'eval_runtime': 4.6601, 'eval_samples_per_second': 328.537, 'eval_steps_per_second': 41.201, 'epoch': 6.0, 'step': 810}, {'loss': 0.0439, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.17919780313968658, 'eval_precision': 0.46798917944093776, 'eval_recall': 0.5917901938426454, 'eval_f1': 0.5226586102719033, 'eval_accuracy': 0.9500887825214236, 'eval_runtime': 4.6725, 'eval_samples_per_second': 327.661, 'eval_steps_per_second': 41.091, 'epoch': 7.0, 'step': 945}, {'loss': 0.0361, 'learning_rate': 6e-06, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.18477825820446014, 'eval_precision': 0.5055055055055055, 'eval_recall': 0.5758266818700114, 'eval_f1': 0.5383795309168443, 'eval_accuracy': 0.9538330888597236, 'eval_runtime': 4.664, 'eval_samples_per_second': 328.26, 'eval_steps_per_second': 41.167, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0291, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.19637644290924072, 'eval_precision': 0.4980430528375734, 'eval_recall': 0.580387685290764, 'eval_f1': 0.5360716166403371, 'eval_accuracy': 0.9527522581641319, 'eval_runtime': 4.661, 'eval_samples_per_second': 328.469, 'eval_steps_per_second': 41.193, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0242, 'learning_rate': 5e-06, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.2127441018819809, 'eval_precision': 0.4924385633270321, 'eval_recall': 0.5940706955530216, 'eval_f1': 0.538501291989664, 'eval_accuracy': 0.9533312746081989, 'eval_runtime': 4.6667, 'eval_samples_per_second': 328.072, 'eval_steps_per_second': 41.143, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0205, 'learning_rate': 4.5e-06, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.2231123149394989, 'eval_precision': 0.5055055055055055, 'eval_recall': 0.5758266818700114, 'eval_f1': 0.5383795309168443, 'eval_accuracy': 0.9529838647417587, 'eval_runtime': 4.6705, 'eval_samples_per_second': 327.805, 'eval_steps_per_second': 41.109, 'epoch': 11.0, 'step': 1485}, {'loss': 0.017, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.23946259915828705, 'eval_precision': 0.5106837606837606, 'eval_recall': 0.5450399087799316, 'eval_f1': 0.5273028130170987, 'eval_accuracy': 0.9539874932448081, 'eval_runtime': 4.7108, 'eval_samples_per_second': 324.996, 'eval_steps_per_second': 40.757, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0143, 'learning_rate': 3.5e-06, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.24130569398403168, 'eval_precision': 0.5190677966101694, 'eval_recall': 0.5587229190421893, 'eval_f1': 0.5381658429434376, 'eval_accuracy': 0.9547209140739596, 'eval_runtime': 4.6796, 'eval_samples_per_second': 327.164, 'eval_steps_per_second': 41.029, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0122, 'learning_rate': 3e-06, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.2575514614582062, 'eval_precision': 0.5133744855967078, 'eval_recall': 0.5689851767388826, 'eval_f1': 0.539751216873986, 'eval_accuracy': 0.9542190998224349, 'eval_runtime': 4.6687, 'eval_samples_per_second': 327.93, 'eval_steps_per_second': 41.125, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0105, 'learning_rate': 2.5e-06, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.25844141840934753, 'eval_precision': 0.4946236559139785, 'eval_recall': 0.5769669327251995, 'eval_f1': 0.5326315789473685, 'eval_accuracy': 0.9532926735119277, 'eval_runtime': 4.6545, 'eval_samples_per_second': 328.929, 'eval_steps_per_second': 41.25, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0095, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.26672372221946716, 'eval_precision': 0.4916420845624385, 'eval_recall': 0.5701254275940707, 'eval_f1': 0.5279831045406546, 'eval_accuracy': 0.9536014822820968, 'eval_runtime': 4.6637, 'eval_samples_per_second': 328.281, 'eval_steps_per_second': 41.169, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0085, 'learning_rate': 1.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.2724124491214752, 'eval_precision': 0.5020618556701031, 'eval_recall': 0.5553021664766249, 'eval_f1': 0.52734163508392, 'eval_accuracy': 0.9541418976298927, 'eval_runtime': 4.6574, 'eval_samples_per_second': 328.723, 'eval_steps_per_second': 41.225, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0083, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.27072009444236755, 'eval_precision': 0.5051020408163265, 'eval_recall': 0.56442417331813, 'eval_f1': 0.5331179321486267, 'eval_accuracy': 0.9538330888597236, 'eval_runtime': 4.6519, 'eval_samples_per_second': 329.116, 'eval_steps_per_second': 41.274, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0073, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.27804455161094666, 'eval_precision': 0.509926854754441, 'eval_recall': 0.556442417331813, 'eval_f1': 0.5321701199563796, 'eval_accuracy': 0.9540260943410793, 'eval_runtime': 4.6613, 'eval_samples_per_second': 328.45, 'eval_steps_per_second': 41.19, 'epoch': 19.0, 'step': 2565}, {'loss': 0.007, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.2768690586090088, 'eval_precision': 0.5104166666666666, 'eval_recall': 0.5587229190421893, 'eval_f1': 0.5334784975503538, 'eval_accuracy': 0.9542577009187061, 'eval_runtime': 4.7371, 'eval_samples_per_second': 323.193, 'eval_steps_per_second': 40.531, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 1747.326, 'train_samples_per_second': 98.825, 'train_steps_per_second': 1.545, 'total_flos': 2.164333754205036e+16, 'train_loss': 0.0504475055359028, 'epoch': 20.0, 'step': 2700}]

Evaluation, NbAiLab/nb-bert-large
***** predict metrics *****
  predict_accuracy           =     0.9515
  predict_f1                 =     0.4838
  predict_loss               =     0.1448
  predict_precision          =     0.4889
  predict_recall             =     0.4789
  predict_runtime            = 0:00:03.92
  predict_samples_per_second =    324.209
  predict_steps_per_second   =     40.526
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_12.json completed. F1: 0.48384879725085905
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_13.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_13.json
01150927_tsa-bin_NorBERT_3_large Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6271.28 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6940.38 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6792.78 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6877.20 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6949.34 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7073.50 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:00<00:00, 7212.36 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6322.30 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6709.09 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7203.59 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6878.83 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7013.62 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6835.91 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_large Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8075, 'eval_samples_per_second': 263.626, 'eval_steps_per_second': 33.061, 'epoch': 1.0}
{'loss': 0.0, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7707, 'eval_samples_per_second': 265.307, 'eval_steps_per_second': 33.272, 'epoch': 2.0}
{'loss': 0.0, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.772, 'eval_samples_per_second': 265.245, 'eval_steps_per_second': 33.264, 'epoch': 3.0}
{'loss': 0.0, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.918, 'eval_samples_per_second': 258.703, 'eval_steps_per_second': 32.444, 'epoch': 4.0}
{'loss': 0.0, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7719, 'eval_samples_per_second': 265.25, 'eval_steps_per_second': 33.265, 'epoch': 5.0}
{'loss': 0.0, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7593, 'eval_samples_per_second': 265.829, 'eval_steps_per_second': 33.337, 'epoch': 6.0}
{'loss': 0.0, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7636, 'eval_samples_per_second': 265.632, 'eval_steps_per_second': 33.312, 'epoch': 7.0}
{'loss': 0.0, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7566, 'eval_samples_per_second': 265.954, 'eval_steps_per_second': 33.353, 'epoch': 8.0}
{'loss': 0.0, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8297, 'eval_samples_per_second': 262.619, 'eval_steps_per_second': 32.935, 'epoch': 9.0}
{'loss': 0.0, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8037, 'eval_samples_per_second': 263.798, 'eval_steps_per_second': 33.082, 'epoch': 10.0}
{'loss': 0.0, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7924, 'eval_samples_per_second': 264.31, 'eval_steps_per_second': 33.147, 'epoch': 11.0}
{'loss': 0.0, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7597, 'eval_samples_per_second': 265.814, 'eval_steps_per_second': 33.335, 'epoch': 12.0}
{'loss': 0.0, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7521, 'eval_samples_per_second': 266.165, 'eval_steps_per_second': 33.379, 'epoch': 13.0}
{'loss': 0.0, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7631, 'eval_samples_per_second': 265.655, 'eval_steps_per_second': 33.315, 'epoch': 14.0}
{'loss': 0.0, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7589, 'eval_samples_per_second': 265.847, 'eval_steps_per_second': 33.339, 'epoch': 15.0}
{'loss': 0.0, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7734, 'eval_samples_per_second': 265.182, 'eval_steps_per_second': 33.256, 'epoch': 16.0}
{'loss': 0.0, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7656, 'eval_samples_per_second': 265.54, 'eval_steps_per_second': 33.301, 'epoch': 17.0}
{'loss': 0.0, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.757, 'eval_samples_per_second': 265.937, 'eval_steps_per_second': 33.351, 'epoch': 18.0}
{'loss': 0.0, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7585, 'eval_samples_per_second': 265.87, 'eval_steps_per_second': 33.342, 'epoch': 19.0}
{'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7476, 'eval_samples_per_second': 266.373, 'eval_steps_per_second': 33.405, 'epoch': 20.0}
{'train_runtime': 2025.4069, 'train_samples_per_second': 85.257, 'train_steps_per_second': 1.333, 'train_loss': 0.0, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =        0.0
  train_runtime            = 0:33:45.40
  train_samples            =       8634
  train_samples_per_second =     85.257
  train_steps_per_second   =      1.333
[{'loss': 0.0, 'learning_rate': 9.5e-06, 'epoch': 1.0, 'step': 135}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8075, 'eval_samples_per_second': 263.626, 'eval_steps_per_second': 33.061, 'epoch': 1.0, 'step': 135}, {'loss': 0.0, 'learning_rate': 9e-06, 'epoch': 2.0, 'step': 270}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7707, 'eval_samples_per_second': 265.307, 'eval_steps_per_second': 33.272, 'epoch': 2.0, 'step': 270}, {'loss': 0.0, 'learning_rate': 8.5e-06, 'epoch': 3.0, 'step': 405}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.772, 'eval_samples_per_second': 265.245, 'eval_steps_per_second': 33.264, 'epoch': 3.0, 'step': 405}, {'loss': 0.0, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0, 'step': 540}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.918, 'eval_samples_per_second': 258.703, 'eval_steps_per_second': 32.444, 'epoch': 4.0, 'step': 540}, {'loss': 0.0, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0, 'step': 675}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7719, 'eval_samples_per_second': 265.25, 'eval_steps_per_second': 33.265, 'epoch': 5.0, 'step': 675}, {'loss': 0.0, 'learning_rate': 7e-06, 'epoch': 6.0, 'step': 810}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7593, 'eval_samples_per_second': 265.829, 'eval_steps_per_second': 33.337, 'epoch': 6.0, 'step': 810}, {'loss': 0.0, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0, 'step': 945}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7636, 'eval_samples_per_second': 265.632, 'eval_steps_per_second': 33.312, 'epoch': 7.0, 'step': 945}, {'loss': 0.0, 'learning_rate': 6e-06, 'epoch': 8.0, 'step': 1080}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7566, 'eval_samples_per_second': 265.954, 'eval_steps_per_second': 33.353, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0, 'step': 1215}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8297, 'eval_samples_per_second': 262.619, 'eval_steps_per_second': 32.935, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0, 'learning_rate': 5e-06, 'epoch': 10.0, 'step': 1350}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.8037, 'eval_samples_per_second': 263.798, 'eval_steps_per_second': 33.082, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0, 'learning_rate': 4.5e-06, 'epoch': 11.0, 'step': 1485}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7924, 'eval_samples_per_second': 264.31, 'eval_steps_per_second': 33.147, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0, 'step': 1620}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7597, 'eval_samples_per_second': 265.814, 'eval_steps_per_second': 33.335, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0, 'learning_rate': 3.5e-06, 'epoch': 13.0, 'step': 1755}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7521, 'eval_samples_per_second': 266.165, 'eval_steps_per_second': 33.379, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0, 'learning_rate': 3e-06, 'epoch': 14.0, 'step': 1890}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7631, 'eval_samples_per_second': 265.655, 'eval_steps_per_second': 33.315, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0, 'learning_rate': 2.5e-06, 'epoch': 15.0, 'step': 2025}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7589, 'eval_samples_per_second': 265.847, 'eval_steps_per_second': 33.339, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0, 'step': 2160}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7734, 'eval_samples_per_second': 265.182, 'eval_steps_per_second': 33.256, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0, 'learning_rate': 1.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7656, 'eval_samples_per_second': 265.54, 'eval_steps_per_second': 33.301, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.757, 'eval_samples_per_second': 265.937, 'eval_steps_per_second': 33.351, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0, 'step': 2565}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7585, 'eval_samples_per_second': 265.87, 'eval_steps_per_second': 33.342, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 5.7476, 'eval_samples_per_second': 266.373, 'eval_steps_per_second': 33.405, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 2025.4069, 'train_samples_per_second': 85.257, 'train_steps_per_second': 1.333, 'total_flos': 2.253072487096051e+16, 'train_loss': 0.0, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9327
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.93
  predict_samples_per_second =    257.528
  predict_steps_per_second   =     32.191
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_large_13.json completed. F1: 0.0
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_05.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Some weights of BertForTokenClassification were not initialized from the model checkpoint at NbAiLab/nb-bert-large and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_05.json
01150927_tsa-bin_NB-BERT_large Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5926.39 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:00, 6781.30 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6805.97 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6945.98 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 7027.39 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 7181.84 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 6332.75 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6681.68 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6765.21 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7436.49 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 7053.68 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 7061.91 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6914.06 examples/s]
You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
01150927_tsa-bin_NB-BERT_large Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.2119, 'learning_rate': 4.75e-05, 'epoch': 1.0}
{'eval_loss': 0.1423846334218979, 'eval_precision': 0.43836886005560705, 'eval_recall': 0.5393386545039909, 'eval_f1': 0.483640081799591, 'eval_accuracy': 0.9499343781363391, 'eval_runtime': 5.0286, 'eval_samples_per_second': 304.46, 'eval_steps_per_second': 38.182, 'epoch': 1.0}
{'loss': 0.1185, 'learning_rate': 4.5e-05, 'epoch': 2.0}
{'eval_loss': 0.15007998049259186, 'eval_precision': 0.42812254516889237, 'eval_recall': 0.621436716077537, 'eval_f1': 0.5069767441860465, 'eval_accuracy': 0.9451092411024473, 'eval_runtime': 4.6852, 'eval_samples_per_second': 326.777, 'eval_steps_per_second': 40.98, 'epoch': 2.0}
{'loss': 0.0679, 'learning_rate': 4.25e-05, 'epoch': 3.0}
{'eval_loss': 0.14472633600234985, 'eval_precision': 0.5150259067357513, 'eval_recall': 0.5667046750285063, 'eval_f1': 0.5396308360477743, 'eval_accuracy': 0.9554929359993823, 'eval_runtime': 4.6778, 'eval_samples_per_second': 327.289, 'eval_steps_per_second': 41.045, 'epoch': 3.0}
{'loss': 0.0373, 'learning_rate': 4e-05, 'epoch': 4.0}
{'eval_loss': 0.18044300377368927, 'eval_precision': 0.5489467162329615, 'eval_recall': 0.5051311288483467, 'eval_f1': 0.5261282660332542, 'eval_accuracy': 0.9566895699837875, 'eval_runtime': 4.6861, 'eval_samples_per_second': 326.712, 'eval_steps_per_second': 40.972, 'epoch': 4.0}
{'loss': 0.0199, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0}
{'eval_loss': 0.20805823802947998, 'eval_precision': 0.529923830250272, 'eval_recall': 0.5553021664766249, 'eval_f1': 0.542316258351893, 'eval_accuracy': 0.956226356828534, 'eval_runtime': 4.7025, 'eval_samples_per_second': 325.57, 'eval_steps_per_second': 40.829, 'epoch': 5.0}
{'loss': 0.0115, 'learning_rate': 3.5e-05, 'epoch': 6.0}
{'eval_loss': 0.2307998239994049, 'eval_precision': 0.4781021897810219, 'eval_recall': 0.5974914481185861, 'eval_f1': 0.5311708058793716, 'eval_accuracy': 0.951362618698371, 'eval_runtime': 4.7022, 'eval_samples_per_second': 325.592, 'eval_steps_per_second': 40.832, 'epoch': 6.0}
{'loss': 0.007, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0}
{'eval_loss': 0.2532998025417328, 'eval_precision': 0.4837117472852912, 'eval_recall': 0.5587229190421893, 'eval_f1': 0.5185185185185186, 'eval_accuracy': 0.9517100285648112, 'eval_runtime': 4.689, 'eval_samples_per_second': 326.512, 'eval_steps_per_second': 40.947, 'epoch': 7.0}
{'loss': 0.0045, 'learning_rate': 3e-05, 'epoch': 8.0}
{'eval_loss': 0.26930108666419983, 'eval_precision': 0.521978021978022, 'eval_recall': 0.5416191562143672, 'eval_f1': 0.531617235590375, 'eval_accuracy': 0.9543349031112484, 'eval_runtime': 4.6825, 'eval_samples_per_second': 326.96, 'eval_steps_per_second': 41.003, 'epoch': 8.0}
{'loss': 0.0036, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0}
{'eval_loss': 0.2617715895175934, 'eval_precision': 0.5308370044052864, 'eval_recall': 0.5496009122006842, 'eval_f1': 0.5400560224089637, 'eval_accuracy': 0.9561105535397205, 'eval_runtime': 4.7094, 'eval_samples_per_second': 325.097, 'eval_steps_per_second': 40.77, 'epoch': 9.0}
{'loss': 0.0027, 'learning_rate': 2.5e-05, 'epoch': 10.0}
{'eval_loss': 0.2890683114528656, 'eval_precision': 0.5382775119617225, 'eval_recall': 0.5131128848346637, 'eval_f1': 0.5253940455341507, 'eval_accuracy': 0.9554157338068401, 'eval_runtime': 4.6837, 'eval_samples_per_second': 326.875, 'eval_steps_per_second': 40.993, 'epoch': 10.0}
{'loss': 0.0019, 'learning_rate': 2.25e-05, 'epoch': 11.0}
{'eval_loss': 0.28797832131385803, 'eval_precision': 0.502053388090349, 'eval_recall': 0.5575826681870011, 'eval_f1': 0.5283630470016207, 'eval_accuracy': 0.9546437118814174, 'eval_runtime': 4.6816, 'eval_samples_per_second': 327.026, 'eval_steps_per_second': 41.012, 'epoch': 11.0}
{'loss': 0.0015, 'learning_rate': 2e-05, 'epoch': 12.0}
{'eval_loss': 0.3018951714038849, 'eval_precision': 0.5060728744939271, 'eval_recall': 0.5701254275940707, 'eval_f1': 0.5361930294906165, 'eval_accuracy': 0.9532154713193854, 'eval_runtime': 4.6835, 'eval_samples_per_second': 326.893, 'eval_steps_per_second': 40.995, 'epoch': 12.0}
{'loss': 0.0014, 'learning_rate': 1.75e-05, 'epoch': 13.0}
{'eval_loss': 0.3117445409297943, 'eval_precision': 0.49506903353057197, 'eval_recall': 0.572405929304447, 'eval_f1': 0.5309360126916974, 'eval_accuracy': 0.9543349031112484, 'eval_runtime': 4.6842, 'eval_samples_per_second': 326.841, 'eval_steps_per_second': 40.989, 'epoch': 13.0}
{'loss': 0.0006, 'learning_rate': 1.5e-05, 'epoch': 14.0}
{'eval_loss': 0.32801467180252075, 'eval_precision': 0.524644030668127, 'eval_recall': 0.5461801596351197, 'eval_f1': 0.535195530726257, 'eval_accuracy': 0.9564193623098896, 'eval_runtime': 4.6836, 'eval_samples_per_second': 326.888, 'eval_steps_per_second': 40.994, 'epoch': 14.0}
{'loss': 0.0005, 'learning_rate': 1.25e-05, 'epoch': 15.0}
{'eval_loss': 0.333962082862854, 'eval_precision': 0.5267175572519084, 'eval_recall': 0.5507411630558723, 'eval_f1': 0.5384615384615384, 'eval_accuracy': 0.9569983787539567, 'eval_runtime': 4.6796, 'eval_samples_per_second': 327.168, 'eval_steps_per_second': 41.03, 'epoch': 15.0}
{'loss': 0.0004, 'learning_rate': 1e-05, 'epoch': 16.0}
{'eval_loss': 0.33578795194625854, 'eval_precision': 0.5266594124047879, 'eval_recall': 0.5518814139110604, 'eval_f1': 0.5389755011135857, 'eval_accuracy': 0.9565737666949742, 'eval_runtime': 4.6904, 'eval_samples_per_second': 326.41, 'eval_steps_per_second': 40.934, 'epoch': 16.0}
{'loss': 0.0007, 'learning_rate': 7.5e-06, 'epoch': 17.0}
{'eval_loss': 0.3406176269054413, 'eval_precision': 0.5301204819277109, 'eval_recall': 0.5518814139110604, 'eval_f1': 0.5407821229050279, 'eval_accuracy': 0.9570369798502277, 'eval_runtime': 4.6889, 'eval_samples_per_second': 326.517, 'eval_steps_per_second': 40.948, 'epoch': 17.0}
{'loss': 0.0003, 'learning_rate': 5e-06, 'epoch': 18.0}
{'eval_loss': 0.3485542833805084, 'eval_precision': 0.525330396475771, 'eval_recall': 0.5438996579247435, 'eval_f1': 0.534453781512605, 'eval_accuracy': 0.956843974368872, 'eval_runtime': 4.6798, 'eval_samples_per_second': 327.153, 'eval_steps_per_second': 41.028, 'epoch': 18.0}
{'loss': 0.0003, 'learning_rate': 2.5e-06, 'epoch': 19.0}
{'eval_loss': 0.3502871096134186, 'eval_precision': 0.5313199105145414, 'eval_recall': 0.5416191562143672, 'eval_f1': 0.536420101637493, 'eval_accuracy': 0.9567667721763298, 'eval_runtime': 4.6807, 'eval_samples_per_second': 327.088, 'eval_steps_per_second': 41.019, 'epoch': 19.0}
{'loss': 0.0002, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.3498607575893402, 'eval_precision': 0.5328142380422692, 'eval_recall': 0.5461801596351197, 'eval_f1': 0.5394144144144144, 'eval_accuracy': 0.9569211765614144, 'eval_runtime': 4.7592, 'eval_samples_per_second': 321.696, 'eval_steps_per_second': 40.343, 'epoch': 20.0}
{'train_runtime': 1751.702, 'train_samples_per_second': 98.578, 'train_steps_per_second': 1.541, 'train_loss': 0.024627774288808857, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.0246
  train_runtime            = 0:29:11.70
  train_samples            =       8634
  train_samples_per_second =     98.578
  train_steps_per_second   =      1.541
[{'loss': 0.2119, 'learning_rate': 4.75e-05, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.1423846334218979, 'eval_precision': 0.43836886005560705, 'eval_recall': 0.5393386545039909, 'eval_f1': 0.483640081799591, 'eval_accuracy': 0.9499343781363391, 'eval_runtime': 5.0286, 'eval_samples_per_second': 304.46, 'eval_steps_per_second': 38.182, 'epoch': 1.0, 'step': 135}, {'loss': 0.1185, 'learning_rate': 4.5e-05, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.15007998049259186, 'eval_precision': 0.42812254516889237, 'eval_recall': 0.621436716077537, 'eval_f1': 0.5069767441860465, 'eval_accuracy': 0.9451092411024473, 'eval_runtime': 4.6852, 'eval_samples_per_second': 326.777, 'eval_steps_per_second': 40.98, 'epoch': 2.0, 'step': 270}, {'loss': 0.0679, 'learning_rate': 4.25e-05, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.14472633600234985, 'eval_precision': 0.5150259067357513, 'eval_recall': 0.5667046750285063, 'eval_f1': 0.5396308360477743, 'eval_accuracy': 0.9554929359993823, 'eval_runtime': 4.6778, 'eval_samples_per_second': 327.289, 'eval_steps_per_second': 41.045, 'epoch': 3.0, 'step': 405}, {'loss': 0.0373, 'learning_rate': 4e-05, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.18044300377368927, 'eval_precision': 0.5489467162329615, 'eval_recall': 0.5051311288483467, 'eval_f1': 0.5261282660332542, 'eval_accuracy': 0.9566895699837875, 'eval_runtime': 4.6861, 'eval_samples_per_second': 326.712, 'eval_steps_per_second': 40.972, 'epoch': 4.0, 'step': 540}, {'loss': 0.0199, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.20805823802947998, 'eval_precision': 0.529923830250272, 'eval_recall': 0.5553021664766249, 'eval_f1': 0.542316258351893, 'eval_accuracy': 0.956226356828534, 'eval_runtime': 4.7025, 'eval_samples_per_second': 325.57, 'eval_steps_per_second': 40.829, 'epoch': 5.0, 'step': 675}, {'loss': 0.0115, 'learning_rate': 3.5e-05, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.2307998239994049, 'eval_precision': 0.4781021897810219, 'eval_recall': 0.5974914481185861, 'eval_f1': 0.5311708058793716, 'eval_accuracy': 0.951362618698371, 'eval_runtime': 4.7022, 'eval_samples_per_second': 325.592, 'eval_steps_per_second': 40.832, 'epoch': 6.0, 'step': 810}, {'loss': 0.007, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.2532998025417328, 'eval_precision': 0.4837117472852912, 'eval_recall': 0.5587229190421893, 'eval_f1': 0.5185185185185186, 'eval_accuracy': 0.9517100285648112, 'eval_runtime': 4.689, 'eval_samples_per_second': 326.512, 'eval_steps_per_second': 40.947, 'epoch': 7.0, 'step': 945}, {'loss': 0.0045, 'learning_rate': 3e-05, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.26930108666419983, 'eval_precision': 0.521978021978022, 'eval_recall': 0.5416191562143672, 'eval_f1': 0.531617235590375, 'eval_accuracy': 0.9543349031112484, 'eval_runtime': 4.6825, 'eval_samples_per_second': 326.96, 'eval_steps_per_second': 41.003, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0036, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.2617715895175934, 'eval_precision': 0.5308370044052864, 'eval_recall': 0.5496009122006842, 'eval_f1': 0.5400560224089637, 'eval_accuracy': 0.9561105535397205, 'eval_runtime': 4.7094, 'eval_samples_per_second': 325.097, 'eval_steps_per_second': 40.77, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0027, 'learning_rate': 2.5e-05, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.2890683114528656, 'eval_precision': 0.5382775119617225, 'eval_recall': 0.5131128848346637, 'eval_f1': 0.5253940455341507, 'eval_accuracy': 0.9554157338068401, 'eval_runtime': 4.6837, 'eval_samples_per_second': 326.875, 'eval_steps_per_second': 40.993, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0019, 'learning_rate': 2.25e-05, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.28797832131385803, 'eval_precision': 0.502053388090349, 'eval_recall': 0.5575826681870011, 'eval_f1': 0.5283630470016207, 'eval_accuracy': 0.9546437118814174, 'eval_runtime': 4.6816, 'eval_samples_per_second': 327.026, 'eval_steps_per_second': 41.012, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0015, 'learning_rate': 2e-05, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.3018951714038849, 'eval_precision': 0.5060728744939271, 'eval_recall': 0.5701254275940707, 'eval_f1': 0.5361930294906165, 'eval_accuracy': 0.9532154713193854, 'eval_runtime': 4.6835, 'eval_samples_per_second': 326.893, 'eval_steps_per_second': 40.995, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0014, 'learning_rate': 1.75e-05, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.3117445409297943, 'eval_precision': 0.49506903353057197, 'eval_recall': 0.572405929304447, 'eval_f1': 0.5309360126916974, 'eval_accuracy': 0.9543349031112484, 'eval_runtime': 4.6842, 'eval_samples_per_second': 326.841, 'eval_steps_per_second': 40.989, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0006, 'learning_rate': 1.5e-05, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.32801467180252075, 'eval_precision': 0.524644030668127, 'eval_recall': 0.5461801596351197, 'eval_f1': 0.535195530726257, 'eval_accuracy': 0.9564193623098896, 'eval_runtime': 4.6836, 'eval_samples_per_second': 326.888, 'eval_steps_per_second': 40.994, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0005, 'learning_rate': 1.25e-05, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.333962082862854, 'eval_precision': 0.5267175572519084, 'eval_recall': 0.5507411630558723, 'eval_f1': 0.5384615384615384, 'eval_accuracy': 0.9569983787539567, 'eval_runtime': 4.6796, 'eval_samples_per_second': 327.168, 'eval_steps_per_second': 41.03, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0004, 'learning_rate': 1e-05, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.33578795194625854, 'eval_precision': 0.5266594124047879, 'eval_recall': 0.5518814139110604, 'eval_f1': 0.5389755011135857, 'eval_accuracy': 0.9565737666949742, 'eval_runtime': 4.6904, 'eval_samples_per_second': 326.41, 'eval_steps_per_second': 40.934, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0007, 'learning_rate': 7.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.3406176269054413, 'eval_precision': 0.5301204819277109, 'eval_recall': 0.5518814139110604, 'eval_f1': 0.5407821229050279, 'eval_accuracy': 0.9570369798502277, 'eval_runtime': 4.6889, 'eval_samples_per_second': 326.517, 'eval_steps_per_second': 40.948, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0003, 'learning_rate': 5e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.3485542833805084, 'eval_precision': 0.525330396475771, 'eval_recall': 0.5438996579247435, 'eval_f1': 0.534453781512605, 'eval_accuracy': 0.956843974368872, 'eval_runtime': 4.6798, 'eval_samples_per_second': 327.153, 'eval_steps_per_second': 41.028, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0003, 'learning_rate': 2.5e-06, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.3502871096134186, 'eval_precision': 0.5313199105145414, 'eval_recall': 0.5416191562143672, 'eval_f1': 0.536420101637493, 'eval_accuracy': 0.9567667721763298, 'eval_runtime': 4.6807, 'eval_samples_per_second': 327.088, 'eval_steps_per_second': 41.019, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0002, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.3498607575893402, 'eval_precision': 0.5328142380422692, 'eval_recall': 0.5461801596351197, 'eval_f1': 0.5394144144144144, 'eval_accuracy': 0.9569211765614144, 'eval_runtime': 4.7592, 'eval_samples_per_second': 321.696, 'eval_steps_per_second': 40.343, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 1751.702, 'train_samples_per_second': 98.578, 'train_steps_per_second': 1.541, 'total_flos': 2.164333754205036e+16, 'train_loss': 0.024627774288808857, 'epoch': 20.0, 'step': 2700}]

Evaluation, NbAiLab/nb-bert-large
***** predict metrics *****
  predict_accuracy           =     0.9496
  predict_f1                 =     0.4819
  predict_loss               =     0.1623
  predict_precision          =     0.4443
  predict_recall             =     0.5265
  predict_runtime            = 0:00:04.00
  predict_samples_per_second =    317.723
  predict_steps_per_second   =     39.715
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_large_05.json completed. F1: 0.4819427148194272
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_03.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Some weights of XLMRobertaForTokenClassification were not initialized from the model checkpoint at xlm-roberta-base and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_03.json
01150927_tsa-bin_XLM-R_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5713.04 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:01, 6462.65 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6405.00 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6454.17 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6486.63 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 6624.37 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 5896.23 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6226.46 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6292.30 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 6874.93 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6553.09 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 6619.65 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6237.09 examples/s]
You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
01150927_tsa-bin_XLM-R_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'attention_mask', 'labels']
{'loss': 0.2839, 'learning_rate': 4.75e-05, 'epoch': 1.0}
{'eval_loss': 0.1819896697998047, 'eval_precision': 0.3673012318029115, 'eval_recall': 0.37400228050171036, 'eval_f1': 0.3706214689265537, 'eval_accuracy': 0.9397436887207596, 'eval_runtime': 2.4247, 'eval_samples_per_second': 631.426, 'eval_steps_per_second': 79.186, 'epoch': 1.0}
{'loss': 0.1815, 'learning_rate': 4.5e-05, 'epoch': 2.0}
{'eval_loss': 0.16215524077415466, 'eval_precision': 0.4316546762589928, 'eval_recall': 0.4104903078677309, 'eval_f1': 0.42080654587960253, 'eval_accuracy': 0.9441828147919401, 'eval_runtime': 2.365, 'eval_samples_per_second': 647.345, 'eval_steps_per_second': 81.182, 'epoch': 2.0}
{'loss': 0.1376, 'learning_rate': 4.25e-05, 'epoch': 3.0}
{'eval_loss': 0.1578890085220337, 'eval_precision': 0.4860724233983287, 'eval_recall': 0.3979475484606613, 'eval_f1': 0.43761755485893417, 'eval_accuracy': 0.9492781594997298, 'eval_runtime': 2.3358, 'eval_samples_per_second': 655.438, 'eval_steps_per_second': 82.197, 'epoch': 3.0}
{'loss': 0.1028, 'learning_rate': 4e-05, 'epoch': 4.0}
{'eval_loss': 0.1767193078994751, 'eval_precision': 0.4396551724137931, 'eval_recall': 0.4652223489167617, 'eval_f1': 0.4520775623268698, 'eval_accuracy': 0.9442600169844824, 'eval_runtime': 2.3409, 'eval_samples_per_second': 654.019, 'eval_steps_per_second': 82.019, 'epoch': 4.0}
{'loss': 0.0762, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0}
{'eval_loss': 0.18791194260120392, 'eval_precision': 0.4550625711035267, 'eval_recall': 0.45610034207525657, 'eval_f1': 0.4555808656036447, 'eval_accuracy': 0.9450320389099051, 'eval_runtime': 2.3357, 'eval_samples_per_second': 655.473, 'eval_steps_per_second': 82.202, 'epoch': 5.0}
{'loss': 0.056, 'learning_rate': 3.5e-05, 'epoch': 6.0}
{'eval_loss': 0.21248239278793335, 'eval_precision': 0.44343434343434346, 'eval_recall': 0.500570125427594, 'eval_f1': 0.4702731655061596, 'eval_accuracy': 0.9436810005404154, 'eval_runtime': 2.3354, 'eval_samples_per_second': 655.562, 'eval_steps_per_second': 82.213, 'epoch': 6.0}
{'loss': 0.0426, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0}
{'eval_loss': 0.2304813712835312, 'eval_precision': 0.42913776015857286, 'eval_recall': 0.49372862029646525, 'eval_f1': 0.4591728525980912, 'eval_accuracy': 0.9417895468231298, 'eval_runtime': 2.3361, 'eval_samples_per_second': 655.374, 'eval_steps_per_second': 82.189, 'epoch': 7.0}
{'loss': 0.0307, 'learning_rate': 3e-05, 'epoch': 8.0}
{'eval_loss': 0.2483266294002533, 'eval_precision': 0.4225352112676056, 'eval_recall': 0.5131128848346637, 'eval_f1': 0.46343975283213185, 'eval_accuracy': 0.9420983555932988, 'eval_runtime': 2.3397, 'eval_samples_per_second': 654.369, 'eval_steps_per_second': 82.063, 'epoch': 8.0}
{'loss': 0.0242, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0}
{'eval_loss': 0.27203118801116943, 'eval_precision': 0.41854185418541856, 'eval_recall': 0.5302166476624858, 'eval_f1': 0.4678068410462777, 'eval_accuracy': 0.9415193391492318, 'eval_runtime': 2.4157, 'eval_samples_per_second': 633.76, 'eval_steps_per_second': 79.479, 'epoch': 9.0}
{'loss': 0.0179, 'learning_rate': 2.5e-05, 'epoch': 10.0}
{'eval_loss': 0.28701508045196533, 'eval_precision': 0.44432989690721647, 'eval_recall': 0.49144811858608894, 'eval_f1': 0.46670276123443416, 'eval_accuracy': 0.9447618312360071, 'eval_runtime': 2.3202, 'eval_samples_per_second': 659.851, 'eval_steps_per_second': 82.751, 'epoch': 10.0}
{'loss': 0.0139, 'learning_rate': 2.25e-05, 'epoch': 11.0}
{'eval_loss': 0.3188084363937378, 'eval_precision': 0.4152397260273973, 'eval_recall': 0.5530216647662486, 'eval_f1': 0.47432762836185816, 'eval_accuracy': 0.9409403227051648, 'eval_runtime': 2.3141, 'eval_samples_per_second': 661.6, 'eval_steps_per_second': 82.97, 'epoch': 11.0}
{'loss': 0.0115, 'learning_rate': 2e-05, 'epoch': 12.0}
{'eval_loss': 0.31175360083580017, 'eval_precision': 0.4315004659832246, 'eval_recall': 0.5279361459521095, 'eval_f1': 0.4748717948717948, 'eval_accuracy': 0.9425615687485525, 'eval_runtime': 2.3296, 'eval_samples_per_second': 657.189, 'eval_steps_per_second': 82.417, 'epoch': 12.0}
{'loss': 0.0098, 'learning_rate': 1.75e-05, 'epoch': 13.0}
{'eval_loss': 0.3097859025001526, 'eval_precision': 0.48135964912280704, 'eval_recall': 0.500570125427594, 'eval_f1': 0.4907769703745109, 'eval_accuracy': 0.9464988805682082, 'eval_runtime': 2.3136, 'eval_samples_per_second': 661.741, 'eval_steps_per_second': 82.988, 'epoch': 13.0}
{'loss': 0.0071, 'learning_rate': 1.5e-05, 'epoch': 14.0}
{'eval_loss': 0.3227109909057617, 'eval_precision': 0.47294372294372294, 'eval_recall': 0.4982896237172178, 'eval_f1': 0.4852859522487507, 'eval_accuracy': 0.9459198641241411, 'eval_runtime': 2.3122, 'eval_samples_per_second': 662.131, 'eval_steps_per_second': 83.037, 'epoch': 14.0}
{'loss': 0.0058, 'learning_rate': 1.25e-05, 'epoch': 15.0}
{'eval_loss': 0.3386768400669098, 'eval_precision': 0.441432720232333, 'eval_recall': 0.5199543899657925, 'eval_f1': 0.4774869109947643, 'eval_accuracy': 0.9446846290434648, 'eval_runtime': 2.3213, 'eval_samples_per_second': 659.535, 'eval_steps_per_second': 82.711, 'epoch': 15.0}
{'loss': 0.0049, 'learning_rate': 1e-05, 'epoch': 16.0}
{'eval_loss': 0.3397279381752014, 'eval_precision': 0.47671840354767187, 'eval_recall': 0.4903078677309008, 'eval_f1': 0.4834176503653738, 'eval_accuracy': 0.9471937003010885, 'eval_runtime': 2.3132, 'eval_samples_per_second': 661.866, 'eval_steps_per_second': 83.003, 'epoch': 16.0}
{'loss': 0.0037, 'learning_rate': 7.5e-06, 'epoch': 17.0}
{'eval_loss': 0.35642746090888977, 'eval_precision': 0.46464646464646464, 'eval_recall': 0.5245153933865451, 'eval_f1': 0.49276914836636315, 'eval_accuracy': 0.9452636454875318, 'eval_runtime': 2.3143, 'eval_samples_per_second': 661.538, 'eval_steps_per_second': 82.962, 'epoch': 17.0}
{'loss': 0.0033, 'learning_rate': 5e-06, 'epoch': 18.0}
{'eval_loss': 0.3599340319633484, 'eval_precision': 0.488135593220339, 'eval_recall': 0.4925883694412771, 'eval_f1': 0.4903518728717367, 'eval_accuracy': 0.9473867057824442, 'eval_runtime': 2.332, 'eval_samples_per_second': 656.527, 'eval_steps_per_second': 82.334, 'epoch': 18.0}
{'loss': 0.0025, 'learning_rate': 2.5e-06, 'epoch': 19.0}
{'eval_loss': 0.3599543273448944, 'eval_precision': 0.4700944386149003, 'eval_recall': 0.5108323831242874, 'eval_f1': 0.4896174863387978, 'eval_accuracy': 0.946190071798039, 'eval_runtime': 2.3125, 'eval_samples_per_second': 662.053, 'eval_steps_per_second': 83.027, 'epoch': 19.0}
{'loss': 0.0021, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.360655814409256, 'eval_precision': 0.4809989142236699, 'eval_recall': 0.5051311288483467, 'eval_f1': 0.492769744160178, 'eval_accuracy': 0.9470006948197329, 'eval_runtime': 2.3122, 'eval_samples_per_second': 662.142, 'eval_steps_per_second': 83.038, 'epoch': 20.0}
{'train_runtime': 707.5848, 'train_samples_per_second': 244.041, 'train_steps_per_second': 3.816, 'train_loss': 0.05090910879550157, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.0509
  train_runtime            = 0:11:47.58
  train_samples            =       8634
  train_samples_per_second =    244.041
  train_steps_per_second   =      3.816
[{'loss': 0.2839, 'learning_rate': 4.75e-05, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.1819896697998047, 'eval_precision': 0.3673012318029115, 'eval_recall': 0.37400228050171036, 'eval_f1': 0.3706214689265537, 'eval_accuracy': 0.9397436887207596, 'eval_runtime': 2.4247, 'eval_samples_per_second': 631.426, 'eval_steps_per_second': 79.186, 'epoch': 1.0, 'step': 135}, {'loss': 0.1815, 'learning_rate': 4.5e-05, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.16215524077415466, 'eval_precision': 0.4316546762589928, 'eval_recall': 0.4104903078677309, 'eval_f1': 0.42080654587960253, 'eval_accuracy': 0.9441828147919401, 'eval_runtime': 2.365, 'eval_samples_per_second': 647.345, 'eval_steps_per_second': 81.182, 'epoch': 2.0, 'step': 270}, {'loss': 0.1376, 'learning_rate': 4.25e-05, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.1578890085220337, 'eval_precision': 0.4860724233983287, 'eval_recall': 0.3979475484606613, 'eval_f1': 0.43761755485893417, 'eval_accuracy': 0.9492781594997298, 'eval_runtime': 2.3358, 'eval_samples_per_second': 655.438, 'eval_steps_per_second': 82.197, 'epoch': 3.0, 'step': 405}, {'loss': 0.1028, 'learning_rate': 4e-05, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.1767193078994751, 'eval_precision': 0.4396551724137931, 'eval_recall': 0.4652223489167617, 'eval_f1': 0.4520775623268698, 'eval_accuracy': 0.9442600169844824, 'eval_runtime': 2.3409, 'eval_samples_per_second': 654.019, 'eval_steps_per_second': 82.019, 'epoch': 4.0, 'step': 540}, {'loss': 0.0762, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.18791194260120392, 'eval_precision': 0.4550625711035267, 'eval_recall': 0.45610034207525657, 'eval_f1': 0.4555808656036447, 'eval_accuracy': 0.9450320389099051, 'eval_runtime': 2.3357, 'eval_samples_per_second': 655.473, 'eval_steps_per_second': 82.202, 'epoch': 5.0, 'step': 675}, {'loss': 0.056, 'learning_rate': 3.5e-05, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.21248239278793335, 'eval_precision': 0.44343434343434346, 'eval_recall': 0.500570125427594, 'eval_f1': 0.4702731655061596, 'eval_accuracy': 0.9436810005404154, 'eval_runtime': 2.3354, 'eval_samples_per_second': 655.562, 'eval_steps_per_second': 82.213, 'epoch': 6.0, 'step': 810}, {'loss': 0.0426, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.2304813712835312, 'eval_precision': 0.42913776015857286, 'eval_recall': 0.49372862029646525, 'eval_f1': 0.4591728525980912, 'eval_accuracy': 0.9417895468231298, 'eval_runtime': 2.3361, 'eval_samples_per_second': 655.374, 'eval_steps_per_second': 82.189, 'epoch': 7.0, 'step': 945}, {'loss': 0.0307, 'learning_rate': 3e-05, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.2483266294002533, 'eval_precision': 0.4225352112676056, 'eval_recall': 0.5131128848346637, 'eval_f1': 0.46343975283213185, 'eval_accuracy': 0.9420983555932988, 'eval_runtime': 2.3397, 'eval_samples_per_second': 654.369, 'eval_steps_per_second': 82.063, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0242, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.27203118801116943, 'eval_precision': 0.41854185418541856, 'eval_recall': 0.5302166476624858, 'eval_f1': 0.4678068410462777, 'eval_accuracy': 0.9415193391492318, 'eval_runtime': 2.4157, 'eval_samples_per_second': 633.76, 'eval_steps_per_second': 79.479, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0179, 'learning_rate': 2.5e-05, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.28701508045196533, 'eval_precision': 0.44432989690721647, 'eval_recall': 0.49144811858608894, 'eval_f1': 0.46670276123443416, 'eval_accuracy': 0.9447618312360071, 'eval_runtime': 2.3202, 'eval_samples_per_second': 659.851, 'eval_steps_per_second': 82.751, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0139, 'learning_rate': 2.25e-05, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.3188084363937378, 'eval_precision': 0.4152397260273973, 'eval_recall': 0.5530216647662486, 'eval_f1': 0.47432762836185816, 'eval_accuracy': 0.9409403227051648, 'eval_runtime': 2.3141, 'eval_samples_per_second': 661.6, 'eval_steps_per_second': 82.97, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0115, 'learning_rate': 2e-05, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.31175360083580017, 'eval_precision': 0.4315004659832246, 'eval_recall': 0.5279361459521095, 'eval_f1': 0.4748717948717948, 'eval_accuracy': 0.9425615687485525, 'eval_runtime': 2.3296, 'eval_samples_per_second': 657.189, 'eval_steps_per_second': 82.417, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0098, 'learning_rate': 1.75e-05, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.3097859025001526, 'eval_precision': 0.48135964912280704, 'eval_recall': 0.500570125427594, 'eval_f1': 0.4907769703745109, 'eval_accuracy': 0.9464988805682082, 'eval_runtime': 2.3136, 'eval_samples_per_second': 661.741, 'eval_steps_per_second': 82.988, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0071, 'learning_rate': 1.5e-05, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.3227109909057617, 'eval_precision': 0.47294372294372294, 'eval_recall': 0.4982896237172178, 'eval_f1': 0.4852859522487507, 'eval_accuracy': 0.9459198641241411, 'eval_runtime': 2.3122, 'eval_samples_per_second': 662.131, 'eval_steps_per_second': 83.037, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0058, 'learning_rate': 1.25e-05, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.3386768400669098, 'eval_precision': 0.441432720232333, 'eval_recall': 0.5199543899657925, 'eval_f1': 0.4774869109947643, 'eval_accuracy': 0.9446846290434648, 'eval_runtime': 2.3213, 'eval_samples_per_second': 659.535, 'eval_steps_per_second': 82.711, 'epoch': 15.0, 'step': 2025}, {'loss': 0.0049, 'learning_rate': 1e-05, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.3397279381752014, 'eval_precision': 0.47671840354767187, 'eval_recall': 0.4903078677309008, 'eval_f1': 0.4834176503653738, 'eval_accuracy': 0.9471937003010885, 'eval_runtime': 2.3132, 'eval_samples_per_second': 661.866, 'eval_steps_per_second': 83.003, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0037, 'learning_rate': 7.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.35642746090888977, 'eval_precision': 0.46464646464646464, 'eval_recall': 0.5245153933865451, 'eval_f1': 0.49276914836636315, 'eval_accuracy': 0.9452636454875318, 'eval_runtime': 2.3143, 'eval_samples_per_second': 661.538, 'eval_steps_per_second': 82.962, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0033, 'learning_rate': 5e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.3599340319633484, 'eval_precision': 0.488135593220339, 'eval_recall': 0.4925883694412771, 'eval_f1': 0.4903518728717367, 'eval_accuracy': 0.9473867057824442, 'eval_runtime': 2.332, 'eval_samples_per_second': 656.527, 'eval_steps_per_second': 82.334, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0025, 'learning_rate': 2.5e-06, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.3599543273448944, 'eval_precision': 0.4700944386149003, 'eval_recall': 0.5108323831242874, 'eval_f1': 0.4896174863387978, 'eval_accuracy': 0.946190071798039, 'eval_runtime': 2.3125, 'eval_samples_per_second': 662.053, 'eval_steps_per_second': 83.027, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0021, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.360655814409256, 'eval_precision': 0.4809989142236699, 'eval_recall': 0.5051311288483467, 'eval_f1': 0.492769744160178, 'eval_accuracy': 0.9470006948197329, 'eval_runtime': 2.3122, 'eval_samples_per_second': 662.142, 'eval_steps_per_second': 83.038, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 707.5848, 'train_samples_per_second': 244.041, 'train_steps_per_second': 3.816, 'total_flos': 7230575408749680.0, 'train_loss': 0.05090910879550157, 'epoch': 20.0, 'step': 2700}]

Evaluation, xlm-roberta-base
***** predict metrics *****
  predict_accuracy           =     0.9489
  predict_f1                 =     0.4318
  predict_loss               =     0.1638
  predict_precision          =     0.4747
  predict_recall             =     0.3959
  predict_runtime            = 0:00:01.96
  predict_samples_per_second =    647.769
  predict_steps_per_second   =     80.971
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_03.json completed. F1: 0.4317507418397626
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_08.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_08.json
01150927_tsa-bin_NorBERT_3_small Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5969.49 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:01, 6553.04 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6468.54 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6581.23 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6645.61 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 6807.16 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 6958.72 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6978.52 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6402.72 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 6879.78 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6610.54 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 6932.69 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6774.07 examples/s]
You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NorBERT_3_small Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 5.134359196181216e+19, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0075, 'eval_samples_per_second': 509.061, 'eval_steps_per_second': 63.84, 'epoch': 1.0}
{'loss': 5.233739461958455e+19, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.1591, 'eval_samples_per_second': 484.634, 'eval_steps_per_second': 60.777, 'epoch': 2.0}
{'loss': 5.3352977185554874e+19, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0201, 'eval_samples_per_second': 506.931, 'eval_steps_per_second': 63.573, 'epoch': 3.0}
{'loss': 5.3427190669414425e+19, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.1685, 'eval_samples_per_second': 483.195, 'eval_steps_per_second': 60.597, 'epoch': 4.0}
{'loss': 5.079147983749412e+19, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0129, 'eval_samples_per_second': 508.141, 'eval_steps_per_second': 63.725, 'epoch': 5.0}
{'loss': 5.114596733816368e+19, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.1304, 'eval_samples_per_second': 489.078, 'eval_steps_per_second': 61.334, 'epoch': 6.0}
{'loss': 5.1073476064161645e+19, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0866, 'eval_samples_per_second': 496.011, 'eval_steps_per_second': 62.204, 'epoch': 7.0}
{'loss': 5.127569602742989e+19, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0711, 'eval_samples_per_second': 498.511, 'eval_steps_per_second': 62.517, 'epoch': 8.0}
{'loss': 5.2119516307611886e+19, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 2.9705, 'eval_samples_per_second': 515.399, 'eval_steps_per_second': 64.635, 'epoch': 9.0}
{'loss': 5.0805140756363805e+19, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.1394, 'eval_samples_per_second': 487.668, 'eval_steps_per_second': 61.158, 'epoch': 10.0}
{'loss': 5.076878669937175e+19, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 2.9851, 'eval_samples_per_second': 512.873, 'eval_steps_per_second': 64.318, 'epoch': 11.0}
{'loss': 4.999212009363344e+19, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 2.9746, 'eval_samples_per_second': 514.694, 'eval_steps_per_second': 64.547, 'epoch': 12.0}
{'loss': 5.243342137163926e+19, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0087, 'eval_samples_per_second': 508.852, 'eval_steps_per_second': 63.814, 'epoch': 13.0}
{'loss': 5.285154723704337e+19, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0524, 'eval_samples_per_second': 501.565, 'eval_steps_per_second': 62.9, 'epoch': 14.0}
{'loss': 5.217431010307822e+19, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0205, 'eval_samples_per_second': 506.878, 'eval_steps_per_second': 63.567, 'epoch': 15.0}
{'loss': 5.325630408355364e+19, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0009, 'eval_samples_per_second': 510.174, 'eval_steps_per_second': 63.98, 'epoch': 16.0}
{'loss': 4.994600823744875e+19, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0173, 'eval_samples_per_second': 507.399, 'eval_steps_per_second': 63.632, 'epoch': 17.0}
{'loss': 5.039932055994152e+19, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 2.9957, 'eval_samples_per_second': 511.058, 'eval_steps_per_second': 64.091, 'epoch': 18.0}
{'loss': 5.131105762450406e+19, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.014, 'eval_samples_per_second': 507.957, 'eval_steps_per_second': 63.702, 'epoch': 19.0}
{'loss': 4.969470320824182e+19, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0299, 'eval_samples_per_second': 505.293, 'eval_steps_per_second': 63.368, 'epoch': 20.0}
{'train_runtime': 344.167, 'train_samples_per_second': 501.733, 'train_steps_per_second': 7.845, 'train_loss': 5.152500049930234e+19, 'epoch': 20.0}
***** train metrics *****
  epoch                    =                  20.0
  train_loss               = 5.152500049930234e+19
  train_runtime            =            0:05:44.16
  train_samples            =                  8634
  train_samples_per_second =               501.733
  train_steps_per_second   =                 7.845
[{'loss': 5.134359196181216e+19, 'learning_rate': 9.5e-06, 'epoch': 1.0, 'step': 135}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0075, 'eval_samples_per_second': 509.061, 'eval_steps_per_second': 63.84, 'epoch': 1.0, 'step': 135}, {'loss': 5.233739461958455e+19, 'learning_rate': 9e-06, 'epoch': 2.0, 'step': 270}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.1591, 'eval_samples_per_second': 484.634, 'eval_steps_per_second': 60.777, 'epoch': 2.0, 'step': 270}, {'loss': 5.3352977185554874e+19, 'learning_rate': 8.5e-06, 'epoch': 3.0, 'step': 405}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0201, 'eval_samples_per_second': 506.931, 'eval_steps_per_second': 63.573, 'epoch': 3.0, 'step': 405}, {'loss': 5.3427190669414425e+19, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0, 'step': 540}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.1685, 'eval_samples_per_second': 483.195, 'eval_steps_per_second': 60.597, 'epoch': 4.0, 'step': 540}, {'loss': 5.079147983749412e+19, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0, 'step': 675}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0129, 'eval_samples_per_second': 508.141, 'eval_steps_per_second': 63.725, 'epoch': 5.0, 'step': 675}, {'loss': 5.114596733816368e+19, 'learning_rate': 7e-06, 'epoch': 6.0, 'step': 810}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.1304, 'eval_samples_per_second': 489.078, 'eval_steps_per_second': 61.334, 'epoch': 6.0, 'step': 810}, {'loss': 5.1073476064161645e+19, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0, 'step': 945}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0866, 'eval_samples_per_second': 496.011, 'eval_steps_per_second': 62.204, 'epoch': 7.0, 'step': 945}, {'loss': 5.127569602742989e+19, 'learning_rate': 6e-06, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0711, 'eval_samples_per_second': 498.511, 'eval_steps_per_second': 62.517, 'epoch': 8.0, 'step': 1080}, {'loss': 5.2119516307611886e+19, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 2.9705, 'eval_samples_per_second': 515.399, 'eval_steps_per_second': 64.635, 'epoch': 9.0, 'step': 1215}, {'loss': 5.0805140756363805e+19, 'learning_rate': 5e-06, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.1394, 'eval_samples_per_second': 487.668, 'eval_steps_per_second': 61.158, 'epoch': 10.0, 'step': 1350}, {'loss': 5.076878669937175e+19, 'learning_rate': 4.5e-06, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 2.9851, 'eval_samples_per_second': 512.873, 'eval_steps_per_second': 64.318, 'epoch': 11.0, 'step': 1485}, {'loss': 4.999212009363344e+19, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 2.9746, 'eval_samples_per_second': 514.694, 'eval_steps_per_second': 64.547, 'epoch': 12.0, 'step': 1620}, {'loss': 5.243342137163926e+19, 'learning_rate': 3.5e-06, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0087, 'eval_samples_per_second': 508.852, 'eval_steps_per_second': 63.814, 'epoch': 13.0, 'step': 1755}, {'loss': 5.285154723704337e+19, 'learning_rate': 3e-06, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0524, 'eval_samples_per_second': 501.565, 'eval_steps_per_second': 62.9, 'epoch': 14.0, 'step': 1890}, {'loss': 5.217431010307822e+19, 'learning_rate': 2.5e-06, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0205, 'eval_samples_per_second': 506.878, 'eval_steps_per_second': 63.567, 'epoch': 15.0, 'step': 2025}, {'loss': 5.325630408355364e+19, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0009, 'eval_samples_per_second': 510.174, 'eval_steps_per_second': 63.98, 'epoch': 16.0, 'step': 2160}, {'loss': 4.994600823744875e+19, 'learning_rate': 1.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0173, 'eval_samples_per_second': 507.399, 'eval_steps_per_second': 63.632, 'epoch': 17.0, 'step': 2295}, {'loss': 5.039932055994152e+19, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 2.9957, 'eval_samples_per_second': 511.058, 'eval_steps_per_second': 64.091, 'epoch': 18.0, 'step': 2430}, {'loss': 5.131105762450406e+19, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.014, 'eval_samples_per_second': 507.957, 'eval_steps_per_second': 63.702, 'epoch': 19.0, 'step': 2565}, {'loss': 4.969470320824182e+19, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 4.128258903191952e+19, 'eval_precision': 0.006907630522088353, 'eval_recall': 0.09806157354618016, 'eval_f1': 0.012906130411945674, 'eval_accuracy': 0.4856403921871381, 'eval_runtime': 3.0299, 'eval_samples_per_second': 505.293, 'eval_steps_per_second': 63.368, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 344.167, 'train_samples_per_second': 501.733, 'train_steps_per_second': 7.845, 'total_flos': 1592857376191872.0, 'train_loss': 5.152500049930234e+19, 'epoch': 20.0, 'step': 2700}]

Evaluation, ltg/norbert3-small
***** predict metrics *****
  predict_accuracy           =                 0.478
  predict_f1                 =                0.0119
  predict_loss               = 4.426929362151722e+19
  predict_precision          =                0.0064
  predict_recall             =                0.0925
  predict_runtime            =            0:00:02.61
  predict_samples_per_second =               485.724
  predict_steps_per_second   =                60.715
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NorBERT_3_small_08.json completed. F1: 0.01188811188811189
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_18.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Some weights of BertForTokenClassification were not initialized from the model checkpoint at NbAiLab/nb-bert-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_18.json
01150927_tsa-bin_NB-BERT_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 6651.13 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:01, 6602.11 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6585.21 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6716.72 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6781.12 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 6904.68 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 6133.13 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6477.01 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6586.37 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 7203.24 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6778.88 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 6875.64 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6695.18 examples/s]
You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_NB-BERT_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.6913, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0}
{'eval_loss': 0.31086087226867676, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.3942, 'eval_samples_per_second': 639.468, 'eval_steps_per_second': 80.195, 'epoch': 1.0}
{'loss': 0.2937, 'learning_rate': 9e-07, 'epoch': 2.0}
{'eval_loss': 0.2653428018093109, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9342623330502586, 'eval_runtime': 2.385, 'eval_samples_per_second': 641.936, 'eval_steps_per_second': 80.504, 'epoch': 2.0}
{'loss': 0.261, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0}
{'eval_loss': 0.24195420742034912, 'eval_precision': 0.1323529411764706, 'eval_recall': 0.010262257696693273, 'eval_f1': 0.019047619047619046, 'eval_accuracy': 0.9352659615533081, 'eval_runtime': 2.3996, 'eval_samples_per_second': 638.034, 'eval_steps_per_second': 80.015, 'epoch': 3.0}
{'loss': 0.2401, 'learning_rate': 8e-07, 'epoch': 4.0}
{'eval_loss': 0.22619646787643433, 'eval_precision': 0.27058823529411763, 'eval_recall': 0.052451539338654506, 'eval_f1': 0.08787010506208215, 'eval_accuracy': 0.9367714043078823, 'eval_runtime': 2.3831, 'eval_samples_per_second': 642.428, 'eval_steps_per_second': 80.566, 'epoch': 4.0}
{'loss': 0.2262, 'learning_rate': 7.5e-07, 'epoch': 5.0}
{'eval_loss': 0.21542885899543762, 'eval_precision': 0.2920962199312715, 'eval_recall': 0.09692132269099202, 'eval_f1': 0.14554794520547945, 'eval_accuracy': 0.9374662240407627, 'eval_runtime': 2.3867, 'eval_samples_per_second': 641.479, 'eval_steps_per_second': 80.447, 'epoch': 5.0}
{'loss': 0.2175, 'learning_rate': 7e-07, 'epoch': 6.0}
{'eval_loss': 0.20882628858089447, 'eval_precision': 0.3125, 'eval_recall': 0.17103762827822122, 'eval_f1': 0.22107590272660282, 'eval_accuracy': 0.9385470547363545, 'eval_runtime': 2.3875, 'eval_samples_per_second': 641.268, 'eval_steps_per_second': 80.42, 'epoch': 6.0}
{'loss': 0.2112, 'learning_rate': 6.5e-07, 'epoch': 7.0}
{'eval_loss': 0.20333485305309296, 'eval_precision': 0.33482142857142855, 'eval_recall': 0.17103762827822122, 'eval_f1': 0.22641509433962267, 'eval_accuracy': 0.9394348799505906, 'eval_runtime': 2.3865, 'eval_samples_per_second': 641.52, 'eval_steps_per_second': 80.452, 'epoch': 7.0}
{'loss': 0.2045, 'learning_rate': 6e-07, 'epoch': 8.0}
{'eval_loss': 0.1997550129890442, 'eval_precision': 0.3184931506849315, 'eval_recall': 0.2120866590649943, 'eval_f1': 0.2546201232032854, 'eval_accuracy': 0.938971666795337, 'eval_runtime': 2.398, 'eval_samples_per_second': 638.448, 'eval_steps_per_second': 80.067, 'epoch': 8.0}
{'loss': 0.1998, 'learning_rate': 5.5e-07, 'epoch': 9.0}
{'eval_loss': 0.19585438072681427, 'eval_precision': 0.3280141843971631, 'eval_recall': 0.21094640820980615, 'eval_f1': 0.25676613462873005, 'eval_accuracy': 0.9400524974909288, 'eval_runtime': 2.4093, 'eval_samples_per_second': 635.452, 'eval_steps_per_second': 79.691, 'epoch': 9.0}
{'loss': 0.1956, 'learning_rate': 5e-07, 'epoch': 10.0}
{'eval_loss': 0.1931038498878479, 'eval_precision': 0.3382084095063985, 'eval_recall': 0.21094640820980615, 'eval_f1': 0.2598314606741573, 'eval_accuracy': 0.9407473172238091, 'eval_runtime': 2.3668, 'eval_samples_per_second': 646.877, 'eval_steps_per_second': 81.124, 'epoch': 10.0}
{'loss': 0.191, 'learning_rate': 4.5e-07, 'epoch': 11.0}
{'eval_loss': 0.19081144034862518, 'eval_precision': 0.34797297297297297, 'eval_recall': 0.2348916761687571, 'eval_f1': 0.28046289993192647, 'eval_accuracy': 0.9411719292827916, 'eval_runtime': 2.3727, 'eval_samples_per_second': 645.265, 'eval_steps_per_second': 80.922, 'epoch': 11.0}
{'loss': 0.1888, 'learning_rate': 4e-07, 'epoch': 12.0}
{'eval_loss': 0.18908412754535675, 'eval_precision': 0.34841628959276016, 'eval_recall': 0.2633979475484607, 'eval_f1': 0.30000000000000004, 'eval_accuracy': 0.9407859183200803, 'eval_runtime': 2.3662, 'eval_samples_per_second': 647.033, 'eval_steps_per_second': 81.143, 'epoch': 12.0}
{'loss': 0.1852, 'learning_rate': 3.5e-07, 'epoch': 13.0}
{'eval_loss': 0.1876545250415802, 'eval_precision': 0.355359765051395, 'eval_recall': 0.2759407069555302, 'eval_f1': 0.3106546854942233, 'eval_accuracy': 0.9411719292827916, 'eval_runtime': 2.3829, 'eval_samples_per_second': 642.497, 'eval_steps_per_second': 80.574, 'epoch': 13.0}
{'loss': 0.1844, 'learning_rate': 3e-07, 'epoch': 14.0}
{'eval_loss': 0.18643087148666382, 'eval_precision': 0.3589001447178003, 'eval_recall': 0.28278221208665905, 'eval_f1': 0.31632653061224486, 'eval_accuracy': 0.9413263336678762, 'eval_runtime': 2.3621, 'eval_samples_per_second': 648.162, 'eval_steps_per_second': 81.285, 'epoch': 14.0}
{'loss': 0.1833, 'learning_rate': 2.5e-07, 'epoch': 15.0}
{'eval_loss': 0.18547704815864563, 'eval_precision': 0.3599439775910364, 'eval_recall': 0.29304446978335236, 'eval_f1': 0.32306725329981145, 'eval_accuracy': 0.9415193391492318, 'eval_runtime': 2.3736, 'eval_samples_per_second': 644.999, 'eval_steps_per_second': 80.888, 'epoch': 15.0}
{'loss': 0.1812, 'learning_rate': 2e-07, 'epoch': 16.0}
{'eval_loss': 0.18455715477466583, 'eval_precision': 0.36086956521739133, 'eval_recall': 0.2839224629418472, 'eval_f1': 0.3178047223994895, 'eval_accuracy': 0.941557940245503, 'eval_runtime': 2.3785, 'eval_samples_per_second': 643.671, 'eval_steps_per_second': 80.722, 'epoch': 16.0}
{'loss': 0.18, 'learning_rate': 1.5e-07, 'epoch': 17.0}
{'eval_loss': 0.1842026710510254, 'eval_precision': 0.36033519553072624, 'eval_recall': 0.29418472063854045, 'eval_f1': 0.32391713747645945, 'eval_accuracy': 0.9416737435343163, 'eval_runtime': 2.3701, 'eval_samples_per_second': 645.967, 'eval_steps_per_second': 81.01, 'epoch': 17.0}
{'loss': 0.1788, 'learning_rate': 1e-07, 'epoch': 18.0}
{'eval_loss': 0.183576762676239, 'eval_precision': 0.36376811594202896, 'eval_recall': 0.2862029646522235, 'eval_f1': 0.32035737077217613, 'eval_accuracy': 0.9419825523044855, 'eval_runtime': 2.3729, 'eval_samples_per_second': 645.209, 'eval_steps_per_second': 80.915, 'epoch': 18.0}
{'loss': 0.1778, 'learning_rate': 5e-08, 'epoch': 19.0}
{'eval_loss': 0.18335522711277008, 'eval_precision': 0.3667621776504298, 'eval_recall': 0.2919042189281642, 'eval_f1': 0.3250793650793651, 'eval_accuracy': 0.9420597544970277, 'eval_runtime': 2.3656, 'eval_samples_per_second': 647.2, 'eval_steps_per_second': 81.164, 'epoch': 19.0}
{'loss': 0.1778, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.18336695432662964, 'eval_precision': 0.3672316384180791, 'eval_recall': 0.29646522234891676, 'eval_f1': 0.3280757097791798, 'eval_accuracy': 0.9419439512082143, 'eval_runtime': 2.366, 'eval_samples_per_second': 647.088, 'eval_steps_per_second': 81.15, 'epoch': 20.0}
{'train_runtime': 704.2414, 'train_samples_per_second': 245.2, 'train_steps_per_second': 3.834, 'train_loss': 0.22847489109745733, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.2285
  train_runtime            = 0:11:44.24
  train_samples            =       8634
  train_samples_per_second =      245.2
  train_steps_per_second   =      3.834
[{'loss': 0.6913, 'learning_rate': 9.499999999999999e-07, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.31086087226867676, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9341851308577164, 'eval_runtime': 2.3942, 'eval_samples_per_second': 639.468, 'eval_steps_per_second': 80.195, 'epoch': 1.0, 'step': 135}, {'loss': 0.2937, 'learning_rate': 9e-07, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.2653428018093109, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9342623330502586, 'eval_runtime': 2.385, 'eval_samples_per_second': 641.936, 'eval_steps_per_second': 80.504, 'epoch': 2.0, 'step': 270}, {'loss': 0.261, 'learning_rate': 8.499999999999999e-07, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.24195420742034912, 'eval_precision': 0.1323529411764706, 'eval_recall': 0.010262257696693273, 'eval_f1': 0.019047619047619046, 'eval_accuracy': 0.9352659615533081, 'eval_runtime': 2.3996, 'eval_samples_per_second': 638.034, 'eval_steps_per_second': 80.015, 'epoch': 3.0, 'step': 405}, {'loss': 0.2401, 'learning_rate': 8e-07, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.22619646787643433, 'eval_precision': 0.27058823529411763, 'eval_recall': 0.052451539338654506, 'eval_f1': 0.08787010506208215, 'eval_accuracy': 0.9367714043078823, 'eval_runtime': 2.3831, 'eval_samples_per_second': 642.428, 'eval_steps_per_second': 80.566, 'epoch': 4.0, 'step': 540}, {'loss': 0.2262, 'learning_rate': 7.5e-07, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.21542885899543762, 'eval_precision': 0.2920962199312715, 'eval_recall': 0.09692132269099202, 'eval_f1': 0.14554794520547945, 'eval_accuracy': 0.9374662240407627, 'eval_runtime': 2.3867, 'eval_samples_per_second': 641.479, 'eval_steps_per_second': 80.447, 'epoch': 5.0, 'step': 675}, {'loss': 0.2175, 'learning_rate': 7e-07, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.20882628858089447, 'eval_precision': 0.3125, 'eval_recall': 0.17103762827822122, 'eval_f1': 0.22107590272660282, 'eval_accuracy': 0.9385470547363545, 'eval_runtime': 2.3875, 'eval_samples_per_second': 641.268, 'eval_steps_per_second': 80.42, 'epoch': 6.0, 'step': 810}, {'loss': 0.2112, 'learning_rate': 6.5e-07, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.20333485305309296, 'eval_precision': 0.33482142857142855, 'eval_recall': 0.17103762827822122, 'eval_f1': 0.22641509433962267, 'eval_accuracy': 0.9394348799505906, 'eval_runtime': 2.3865, 'eval_samples_per_second': 641.52, 'eval_steps_per_second': 80.452, 'epoch': 7.0, 'step': 945}, {'loss': 0.2045, 'learning_rate': 6e-07, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.1997550129890442, 'eval_precision': 0.3184931506849315, 'eval_recall': 0.2120866590649943, 'eval_f1': 0.2546201232032854, 'eval_accuracy': 0.938971666795337, 'eval_runtime': 2.398, 'eval_samples_per_second': 638.448, 'eval_steps_per_second': 80.067, 'epoch': 8.0, 'step': 1080}, {'loss': 0.1998, 'learning_rate': 5.5e-07, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.19585438072681427, 'eval_precision': 0.3280141843971631, 'eval_recall': 0.21094640820980615, 'eval_f1': 0.25676613462873005, 'eval_accuracy': 0.9400524974909288, 'eval_runtime': 2.4093, 'eval_samples_per_second': 635.452, 'eval_steps_per_second': 79.691, 'epoch': 9.0, 'step': 1215}, {'loss': 0.1956, 'learning_rate': 5e-07, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.1931038498878479, 'eval_precision': 0.3382084095063985, 'eval_recall': 0.21094640820980615, 'eval_f1': 0.2598314606741573, 'eval_accuracy': 0.9407473172238091, 'eval_runtime': 2.3668, 'eval_samples_per_second': 646.877, 'eval_steps_per_second': 81.124, 'epoch': 10.0, 'step': 1350}, {'loss': 0.191, 'learning_rate': 4.5e-07, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.19081144034862518, 'eval_precision': 0.34797297297297297, 'eval_recall': 0.2348916761687571, 'eval_f1': 0.28046289993192647, 'eval_accuracy': 0.9411719292827916, 'eval_runtime': 2.3727, 'eval_samples_per_second': 645.265, 'eval_steps_per_second': 80.922, 'epoch': 11.0, 'step': 1485}, {'loss': 0.1888, 'learning_rate': 4e-07, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.18908412754535675, 'eval_precision': 0.34841628959276016, 'eval_recall': 0.2633979475484607, 'eval_f1': 0.30000000000000004, 'eval_accuracy': 0.9407859183200803, 'eval_runtime': 2.3662, 'eval_samples_per_second': 647.033, 'eval_steps_per_second': 81.143, 'epoch': 12.0, 'step': 1620}, {'loss': 0.1852, 'learning_rate': 3.5e-07, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.1876545250415802, 'eval_precision': 0.355359765051395, 'eval_recall': 0.2759407069555302, 'eval_f1': 0.3106546854942233, 'eval_accuracy': 0.9411719292827916, 'eval_runtime': 2.3829, 'eval_samples_per_second': 642.497, 'eval_steps_per_second': 80.574, 'epoch': 13.0, 'step': 1755}, {'loss': 0.1844, 'learning_rate': 3e-07, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.18643087148666382, 'eval_precision': 0.3589001447178003, 'eval_recall': 0.28278221208665905, 'eval_f1': 0.31632653061224486, 'eval_accuracy': 0.9413263336678762, 'eval_runtime': 2.3621, 'eval_samples_per_second': 648.162, 'eval_steps_per_second': 81.285, 'epoch': 14.0, 'step': 1890}, {'loss': 0.1833, 'learning_rate': 2.5e-07, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.18547704815864563, 'eval_precision': 0.3599439775910364, 'eval_recall': 0.29304446978335236, 'eval_f1': 0.32306725329981145, 'eval_accuracy': 0.9415193391492318, 'eval_runtime': 2.3736, 'eval_samples_per_second': 644.999, 'eval_steps_per_second': 80.888, 'epoch': 15.0, 'step': 2025}, {'loss': 0.1812, 'learning_rate': 2e-07, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.18455715477466583, 'eval_precision': 0.36086956521739133, 'eval_recall': 0.2839224629418472, 'eval_f1': 0.3178047223994895, 'eval_accuracy': 0.941557940245503, 'eval_runtime': 2.3785, 'eval_samples_per_second': 643.671, 'eval_steps_per_second': 80.722, 'epoch': 16.0, 'step': 2160}, {'loss': 0.18, 'learning_rate': 1.5e-07, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.1842026710510254, 'eval_precision': 0.36033519553072624, 'eval_recall': 0.29418472063854045, 'eval_f1': 0.32391713747645945, 'eval_accuracy': 0.9416737435343163, 'eval_runtime': 2.3701, 'eval_samples_per_second': 645.967, 'eval_steps_per_second': 81.01, 'epoch': 17.0, 'step': 2295}, {'loss': 0.1788, 'learning_rate': 1e-07, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.183576762676239, 'eval_precision': 0.36376811594202896, 'eval_recall': 0.2862029646522235, 'eval_f1': 0.32035737077217613, 'eval_accuracy': 0.9419825523044855, 'eval_runtime': 2.3729, 'eval_samples_per_second': 645.209, 'eval_steps_per_second': 80.915, 'epoch': 18.0, 'step': 2430}, {'loss': 0.1778, 'learning_rate': 5e-08, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.18335522711277008, 'eval_precision': 0.3667621776504298, 'eval_recall': 0.2919042189281642, 'eval_f1': 0.3250793650793651, 'eval_accuracy': 0.9420597544970277, 'eval_runtime': 2.3656, 'eval_samples_per_second': 647.2, 'eval_steps_per_second': 81.164, 'epoch': 19.0, 'step': 2565}, {'loss': 0.1778, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.18336695432662964, 'eval_precision': 0.3672316384180791, 'eval_recall': 0.29646522234891676, 'eval_f1': 0.3280757097791798, 'eval_accuracy': 0.9419439512082143, 'eval_runtime': 2.366, 'eval_samples_per_second': 647.088, 'eval_steps_per_second': 81.15, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 704.2414, 'train_samples_per_second': 245.2, 'train_steps_per_second': 3.834, 'total_flos': 7445008896319020.0, 'train_loss': 0.22847489109745733, 'epoch': 20.0, 'step': 2700}]

Evaluation, NbAiLab/nb-bert-base
***** predict metrics *****
  predict_accuracy           =     0.9441
  predict_f1                 =       0.33
  predict_loss               =      0.183
  predict_precision          =     0.3808
  predict_recall             =     0.2912
  predict_runtime            = 0:00:02.01
  predict_samples_per_second =    632.268
  predict_steps_per_second   =     79.033
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_NB-BERT_base_18.json completed. F1: 0.3299922898997687
/fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_10.json
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/transformers/utils/hub.py:123: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Some weights of XLMRobertaForTokenClassification were not initialized from the model checkpoint at xlm-roberta-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Numpy: 1.22.3
PyTorch: 1.12.1
Transformers: 4.36.2



***Loading config file: /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_10.json
01150927_tsa-bin_XLM-R_base Our label2id: {'O': 0, 'B-targ-Negative': 1, 'I-targ-Negative': 2, 'B-targ-Positive': 3, 'I-targ-Positive': 4}
Running tokenizer on train dataset:   0%|          | 0/8634 [00:00<?, ? examples/s]Running tokenizer on train dataset:  12%|█▏        | 1000/8634 [00:00<00:01, 5852.75 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8634 [00:00<00:01, 6482.89 examples/s]Running tokenizer on train dataset:  35%|███▍      | 3000/8634 [00:00<00:00, 6451.68 examples/s]Running tokenizer on train dataset:  46%|████▋     | 4000/8634 [00:00<00:00, 6474.21 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8634 [00:00<00:00, 6481.86 examples/s]Running tokenizer on train dataset:  69%|██████▉   | 6000/8634 [00:00<00:00, 6605.81 examples/s]Running tokenizer on train dataset:  81%|████████  | 7000/8634 [00:01<00:00, 5917.45 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8634 [00:01<00:00, 6262.35 examples/s]Running tokenizer on train dataset: 100%|██████████| 8634/8634 [00:01<00:00, 6331.36 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1531 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  65%|██████▌   | 1000/1531 [00:00<00:00, 6946.98 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1531/1531 [00:00<00:00, 6624.23 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1272 [00:00<?, ? examples/s]Running tokenizer on test dataset:  79%|███████▊  | 1000/1272 [00:00<00:00, 6618.49 examples/s]Running tokenizer on test dataset: 100%|██████████| 1272/1272 [00:00<00:00, 6403.46 examples/s]
You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/fp/homes01/u01/ec-egilron/venvs/transformers/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
01150927_tsa-bin_XLM-R_base Ready to train. Train dataset labels are now: ['idx', 'tokens', 'tsa_tags', 'input_ids', 'attention_mask', 'labels']
{'loss': 0.412, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': 0.22287076711654663, 'eval_precision': 0.028169014084507043, 'eval_recall': 0.002280501710376283, 'eval_f1': 0.004219409282700422, 'eval_accuracy': 0.935806376901104, 'eval_runtime': 2.3268, 'eval_samples_per_second': 657.991, 'eval_steps_per_second': 82.517, 'epoch': 1.0}
{'loss': 0.2173, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': 0.1829349547624588, 'eval_precision': 0.39651416122004357, 'eval_recall': 0.20752565564424175, 'eval_f1': 0.2724550898203593, 'eval_accuracy': 0.9423299621709257, 'eval_runtime': 2.3448, 'eval_samples_per_second': 652.939, 'eval_steps_per_second': 81.884, 'epoch': 2.0}
{'loss': 0.1848, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': 0.1735077202320099, 'eval_precision': 0.41793103448275865, 'eval_recall': 0.34549600912200684, 'eval_f1': 0.37827715355805247, 'eval_accuracy': 0.9438740060217711, 'eval_runtime': 2.3213, 'eval_samples_per_second': 659.534, 'eval_steps_per_second': 82.711, 'epoch': 3.0}
{'loss': 0.1645, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': 0.1763327717781067, 'eval_precision': 0.3947643979057592, 'eval_recall': 0.4298745724059293, 'eval_f1': 0.4115720524017467, 'eval_accuracy': 0.9436423994441442, 'eval_runtime': 2.4934, 'eval_samples_per_second': 614.018, 'eval_steps_per_second': 77.003, 'epoch': 4.0}
{'loss': 0.1482, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': 0.17259420454502106, 'eval_precision': 0.3773035887487876, 'eval_recall': 0.443557582668187, 'eval_f1': 0.4077568134171907, 'eval_accuracy': 0.941557940245503, 'eval_runtime': 2.3169, 'eval_samples_per_second': 660.793, 'eval_steps_per_second': 82.869, 'epoch': 5.0}
{'loss': 0.131, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': 0.16868944466114044, 'eval_precision': 0.4348302300109529, 'eval_recall': 0.4526795895096921, 'eval_f1': 0.4435754189944134, 'eval_accuracy': 0.9445688257546514, 'eval_runtime': 2.3108, 'eval_samples_per_second': 662.537, 'eval_steps_per_second': 83.088, 'epoch': 6.0}
{'loss': 0.1171, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': 0.17860327661037445, 'eval_precision': 0.42830188679245285, 'eval_recall': 0.5176738882554162, 'eval_f1': 0.4687661331956634, 'eval_accuracy': 0.9429861808075349, 'eval_runtime': 2.337, 'eval_samples_per_second': 655.11, 'eval_steps_per_second': 82.156, 'epoch': 7.0}
{'loss': 0.1056, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': 0.17717218399047852, 'eval_precision': 0.4672395273899033, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.4811946902654867, 'eval_accuracy': 0.9468462904346483, 'eval_runtime': 2.3182, 'eval_samples_per_second': 660.418, 'eval_steps_per_second': 82.822, 'epoch': 8.0}
{'loss': 0.0968, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': 0.1829085499048233, 'eval_precision': 0.4716981132075472, 'eval_recall': 0.4846066134549601, 'eval_f1': 0.47806524184476934, 'eval_accuracy': 0.9457268586427855, 'eval_runtime': 2.4785, 'eval_samples_per_second': 617.714, 'eval_steps_per_second': 77.466, 'epoch': 9.0}
{'loss': 0.0893, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': 0.19140830636024475, 'eval_precision': 0.44751908396946566, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.4872727272727273, 'eval_accuracy': 0.9438354049254999, 'eval_runtime': 2.3236, 'eval_samples_per_second': 658.889, 'eval_steps_per_second': 82.63, 'epoch': 10.0}
{'loss': 0.0818, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': 0.19796504080295563, 'eval_precision': 0.4215600350569676, 'eval_recall': 0.548460661345496, 'eval_f1': 0.4767096134786918, 'eval_accuracy': 0.9402455029722844, 'eval_runtime': 2.3172, 'eval_samples_per_second': 660.705, 'eval_steps_per_second': 82.858, 'epoch': 11.0}
{'loss': 0.0769, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': 0.19880852103233337, 'eval_precision': 0.454638124362895, 'eval_recall': 0.508551881413911, 'eval_f1': 0.480086114101184, 'eval_accuracy': 0.9448004323322783, 'eval_runtime': 2.3048, 'eval_samples_per_second': 664.277, 'eval_steps_per_second': 83.306, 'epoch': 12.0}
{'loss': 0.0697, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': 0.2051171362400055, 'eval_precision': 0.4471057884231537, 'eval_recall': 0.5108323831242874, 'eval_f1': 0.4768493879723257, 'eval_accuracy': 0.9424843665560102, 'eval_runtime': 2.3174, 'eval_samples_per_second': 660.663, 'eval_steps_per_second': 82.853, 'epoch': 13.0}
{'loss': 0.0668, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': 0.21052153408527374, 'eval_precision': 0.4429530201342282, 'eval_recall': 0.5267958950969214, 'eval_f1': 0.48125000000000007, 'eval_accuracy': 0.9426001698448236, 'eval_runtime': 2.3217, 'eval_samples_per_second': 659.426, 'eval_steps_per_second': 82.698, 'epoch': 14.0}
{'loss': 0.0631, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': 0.21478024125099182, 'eval_precision': 0.43577981651376146, 'eval_recall': 0.5416191562143672, 'eval_f1': 0.4829689883070666, 'eval_accuracy': 0.9419825523044855, 'eval_runtime': 2.316, 'eval_samples_per_second': 661.058, 'eval_steps_per_second': 82.902, 'epoch': 15.0}
{'loss': 0.061, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': 0.21704763174057007, 'eval_precision': 0.45650048875855326, 'eval_recall': 0.5324971493728621, 'eval_f1': 0.49157894736842106, 'eval_accuracy': 0.9437196016366864, 'eval_runtime': 2.3207, 'eval_samples_per_second': 659.703, 'eval_steps_per_second': 82.732, 'epoch': 16.0}
{'loss': 0.0584, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': 0.22156298160552979, 'eval_precision': 0.44960474308300397, 'eval_recall': 0.5188141391106044, 'eval_f1': 0.48173636844891476, 'eval_accuracy': 0.9437196016366864, 'eval_runtime': 2.3025, 'eval_samples_per_second': 664.918, 'eval_steps_per_second': 83.386, 'epoch': 17.0}
{'loss': 0.0549, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': 0.22322143614292145, 'eval_precision': 0.44422890397672166, 'eval_recall': 0.5222348916761688, 'eval_f1': 0.48008385744234805, 'eval_accuracy': 0.9433335906739752, 'eval_runtime': 2.3108, 'eval_samples_per_second': 662.545, 'eval_steps_per_second': 83.089, 'epoch': 18.0}
{'loss': 0.0541, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': 0.22420154511928558, 'eval_precision': 0.4402332361516035, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.4753410283315844, 'eval_accuracy': 0.943294989577704, 'eval_runtime': 2.3126, 'eval_samples_per_second': 662.032, 'eval_steps_per_second': 83.024, 'epoch': 19.0}
{'loss': 0.0532, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.22482508420944214, 'eval_precision': 0.4448818897637795, 'eval_recall': 0.5153933865450399, 'eval_f1': 0.4775488642366614, 'eval_accuracy': 0.9436810005404154, 'eval_runtime': 2.315, 'eval_samples_per_second': 661.349, 'eval_steps_per_second': 82.939, 'epoch': 20.0}
{'train_runtime': 705.5243, 'train_samples_per_second': 244.754, 'train_steps_per_second': 3.827, 'train_loss': 0.1153203241913407, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  train_loss               =     0.1153
  train_runtime            = 0:11:45.52
  train_samples            =       8634
  train_samples_per_second =    244.754
  train_steps_per_second   =      3.827
[{'loss': 0.412, 'learning_rate': 9.5e-06, 'epoch': 1.0, 'step': 135}, {'eval_loss': 0.22287076711654663, 'eval_precision': 0.028169014084507043, 'eval_recall': 0.002280501710376283, 'eval_f1': 0.004219409282700422, 'eval_accuracy': 0.935806376901104, 'eval_runtime': 2.3268, 'eval_samples_per_second': 657.991, 'eval_steps_per_second': 82.517, 'epoch': 1.0, 'step': 135}, {'loss': 0.2173, 'learning_rate': 9e-06, 'epoch': 2.0, 'step': 270}, {'eval_loss': 0.1829349547624588, 'eval_precision': 0.39651416122004357, 'eval_recall': 0.20752565564424175, 'eval_f1': 0.2724550898203593, 'eval_accuracy': 0.9423299621709257, 'eval_runtime': 2.3448, 'eval_samples_per_second': 652.939, 'eval_steps_per_second': 81.884, 'epoch': 2.0, 'step': 270}, {'loss': 0.1848, 'learning_rate': 8.5e-06, 'epoch': 3.0, 'step': 405}, {'eval_loss': 0.1735077202320099, 'eval_precision': 0.41793103448275865, 'eval_recall': 0.34549600912200684, 'eval_f1': 0.37827715355805247, 'eval_accuracy': 0.9438740060217711, 'eval_runtime': 2.3213, 'eval_samples_per_second': 659.534, 'eval_steps_per_second': 82.711, 'epoch': 3.0, 'step': 405}, {'loss': 0.1645, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0, 'step': 540}, {'eval_loss': 0.1763327717781067, 'eval_precision': 0.3947643979057592, 'eval_recall': 0.4298745724059293, 'eval_f1': 0.4115720524017467, 'eval_accuracy': 0.9436423994441442, 'eval_runtime': 2.4934, 'eval_samples_per_second': 614.018, 'eval_steps_per_second': 77.003, 'epoch': 4.0, 'step': 540}, {'loss': 0.1482, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0, 'step': 675}, {'eval_loss': 0.17259420454502106, 'eval_precision': 0.3773035887487876, 'eval_recall': 0.443557582668187, 'eval_f1': 0.4077568134171907, 'eval_accuracy': 0.941557940245503, 'eval_runtime': 2.3169, 'eval_samples_per_second': 660.793, 'eval_steps_per_second': 82.869, 'epoch': 5.0, 'step': 675}, {'loss': 0.131, 'learning_rate': 7e-06, 'epoch': 6.0, 'step': 810}, {'eval_loss': 0.16868944466114044, 'eval_precision': 0.4348302300109529, 'eval_recall': 0.4526795895096921, 'eval_f1': 0.4435754189944134, 'eval_accuracy': 0.9445688257546514, 'eval_runtime': 2.3108, 'eval_samples_per_second': 662.537, 'eval_steps_per_second': 83.088, 'epoch': 6.0, 'step': 810}, {'loss': 0.1171, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0, 'step': 945}, {'eval_loss': 0.17860327661037445, 'eval_precision': 0.42830188679245285, 'eval_recall': 0.5176738882554162, 'eval_f1': 0.4687661331956634, 'eval_accuracy': 0.9429861808075349, 'eval_runtime': 2.337, 'eval_samples_per_second': 655.11, 'eval_steps_per_second': 82.156, 'epoch': 7.0, 'step': 945}, {'loss': 0.1056, 'learning_rate': 6e-06, 'epoch': 8.0, 'step': 1080}, {'eval_loss': 0.17717218399047852, 'eval_precision': 0.4672395273899033, 'eval_recall': 0.4960091220068415, 'eval_f1': 0.4811946902654867, 'eval_accuracy': 0.9468462904346483, 'eval_runtime': 2.3182, 'eval_samples_per_second': 660.418, 'eval_steps_per_second': 82.822, 'epoch': 8.0, 'step': 1080}, {'loss': 0.0968, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0, 'step': 1215}, {'eval_loss': 0.1829085499048233, 'eval_precision': 0.4716981132075472, 'eval_recall': 0.4846066134549601, 'eval_f1': 0.47806524184476934, 'eval_accuracy': 0.9457268586427855, 'eval_runtime': 2.4785, 'eval_samples_per_second': 617.714, 'eval_steps_per_second': 77.466, 'epoch': 9.0, 'step': 1215}, {'loss': 0.0893, 'learning_rate': 5e-06, 'epoch': 10.0, 'step': 1350}, {'eval_loss': 0.19140830636024475, 'eval_precision': 0.44751908396946566, 'eval_recall': 0.5347776510832383, 'eval_f1': 0.4872727272727273, 'eval_accuracy': 0.9438354049254999, 'eval_runtime': 2.3236, 'eval_samples_per_second': 658.889, 'eval_steps_per_second': 82.63, 'epoch': 10.0, 'step': 1350}, {'loss': 0.0818, 'learning_rate': 4.5e-06, 'epoch': 11.0, 'step': 1485}, {'eval_loss': 0.19796504080295563, 'eval_precision': 0.4215600350569676, 'eval_recall': 0.548460661345496, 'eval_f1': 0.4767096134786918, 'eval_accuracy': 0.9402455029722844, 'eval_runtime': 2.3172, 'eval_samples_per_second': 660.705, 'eval_steps_per_second': 82.858, 'epoch': 11.0, 'step': 1485}, {'loss': 0.0769, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0, 'step': 1620}, {'eval_loss': 0.19880852103233337, 'eval_precision': 0.454638124362895, 'eval_recall': 0.508551881413911, 'eval_f1': 0.480086114101184, 'eval_accuracy': 0.9448004323322783, 'eval_runtime': 2.3048, 'eval_samples_per_second': 664.277, 'eval_steps_per_second': 83.306, 'epoch': 12.0, 'step': 1620}, {'loss': 0.0697, 'learning_rate': 3.5e-06, 'epoch': 13.0, 'step': 1755}, {'eval_loss': 0.2051171362400055, 'eval_precision': 0.4471057884231537, 'eval_recall': 0.5108323831242874, 'eval_f1': 0.4768493879723257, 'eval_accuracy': 0.9424843665560102, 'eval_runtime': 2.3174, 'eval_samples_per_second': 660.663, 'eval_steps_per_second': 82.853, 'epoch': 13.0, 'step': 1755}, {'loss': 0.0668, 'learning_rate': 3e-06, 'epoch': 14.0, 'step': 1890}, {'eval_loss': 0.21052153408527374, 'eval_precision': 0.4429530201342282, 'eval_recall': 0.5267958950969214, 'eval_f1': 0.48125000000000007, 'eval_accuracy': 0.9426001698448236, 'eval_runtime': 2.3217, 'eval_samples_per_second': 659.426, 'eval_steps_per_second': 82.698, 'epoch': 14.0, 'step': 1890}, {'loss': 0.0631, 'learning_rate': 2.5e-06, 'epoch': 15.0, 'step': 2025}, {'eval_loss': 0.21478024125099182, 'eval_precision': 0.43577981651376146, 'eval_recall': 0.5416191562143672, 'eval_f1': 0.4829689883070666, 'eval_accuracy': 0.9419825523044855, 'eval_runtime': 2.316, 'eval_samples_per_second': 661.058, 'eval_steps_per_second': 82.902, 'epoch': 15.0, 'step': 2025}, {'loss': 0.061, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0, 'step': 2160}, {'eval_loss': 0.21704763174057007, 'eval_precision': 0.45650048875855326, 'eval_recall': 0.5324971493728621, 'eval_f1': 0.49157894736842106, 'eval_accuracy': 0.9437196016366864, 'eval_runtime': 2.3207, 'eval_samples_per_second': 659.703, 'eval_steps_per_second': 82.732, 'epoch': 16.0, 'step': 2160}, {'loss': 0.0584, 'learning_rate': 1.5e-06, 'epoch': 17.0, 'step': 2295}, {'eval_loss': 0.22156298160552979, 'eval_precision': 0.44960474308300397, 'eval_recall': 0.5188141391106044, 'eval_f1': 0.48173636844891476, 'eval_accuracy': 0.9437196016366864, 'eval_runtime': 2.3025, 'eval_samples_per_second': 664.918, 'eval_steps_per_second': 83.386, 'epoch': 17.0, 'step': 2295}, {'loss': 0.0549, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0, 'step': 2430}, {'eval_loss': 0.22322143614292145, 'eval_precision': 0.44422890397672166, 'eval_recall': 0.5222348916761688, 'eval_f1': 0.48008385744234805, 'eval_accuracy': 0.9433335906739752, 'eval_runtime': 2.3108, 'eval_samples_per_second': 662.545, 'eval_steps_per_second': 83.089, 'epoch': 18.0, 'step': 2430}, {'loss': 0.0541, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0, 'step': 2565}, {'eval_loss': 0.22420154511928558, 'eval_precision': 0.4402332361516035, 'eval_recall': 0.5165336374002281, 'eval_f1': 0.4753410283315844, 'eval_accuracy': 0.943294989577704, 'eval_runtime': 2.3126, 'eval_samples_per_second': 662.032, 'eval_steps_per_second': 83.024, 'epoch': 19.0, 'step': 2565}, {'loss': 0.0532, 'learning_rate': 0.0, 'epoch': 20.0, 'step': 2700}, {'eval_loss': 0.22482508420944214, 'eval_precision': 0.4448818897637795, 'eval_recall': 0.5153933865450399, 'eval_f1': 0.4775488642366614, 'eval_accuracy': 0.9436810005404154, 'eval_runtime': 2.315, 'eval_samples_per_second': 661.349, 'eval_steps_per_second': 82.939, 'epoch': 20.0, 'step': 2700}, {'train_runtime': 705.5243, 'train_samples_per_second': 244.754, 'train_steps_per_second': 3.827, 'total_flos': 7230575408749680.0, 'train_loss': 0.1153203241913407, 'epoch': 20.0, 'step': 2700}]

Evaluation, xlm-roberta-base
***** predict metrics *****
  predict_accuracy           =      0.947
  predict_f1                 =     0.4227
  predict_loss               =     0.1679
  predict_precision          =     0.4308
  predict_recall             =      0.415
  predict_runtime            = 0:00:02.03
  predict_samples_per_second =    624.317
  predict_steps_per_second   =      78.04
Train and save best epoch to /fp/homes01/u01/ec-egilron/sqlabel-github/configs/fox/01150927_tsa-bin_XLM-R_base_10.json completed. F1: 0.4227304227304228

Task and CPU usage stats:
JobID           JobName  AllocCPUS   NTasks     MinCPU MinCPUTask     AveCPU    Elapsed ExitCode 
------------ ---------- ---------- -------- ---------- ---------- ---------- ---------- -------- 
409165       tsa_norbe+          1                                             05:33:14      0:0 
409165.batch      batch          1        1   05:24:05          0   05:24:05   05:33:14      0:0 
409165.exte+     extern          1        1   00:00:00          0   00:00:00   05:33:14      0:0 

Memory usage stats:
JobID            MaxRSS MaxRSSTask     AveRSS MaxPages   MaxPagesTask   AvePages 
------------ ---------- ---------- ---------- -------- -------------- ---------- 
409165                                                                           
409165.batch   3807460K          0   3807460K        0              0          0 
409165.exte+          0          0          0        0              0          0 

Disk usage stats:
JobID         MaxDiskRead MaxDiskReadTask    AveDiskRead MaxDiskWrite MaxDiskWriteTask   AveDiskWrite 
------------ ------------ --------------- -------------- ------------ ---------------- -------------- 
409165                                                                                                
409165.batch    15296.00M               0      15296.00M   948014.23M                0     948014.23M 
409165.exte+        0.01M               0          0.01M        0.00M                0          0.00M 

GPU usage stats:
Error: Unable to retrieve job statistics. Return: Setting not configured.

Job 409165 completed at Mon Jan 15 16:32:18 CET 2024
