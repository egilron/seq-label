Starting job 10910777 on gpu-12-8 on saga at Sat Mar 9 10:40:40 CET 2024

/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_505.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_505.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 6904.19 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:00, 7541.12 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6739.85 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6687.96 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6947.57 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 7232.00 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:00<00:00, 7258.51 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7412.15 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 7147.07 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7407.93 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 6805.55 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4419.33 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3601.25 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9992, 'eval_samples_per_second': 252.201, 'eval_steps_per_second': 31.671, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.1809, 'eval_samples_per_second': 244.785, 'eval_steps_per_second': 30.74, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7044, 'eval_samples_per_second': 265.233, 'eval_steps_per_second': 33.308, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7568, 'eval_samples_per_second': 262.817, 'eval_steps_per_second': 33.004, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.749, 'eval_samples_per_second': 263.177, 'eval_steps_per_second': 33.049, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8145, 'eval_samples_per_second': 260.211, 'eval_steps_per_second': 32.677, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7447, 'eval_samples_per_second': 263.371, 'eval_steps_per_second': 33.074, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.6953, 'eval_samples_per_second': 265.658, 'eval_steps_per_second': 33.361, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8086, 'eval_samples_per_second': 260.474, 'eval_steps_per_second': 32.71, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.6876, 'eval_samples_per_second': 266.019, 'eval_steps_per_second': 33.406, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.6925, 'eval_samples_per_second': 265.787, 'eval_steps_per_second': 33.377, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7261, 'eval_samples_per_second': 264.227, 'eval_steps_per_second': 33.181, 'epoch': 12.0}
{'train_runtime': 1188.6829, 'train_samples_per_second': 86.516, 'train_steps_per_second': 1.353, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:48.68
  train_samples            =       8570
  train_samples_per_second =     86.516
  train_steps_per_second   =      1.353
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 134}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9992, 'eval_samples_per_second': 252.201, 'eval_steps_per_second': 31.671, 'epoch': 1.0, 'step': 134}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.1809, 'eval_samples_per_second': 244.785, 'eval_steps_per_second': 30.74, 'epoch': 2.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 402}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7044, 'eval_samples_per_second': 265.233, 'eval_steps_per_second': 33.308, 'epoch': 3.0, 'step': 402}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7568, 'eval_samples_per_second': 262.817, 'eval_steps_per_second': 33.004, 'epoch': 4.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 670}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.749, 'eval_samples_per_second': 263.177, 'eval_steps_per_second': 33.049, 'epoch': 5.0, 'step': 670}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8145, 'eval_samples_per_second': 260.211, 'eval_steps_per_second': 32.677, 'epoch': 6.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 938}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7447, 'eval_samples_per_second': 263.371, 'eval_steps_per_second': 33.074, 'epoch': 7.0, 'step': 938}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.6953, 'eval_samples_per_second': 265.658, 'eval_steps_per_second': 33.361, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 1206}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8086, 'eval_samples_per_second': 260.474, 'eval_steps_per_second': 32.71, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.6876, 'eval_samples_per_second': 266.019, 'eval_steps_per_second': 33.406, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 1474}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.6925, 'eval_samples_per_second': 265.787, 'eval_steps_per_second': 33.377, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7261, 'eval_samples_per_second': 264.227, 'eval_steps_per_second': 33.181, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1188.6829, 'train_samples_per_second': 86.516, 'train_steps_per_second': 1.353, 'total_flos': 1.3425758487918348e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.87
  predict_samples_per_second =    256.967
  predict_steps_per_second   =     32.224
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_505.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_505.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_505.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 6669.61 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 5847.19 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6605.01 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6483.07 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6762.59 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 7043.50 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 7083.37 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7196.48 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6515.16 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 6715.09 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 5169.07 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 3891.78 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 2955.21 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-134 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 39.5792, 'eval_samples_per_second': 38.227, 'eval_steps_per_second': 4.801, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.1437, 'eval_samples_per_second': 246.269, 'eval_steps_per_second': 30.926, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8589, 'eval_samples_per_second': 258.24, 'eval_steps_per_second': 32.429, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7743, 'eval_samples_per_second': 262.025, 'eval_steps_per_second': 32.905, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7581, 'eval_samples_per_second': 262.76, 'eval_steps_per_second': 32.997, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8725, 'eval_samples_per_second': 257.641, 'eval_steps_per_second': 32.354, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.822, 'eval_samples_per_second': 259.876, 'eval_steps_per_second': 32.635, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7289, 'eval_samples_per_second': 264.097, 'eval_steps_per_second': 33.165, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7839, 'eval_samples_per_second': 261.587, 'eval_steps_per_second': 32.85, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7698, 'eval_samples_per_second': 262.23, 'eval_steps_per_second': 32.93, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8195, 'eval_samples_per_second': 259.988, 'eval_steps_per_second': 32.649, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7981, 'eval_samples_per_second': 260.948, 'eval_steps_per_second': 32.769, 'epoch': 12.0}
{'train_runtime': 1988.4301, 'train_samples_per_second': 51.719, 'train_steps_per_second': 0.809, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:33:08.43
  train_samples            =       8570
  train_samples_per_second =     51.719
  train_steps_per_second   =      0.809
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 134}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 39.5792, 'eval_samples_per_second': 38.227, 'eval_steps_per_second': 4.801, 'epoch': 1.0, 'step': 134}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.1437, 'eval_samples_per_second': 246.269, 'eval_steps_per_second': 30.926, 'epoch': 2.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 402}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8589, 'eval_samples_per_second': 258.24, 'eval_steps_per_second': 32.429, 'epoch': 3.0, 'step': 402}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7743, 'eval_samples_per_second': 262.025, 'eval_steps_per_second': 32.905, 'epoch': 4.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 670}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7581, 'eval_samples_per_second': 262.76, 'eval_steps_per_second': 32.997, 'epoch': 5.0, 'step': 670}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8725, 'eval_samples_per_second': 257.641, 'eval_steps_per_second': 32.354, 'epoch': 6.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 938}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.822, 'eval_samples_per_second': 259.876, 'eval_steps_per_second': 32.635, 'epoch': 7.0, 'step': 938}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7289, 'eval_samples_per_second': 264.097, 'eval_steps_per_second': 33.165, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 1206}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7839, 'eval_samples_per_second': 261.587, 'eval_steps_per_second': 32.85, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7698, 'eval_samples_per_second': 262.23, 'eval_steps_per_second': 32.93, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 1474}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8195, 'eval_samples_per_second': 259.988, 'eval_steps_per_second': 32.649, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7981, 'eval_samples_per_second': 260.948, 'eval_steps_per_second': 32.769, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1988.4301, 'train_samples_per_second': 51.719, 'train_steps_per_second': 0.809, 'total_flos': 1.3425758487918348e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.86
  predict_samples_per_second =     257.34
  predict_steps_per_second   =      32.27
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_505.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_202.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_202.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 6375.33 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:00, 6795.98 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 7124.60 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6721.59 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6947.36 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 7184.62 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:00<00:00, 7217.65 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7379.86 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6603.71 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 5549.75 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 3668.18 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4375.64 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3572.15 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-134 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 44.6962, 'eval_samples_per_second': 33.851, 'eval_steps_per_second': 4.251, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.7064, 'eval_samples_per_second': 225.606, 'eval_steps_per_second': 28.331, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7934, 'eval_samples_per_second': 261.159, 'eval_steps_per_second': 32.796, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7598, 'eval_samples_per_second': 262.684, 'eval_steps_per_second': 32.987, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7596, 'eval_samples_per_second': 262.692, 'eval_steps_per_second': 32.988, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8291, 'eval_samples_per_second': 259.56, 'eval_steps_per_second': 32.595, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.743, 'eval_samples_per_second': 263.453, 'eval_steps_per_second': 33.084, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7699, 'eval_samples_per_second': 262.223, 'eval_steps_per_second': 32.93, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7171, 'eval_samples_per_second': 264.646, 'eval_steps_per_second': 33.234, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.735, 'eval_samples_per_second': 263.817, 'eval_steps_per_second': 33.13, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7467, 'eval_samples_per_second': 263.283, 'eval_steps_per_second': 33.063, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7282, 'eval_samples_per_second': 264.132, 'eval_steps_per_second': 33.169, 'epoch': 12.0}
{'train_runtime': 1224.2203, 'train_samples_per_second': 84.004, 'train_steps_per_second': 1.313, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:20:24.22
  train_samples            =       8570
  train_samples_per_second =     84.004
  train_steps_per_second   =      1.313
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 134}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 44.6962, 'eval_samples_per_second': 33.851, 'eval_steps_per_second': 4.251, 'epoch': 1.0, 'step': 134}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.7064, 'eval_samples_per_second': 225.606, 'eval_steps_per_second': 28.331, 'epoch': 2.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 402}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7934, 'eval_samples_per_second': 261.159, 'eval_steps_per_second': 32.796, 'epoch': 3.0, 'step': 402}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7598, 'eval_samples_per_second': 262.684, 'eval_steps_per_second': 32.987, 'epoch': 4.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 670}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7596, 'eval_samples_per_second': 262.692, 'eval_steps_per_second': 32.988, 'epoch': 5.0, 'step': 670}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8291, 'eval_samples_per_second': 259.56, 'eval_steps_per_second': 32.595, 'epoch': 6.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 938}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.743, 'eval_samples_per_second': 263.453, 'eval_steps_per_second': 33.084, 'epoch': 7.0, 'step': 938}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7699, 'eval_samples_per_second': 262.223, 'eval_steps_per_second': 32.93, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 1206}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7171, 'eval_samples_per_second': 264.646, 'eval_steps_per_second': 33.234, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.735, 'eval_samples_per_second': 263.817, 'eval_steps_per_second': 33.13, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 1474}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7467, 'eval_samples_per_second': 263.283, 'eval_steps_per_second': 33.063, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7282, 'eval_samples_per_second': 264.132, 'eval_steps_per_second': 33.169, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1224.2203, 'train_samples_per_second': 84.004, 'train_steps_per_second': 1.313, 'total_flos': 1.3389427191491208e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.86
  predict_samples_per_second =    257.457
  predict_steps_per_second   =     32.285
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_202.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_202.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_202.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 7319.81 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:00, 6851.81 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 7064.32 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6440.02 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6730.48 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 7001.83 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 7070.87 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7259.00 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6725.79 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7259.24 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 6039.95 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4349.00 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3961.97 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-134 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 37.1351, 'eval_samples_per_second': 40.743, 'eval_steps_per_second': 5.116, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7491, 'eval_samples_per_second': 263.171, 'eval_steps_per_second': 33.049, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7413, 'eval_samples_per_second': 263.528, 'eval_steps_per_second': 33.093, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7994, 'eval_samples_per_second': 260.89, 'eval_steps_per_second': 32.762, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8588, 'eval_samples_per_second': 258.242, 'eval_steps_per_second': 32.43, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9168, 'eval_samples_per_second': 255.711, 'eval_steps_per_second': 32.112, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7881, 'eval_samples_per_second': 261.397, 'eval_steps_per_second': 32.826, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8754, 'eval_samples_per_second': 257.514, 'eval_steps_per_second': 32.338, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8041, 'eval_samples_per_second': 260.68, 'eval_steps_per_second': 32.736, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.768, 'eval_samples_per_second': 262.309, 'eval_steps_per_second': 32.94, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7675, 'eval_samples_per_second': 262.333, 'eval_steps_per_second': 32.943, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.827, 'eval_samples_per_second': 259.652, 'eval_steps_per_second': 32.607, 'epoch': 12.0}
{'train_runtime': 1255.9795, 'train_samples_per_second': 81.88, 'train_steps_per_second': 1.28, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:20:55.97
  train_samples            =       8570
  train_samples_per_second =      81.88
  train_steps_per_second   =       1.28
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 134}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 37.1351, 'eval_samples_per_second': 40.743, 'eval_steps_per_second': 5.116, 'epoch': 1.0, 'step': 134}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7491, 'eval_samples_per_second': 263.171, 'eval_steps_per_second': 33.049, 'epoch': 2.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 402}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7413, 'eval_samples_per_second': 263.528, 'eval_steps_per_second': 33.093, 'epoch': 3.0, 'step': 402}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7994, 'eval_samples_per_second': 260.89, 'eval_steps_per_second': 32.762, 'epoch': 4.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 670}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8588, 'eval_samples_per_second': 258.242, 'eval_steps_per_second': 32.43, 'epoch': 5.0, 'step': 670}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9168, 'eval_samples_per_second': 255.711, 'eval_steps_per_second': 32.112, 'epoch': 6.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 938}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7881, 'eval_samples_per_second': 261.397, 'eval_steps_per_second': 32.826, 'epoch': 7.0, 'step': 938}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8754, 'eval_samples_per_second': 257.514, 'eval_steps_per_second': 32.338, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 1206}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8041, 'eval_samples_per_second': 260.68, 'eval_steps_per_second': 32.736, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.768, 'eval_samples_per_second': 262.309, 'eval_steps_per_second': 32.94, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 1474}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7675, 'eval_samples_per_second': 262.333, 'eval_steps_per_second': 32.943, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.827, 'eval_samples_per_second': 259.652, 'eval_steps_per_second': 32.607, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1255.9795, 'train_samples_per_second': 81.88, 'train_steps_per_second': 1.28, 'total_flos': 1.3389427191491208e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.87
  predict_samples_per_second =     256.82
  predict_steps_per_second   =     32.205
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_202.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_101.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_101.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 5540.37 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 6405.96 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6772.80 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6171.00 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6580.85 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 6960.16 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 7066.36 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7286.30 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6276.62 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7422.69 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 4767.97 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4413.25 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3233.96 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 33.4397, 'eval_samples_per_second': 45.246, 'eval_steps_per_second': 5.682, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7336, 'eval_samples_per_second': 263.884, 'eval_steps_per_second': 33.138, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8312, 'eval_samples_per_second': 259.468, 'eval_steps_per_second': 32.583, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7632, 'eval_samples_per_second': 262.527, 'eval_steps_per_second': 32.968, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7405, 'eval_samples_per_second': 263.566, 'eval_steps_per_second': 33.098, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7767, 'eval_samples_per_second': 261.915, 'eval_steps_per_second': 32.891, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7125, 'eval_samples_per_second': 264.856, 'eval_steps_per_second': 33.26, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.706, 'eval_samples_per_second': 265.158, 'eval_steps_per_second': 33.298, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8567, 'eval_samples_per_second': 258.336, 'eval_steps_per_second': 32.441, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8021, 'eval_samples_per_second': 260.766, 'eval_steps_per_second': 32.746, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9094, 'eval_samples_per_second': 256.031, 'eval_steps_per_second': 32.152, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9398, 'eval_samples_per_second': 254.724, 'eval_steps_per_second': 31.988, 'epoch': 12.0}
{'train_runtime': 1222.2128, 'train_samples_per_second': 84.142, 'train_steps_per_second': 2.631, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:20:22.21
  train_samples            =       8570
  train_samples_per_second =     84.142
  train_steps_per_second   =      2.631
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 33.4397, 'eval_samples_per_second': 45.246, 'eval_steps_per_second': 5.682, 'epoch': 1.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7336, 'eval_samples_per_second': 263.884, 'eval_steps_per_second': 33.138, 'epoch': 2.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8312, 'eval_samples_per_second': 259.468, 'eval_steps_per_second': 32.583, 'epoch': 3.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7632, 'eval_samples_per_second': 262.527, 'eval_steps_per_second': 32.968, 'epoch': 4.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7405, 'eval_samples_per_second': 263.566, 'eval_steps_per_second': 33.098, 'epoch': 5.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7767, 'eval_samples_per_second': 261.915, 'eval_steps_per_second': 32.891, 'epoch': 6.0, 'step': 1608}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 1876}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7125, 'eval_samples_per_second': 264.856, 'eval_steps_per_second': 33.26, 'epoch': 7.0, 'step': 1876}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 2144}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.706, 'eval_samples_per_second': 265.158, 'eval_steps_per_second': 33.298, 'epoch': 8.0, 'step': 2144}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 2412}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8567, 'eval_samples_per_second': 258.336, 'eval_steps_per_second': 32.441, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8021, 'eval_samples_per_second': 260.766, 'eval_steps_per_second': 32.746, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 2948}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9094, 'eval_samples_per_second': 256.031, 'eval_steps_per_second': 32.152, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9398, 'eval_samples_per_second': 254.724, 'eval_steps_per_second': 31.988, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1222.2128, 'train_samples_per_second': 84.142, 'train_steps_per_second': 2.631, 'total_flos': 1.179195264071682e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.97
  predict_samples_per_second =    251.846
  predict_steps_per_second   =     31.581
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_101.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_303.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_303.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 6280.06 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 6145.83 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6493.57 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6299.19 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6582.39 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 6889.33 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6962.50 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7113.46 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6124.86 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7209.77 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 3972.74 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 3626.45 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 2388.40 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-268 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.122, 'grad_norm': 0.928861677646637, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': 0.07031544297933578, 'eval_precision': 0.3276643990929705, 'eval_recall': 0.46537842190016104, 'eval_f1': 0.38456420492348636, 'eval_accuracy': 0.9796771798178763, 'eval_runtime': 6.1822, 'eval_samples_per_second': 244.734, 'eval_steps_per_second': 30.733, 'epoch': 1.0}
{'loss': 0.0429, 'grad_norm': 1.5252529382705688, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': 0.05272223427891731, 'eval_precision': 0.6671619613670133, 'eval_recall': 0.7230273752012882, 'eval_f1': 0.6939721792890262, 'eval_accuracy': 0.9877281431977176, 'eval_runtime': 5.9104, 'eval_samples_per_second': 255.989, 'eval_steps_per_second': 32.147, 'epoch': 2.0}
{'loss': 0.0231, 'grad_norm': 1.2297533750534058, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': 0.06846938282251358, 'eval_precision': 0.6938110749185668, 'eval_recall': 0.6859903381642513, 'eval_f1': 0.6898785425101215, 'eval_accuracy': 0.9880798843162544, 'eval_runtime': 5.8983, 'eval_samples_per_second': 256.515, 'eval_steps_per_second': 32.213, 'epoch': 3.0}
{'loss': 0.0153, 'grad_norm': 0.8737732768058777, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': 0.054849881678819656, 'eval_precision': 0.6904400606980273, 'eval_recall': 0.7326892109500805, 'eval_f1': 0.7109375000000001, 'eval_accuracy': 0.988861531246336, 'eval_runtime': 5.8841, 'eval_samples_per_second': 257.133, 'eval_steps_per_second': 32.29, 'epoch': 4.0}
{'loss': 0.0082, 'grad_norm': 0.023433461785316467, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': 0.07477512955665588, 'eval_precision': 0.6479514415781487, 'eval_recall': 0.6876006441223832, 'eval_f1': 0.6671874999999999, 'eval_accuracy': 0.9877281431977176, 'eval_runtime': 5.8628, 'eval_samples_per_second': 258.068, 'eval_steps_per_second': 32.408, 'epoch': 5.0}
{'loss': 0.0056, 'grad_norm': 0.059981219470500946, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': 0.08401329815387726, 'eval_precision': 0.6656200941915228, 'eval_recall': 0.6827697262479872, 'eval_f1': 0.6740858505564389, 'eval_accuracy': 0.9873373197326768, 'eval_runtime': 5.8895, 'eval_samples_per_second': 256.896, 'eval_steps_per_second': 32.261, 'epoch': 6.0}
{'loss': 0.0033, 'grad_norm': 0.051061518490314484, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': 0.09332822263240814, 'eval_precision': 0.664624808575804, 'eval_recall': 0.6988727858293076, 'eval_f1': 0.6813186813186813, 'eval_accuracy': 0.9875718138117012, 'eval_runtime': 5.8783, 'eval_samples_per_second': 257.388, 'eval_steps_per_second': 32.322, 'epoch': 7.0}
{'loss': 0.0019, 'grad_norm': 0.017800068482756615, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': 0.10388097912073135, 'eval_precision': 0.6377025036818851, 'eval_recall': 0.6972624798711755, 'eval_f1': 0.6661538461538461, 'eval_accuracy': 0.9870246609606441, 'eval_runtime': 5.8578, 'eval_samples_per_second': 258.289, 'eval_steps_per_second': 32.435, 'epoch': 8.0}
{'loss': 0.001, 'grad_norm': 0.023334259167313576, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': 0.10785014182329178, 'eval_precision': 0.6898148148148148, 'eval_recall': 0.7198067632850241, 'eval_f1': 0.7044917257683214, 'eval_accuracy': 0.9883143783952788, 'eval_runtime': 5.9194, 'eval_samples_per_second': 255.6, 'eval_steps_per_second': 32.098, 'epoch': 9.0}
{'loss': 0.0004, 'grad_norm': 0.0024147359654307365, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': 0.11538377404212952, 'eval_precision': 0.6731634182908546, 'eval_recall': 0.7230273752012882, 'eval_f1': 0.6972049689440993, 'eval_accuracy': 0.9881189666627584, 'eval_runtime': 6.0002, 'eval_samples_per_second': 252.157, 'eval_steps_per_second': 31.665, 'epoch': 10.0}
{'loss': 0.0003, 'grad_norm': 0.026732413098216057, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': 0.11675581336021423, 'eval_precision': 0.6671686746987951, 'eval_recall': 0.7133655394524959, 'eval_f1': 0.6894941634241245, 'eval_accuracy': 0.987454566772189, 'eval_runtime': 5.9461, 'eval_samples_per_second': 254.453, 'eval_steps_per_second': 31.954, 'epoch': 11.0}
{'loss': 0.0003, 'grad_norm': 0.08922254294157028, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': 0.11791589111089706, 'eval_precision': 0.6676737160120846, 'eval_recall': 0.711755233494364, 'eval_f1': 0.6890101325019486, 'eval_accuracy': 0.9874936491186931, 'eval_runtime': 5.8843, 'eval_samples_per_second': 257.124, 'eval_steps_per_second': 32.289, 'epoch': 12.0}
{'train_runtime': 1172.2671, 'train_samples_per_second': 87.727, 'train_steps_per_second': 2.743, 'train_loss': 0.018697938997650623, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =     0.0187
  train_runtime            = 0:19:32.26
  train_samples            =       8570
  train_samples_per_second =     87.727
  train_steps_per_second   =      2.743
[{'loss': 0.122, 'grad_norm': 0.928861677646637, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 268}, {'eval_loss': 0.07031544297933578, 'eval_precision': 0.3276643990929705, 'eval_recall': 0.46537842190016104, 'eval_f1': 0.38456420492348636, 'eval_accuracy': 0.9796771798178763, 'eval_runtime': 6.1822, 'eval_samples_per_second': 244.734, 'eval_steps_per_second': 30.733, 'epoch': 1.0, 'step': 268}, {'loss': 0.0429, 'grad_norm': 1.5252529382705688, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 536}, {'eval_loss': 0.05272223427891731, 'eval_precision': 0.6671619613670133, 'eval_recall': 0.7230273752012882, 'eval_f1': 0.6939721792890262, 'eval_accuracy': 0.9877281431977176, 'eval_runtime': 5.9104, 'eval_samples_per_second': 255.989, 'eval_steps_per_second': 32.147, 'epoch': 2.0, 'step': 536}, {'loss': 0.0231, 'grad_norm': 1.2297533750534058, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 804}, {'eval_loss': 0.06846938282251358, 'eval_precision': 0.6938110749185668, 'eval_recall': 0.6859903381642513, 'eval_f1': 0.6898785425101215, 'eval_accuracy': 0.9880798843162544, 'eval_runtime': 5.8983, 'eval_samples_per_second': 256.515, 'eval_steps_per_second': 32.213, 'epoch': 3.0, 'step': 804}, {'loss': 0.0153, 'grad_norm': 0.8737732768058777, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 1072}, {'eval_loss': 0.054849881678819656, 'eval_precision': 0.6904400606980273, 'eval_recall': 0.7326892109500805, 'eval_f1': 0.7109375000000001, 'eval_accuracy': 0.988861531246336, 'eval_runtime': 5.8841, 'eval_samples_per_second': 257.133, 'eval_steps_per_second': 32.29, 'epoch': 4.0, 'step': 1072}, {'loss': 0.0082, 'grad_norm': 0.023433461785316467, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 1340}, {'eval_loss': 0.07477512955665588, 'eval_precision': 0.6479514415781487, 'eval_recall': 0.6876006441223832, 'eval_f1': 0.6671874999999999, 'eval_accuracy': 0.9877281431977176, 'eval_runtime': 5.8628, 'eval_samples_per_second': 258.068, 'eval_steps_per_second': 32.408, 'epoch': 5.0, 'step': 1340}, {'loss': 0.0056, 'grad_norm': 0.059981219470500946, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 1608}, {'eval_loss': 0.08401329815387726, 'eval_precision': 0.6656200941915228, 'eval_recall': 0.6827697262479872, 'eval_f1': 0.6740858505564389, 'eval_accuracy': 0.9873373197326768, 'eval_runtime': 5.8895, 'eval_samples_per_second': 256.896, 'eval_steps_per_second': 32.261, 'epoch': 6.0, 'step': 1608}, {'loss': 0.0033, 'grad_norm': 0.051061518490314484, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 1876}, {'eval_loss': 0.09332822263240814, 'eval_precision': 0.664624808575804, 'eval_recall': 0.6988727858293076, 'eval_f1': 0.6813186813186813, 'eval_accuracy': 0.9875718138117012, 'eval_runtime': 5.8783, 'eval_samples_per_second': 257.388, 'eval_steps_per_second': 32.322, 'epoch': 7.0, 'step': 1876}, {'loss': 0.0019, 'grad_norm': 0.017800068482756615, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 2144}, {'eval_loss': 0.10388097912073135, 'eval_precision': 0.6377025036818851, 'eval_recall': 0.6972624798711755, 'eval_f1': 0.6661538461538461, 'eval_accuracy': 0.9870246609606441, 'eval_runtime': 5.8578, 'eval_samples_per_second': 258.289, 'eval_steps_per_second': 32.435, 'epoch': 8.0, 'step': 2144}, {'loss': 0.001, 'grad_norm': 0.023334259167313576, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 2412}, {'eval_loss': 0.10785014182329178, 'eval_precision': 0.6898148148148148, 'eval_recall': 0.7198067632850241, 'eval_f1': 0.7044917257683214, 'eval_accuracy': 0.9883143783952788, 'eval_runtime': 5.9194, 'eval_samples_per_second': 255.6, 'eval_steps_per_second': 32.098, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0004, 'grad_norm': 0.0024147359654307365, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': 0.11538377404212952, 'eval_precision': 0.6731634182908546, 'eval_recall': 0.7230273752012882, 'eval_f1': 0.6972049689440993, 'eval_accuracy': 0.9881189666627584, 'eval_runtime': 6.0002, 'eval_samples_per_second': 252.157, 'eval_steps_per_second': 31.665, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0003, 'grad_norm': 0.026732413098216057, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 2948}, {'eval_loss': 0.11675581336021423, 'eval_precision': 0.6671686746987951, 'eval_recall': 0.7133655394524959, 'eval_f1': 0.6894941634241245, 'eval_accuracy': 0.987454566772189, 'eval_runtime': 5.9461, 'eval_samples_per_second': 254.453, 'eval_steps_per_second': 31.954, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0003, 'grad_norm': 0.08922254294157028, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': 0.11791589111089706, 'eval_precision': 0.6676737160120846, 'eval_recall': 0.711755233494364, 'eval_f1': 0.6890101325019486, 'eval_accuracy': 0.9874936491186931, 'eval_runtime': 5.8843, 'eval_samples_per_second': 257.124, 'eval_steps_per_second': 32.289, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1172.2671, 'train_samples_per_second': 87.727, 'train_steps_per_second': 2.743, 'total_flos': 1.1779075679469384e+16, 'train_loss': 0.018697938997650623, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9899
  predict_f1                 =     0.7008
  predict_loss               =     0.0454
  predict_precision          =       0.67
  predict_recall             =     0.7346
  predict_runtime            = 0:00:04.97
  predict_samples_per_second =    251.419
  predict_steps_per_second   =     31.528
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_303.json completed. F1: 0.7008368200836821
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_404.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_404.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 4927.74 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 5101.44 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6052.61 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6190.75 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6548.00 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 6869.29 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6957.10 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7173.34 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 5916.36 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 5182.31 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 3750.72 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4328.37 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3428.55 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-536 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9416, 'eval_samples_per_second': 254.645, 'eval_steps_per_second': 31.978, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.846, 'eval_samples_per_second': 258.81, 'eval_steps_per_second': 32.501, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8533, 'eval_samples_per_second': 258.487, 'eval_steps_per_second': 32.46, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8267, 'eval_samples_per_second': 259.666, 'eval_steps_per_second': 32.608, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8605, 'eval_samples_per_second': 258.169, 'eval_steps_per_second': 32.42, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8219, 'eval_samples_per_second': 259.879, 'eval_steps_per_second': 32.635, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8148, 'eval_samples_per_second': 260.198, 'eval_steps_per_second': 32.675, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8217, 'eval_samples_per_second': 259.889, 'eval_steps_per_second': 32.636, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8107, 'eval_samples_per_second': 260.382, 'eval_steps_per_second': 32.698, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8666, 'eval_samples_per_second': 257.902, 'eval_steps_per_second': 32.387, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9508, 'eval_samples_per_second': 254.252, 'eval_steps_per_second': 31.929, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7911, 'eval_samples_per_second': 261.264, 'eval_steps_per_second': 32.809, 'epoch': 12.0}
{'train_runtime': 1166.9185, 'train_samples_per_second': 88.13, 'train_steps_per_second': 2.756, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:26.91
  train_samples            =       8570
  train_samples_per_second =      88.13
  train_steps_per_second   =      2.756
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9416, 'eval_samples_per_second': 254.645, 'eval_steps_per_second': 31.978, 'epoch': 1.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.846, 'eval_samples_per_second': 258.81, 'eval_steps_per_second': 32.501, 'epoch': 2.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8533, 'eval_samples_per_second': 258.487, 'eval_steps_per_second': 32.46, 'epoch': 3.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8267, 'eval_samples_per_second': 259.666, 'eval_steps_per_second': 32.608, 'epoch': 4.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8605, 'eval_samples_per_second': 258.169, 'eval_steps_per_second': 32.42, 'epoch': 5.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8219, 'eval_samples_per_second': 259.879, 'eval_steps_per_second': 32.635, 'epoch': 6.0, 'step': 1608}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 1876}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8148, 'eval_samples_per_second': 260.198, 'eval_steps_per_second': 32.675, 'epoch': 7.0, 'step': 1876}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 2144}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8217, 'eval_samples_per_second': 259.889, 'eval_steps_per_second': 32.636, 'epoch': 8.0, 'step': 2144}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 2412}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8107, 'eval_samples_per_second': 260.382, 'eval_steps_per_second': 32.698, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8666, 'eval_samples_per_second': 257.902, 'eval_steps_per_second': 32.387, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 2948}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9508, 'eval_samples_per_second': 254.252, 'eval_steps_per_second': 31.929, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7911, 'eval_samples_per_second': 261.264, 'eval_steps_per_second': 32.809, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1166.9185, 'train_samples_per_second': 88.13, 'train_steps_per_second': 2.756, 'total_flos': 1.1777951355924468e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.88
  predict_samples_per_second =    256.408
  predict_steps_per_second   =     32.153
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_404.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_101.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_101.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 7311.49 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:00, 6778.97 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6330.43 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6444.25 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6729.71 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 7031.54 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 7070.54 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7244.35 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6404.40 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7348.91 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 3769.19 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4362.40 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 4051.30 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-268 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9284, 'eval_samples_per_second': 255.213, 'eval_steps_per_second': 32.049, 'epoch': 1.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8406, 'eval_samples_per_second': 259.05, 'eval_steps_per_second': 32.531, 'epoch': 2.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8438, 'eval_samples_per_second': 258.908, 'eval_steps_per_second': 32.513, 'epoch': 3.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8286, 'eval_samples_per_second': 259.58, 'eval_steps_per_second': 32.598, 'epoch': 4.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8493, 'eval_samples_per_second': 258.662, 'eval_steps_per_second': 32.482, 'epoch': 5.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9567, 'eval_samples_per_second': 253.999, 'eval_steps_per_second': 31.897, 'epoch': 6.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8633, 'eval_samples_per_second': 258.044, 'eval_steps_per_second': 32.405, 'epoch': 7.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8596, 'eval_samples_per_second': 258.207, 'eval_steps_per_second': 32.425, 'epoch': 8.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8434, 'eval_samples_per_second': 258.924, 'eval_steps_per_second': 32.515, 'epoch': 9.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8518, 'eval_samples_per_second': 258.554, 'eval_steps_per_second': 32.469, 'epoch': 10.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.838, 'eval_samples_per_second': 259.165, 'eval_steps_per_second': 32.546, 'epoch': 11.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8131, 'eval_samples_per_second': 260.272, 'eval_steps_per_second': 32.685, 'epoch': 12.0}
{'train_runtime': 1182.8219, 'train_samples_per_second': 86.945, 'train_steps_per_second': 1.359, 'train_loss': 2.397892017269609, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =     2.3979
  train_runtime            = 0:19:42.82
  train_samples            =       8570
  train_samples_per_second =     86.945
  train_steps_per_second   =      1.359
[{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 134}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9284, 'eval_samples_per_second': 255.213, 'eval_steps_per_second': 32.049, 'epoch': 1.0, 'step': 134}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 268}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8406, 'eval_samples_per_second': 259.05, 'eval_steps_per_second': 32.531, 'epoch': 2.0, 'step': 268}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 402}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8438, 'eval_samples_per_second': 258.908, 'eval_steps_per_second': 32.513, 'epoch': 3.0, 'step': 402}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 536}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8286, 'eval_samples_per_second': 259.58, 'eval_steps_per_second': 32.598, 'epoch': 4.0, 'step': 536}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 670}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8493, 'eval_samples_per_second': 258.662, 'eval_steps_per_second': 32.482, 'epoch': 5.0, 'step': 670}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 804}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9567, 'eval_samples_per_second': 253.999, 'eval_steps_per_second': 31.897, 'epoch': 6.0, 'step': 804}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 938}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8633, 'eval_samples_per_second': 258.044, 'eval_steps_per_second': 32.405, 'epoch': 7.0, 'step': 938}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 1072}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8596, 'eval_samples_per_second': 258.207, 'eval_steps_per_second': 32.425, 'epoch': 8.0, 'step': 1072}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 1206}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8434, 'eval_samples_per_second': 258.924, 'eval_steps_per_second': 32.515, 'epoch': 9.0, 'step': 1206}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8518, 'eval_samples_per_second': 258.554, 'eval_steps_per_second': 32.469, 'epoch': 10.0, 'step': 1340}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 1474}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.838, 'eval_samples_per_second': 259.165, 'eval_steps_per_second': 32.546, 'epoch': 11.0, 'step': 1474}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8131, 'eval_samples_per_second': 260.272, 'eval_steps_per_second': 32.685, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1182.8219, 'train_samples_per_second': 86.945, 'train_steps_per_second': 1.359, 'total_flos': 1.344059664784122e+16, 'train_loss': 2.397892017269609, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =     2.3979
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.90
  predict_samples_per_second =    255.468
  predict_steps_per_second   =     32.035
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_101.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_101.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_101.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 6544.67 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 5100.48 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 5839.85 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 5992.44 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6414.57 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 6775.55 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6894.42 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7103.57 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6259.88 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7289.50 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 6221.28 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4333.85 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3742.41 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-134 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9841, 'eval_samples_per_second': 252.837, 'eval_steps_per_second': 31.751, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9424, 'eval_samples_per_second': 254.611, 'eval_steps_per_second': 31.974, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.94, 'eval_samples_per_second': 254.715, 'eval_steps_per_second': 31.987, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9305, 'eval_samples_per_second': 255.121, 'eval_steps_per_second': 32.038, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8788, 'eval_samples_per_second': 257.366, 'eval_steps_per_second': 32.32, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9847, 'eval_samples_per_second': 252.813, 'eval_steps_per_second': 31.748, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9468, 'eval_samples_per_second': 254.423, 'eval_steps_per_second': 31.95, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9011, 'eval_samples_per_second': 256.393, 'eval_steps_per_second': 32.197, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8898, 'eval_samples_per_second': 256.886, 'eval_steps_per_second': 32.259, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.072, 'eval_samples_per_second': 249.177, 'eval_steps_per_second': 31.291, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9169, 'eval_samples_per_second': 255.706, 'eval_steps_per_second': 32.111, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9186, 'eval_samples_per_second': 255.634, 'eval_steps_per_second': 32.102, 'epoch': 12.0}
{'train_runtime': 1181.4046, 'train_samples_per_second': 87.049, 'train_steps_per_second': 1.361, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:41.40
  train_samples            =       8570
  train_samples_per_second =     87.049
  train_steps_per_second   =      1.361
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 134}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9841, 'eval_samples_per_second': 252.837, 'eval_steps_per_second': 31.751, 'epoch': 1.0, 'step': 134}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9424, 'eval_samples_per_second': 254.611, 'eval_steps_per_second': 31.974, 'epoch': 2.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 402}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.94, 'eval_samples_per_second': 254.715, 'eval_steps_per_second': 31.987, 'epoch': 3.0, 'step': 402}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9305, 'eval_samples_per_second': 255.121, 'eval_steps_per_second': 32.038, 'epoch': 4.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 670}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8788, 'eval_samples_per_second': 257.366, 'eval_steps_per_second': 32.32, 'epoch': 5.0, 'step': 670}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9847, 'eval_samples_per_second': 252.813, 'eval_steps_per_second': 31.748, 'epoch': 6.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 938}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9468, 'eval_samples_per_second': 254.423, 'eval_steps_per_second': 31.95, 'epoch': 7.0, 'step': 938}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9011, 'eval_samples_per_second': 256.393, 'eval_steps_per_second': 32.197, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 1206}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8898, 'eval_samples_per_second': 256.886, 'eval_steps_per_second': 32.259, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.072, 'eval_samples_per_second': 249.177, 'eval_steps_per_second': 31.291, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 1474}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9169, 'eval_samples_per_second': 255.706, 'eval_steps_per_second': 32.111, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9186, 'eval_samples_per_second': 255.634, 'eval_steps_per_second': 32.102, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1181.4046, 'train_samples_per_second': 87.049, 'train_steps_per_second': 1.361, 'total_flos': 1.344059664784122e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.96
  predict_samples_per_second =    252.395
  predict_steps_per_second   =      31.65
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_101.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_505.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_505.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:02, 3414.77 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 4268.08 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:01, 5106.84 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:01, 3994.24 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:01<00:00, 4769.94 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:01<00:00, 5442.92 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 5879.85 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 6321.35 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 4913.03 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7237.94 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 3819.19 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4324.35 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:03<00:00, 365.92 examples/s] 
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.3997, 'eval_samples_per_second': 236.419, 'eval_steps_per_second': 29.689, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8816, 'eval_samples_per_second': 257.242, 'eval_steps_per_second': 32.304, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8996, 'eval_samples_per_second': 256.46, 'eval_steps_per_second': 32.206, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8995, 'eval_samples_per_second': 256.463, 'eval_steps_per_second': 32.206, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8925, 'eval_samples_per_second': 256.768, 'eval_steps_per_second': 32.245, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8944, 'eval_samples_per_second': 256.682, 'eval_steps_per_second': 32.234, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8641, 'eval_samples_per_second': 258.011, 'eval_steps_per_second': 32.401, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8592, 'eval_samples_per_second': 258.226, 'eval_steps_per_second': 32.428, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8693, 'eval_samples_per_second': 257.783, 'eval_steps_per_second': 32.372, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.1706, 'eval_samples_per_second': 245.194, 'eval_steps_per_second': 30.791, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9036, 'eval_samples_per_second': 256.285, 'eval_steps_per_second': 32.184, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9083, 'eval_samples_per_second': 256.078, 'eval_steps_per_second': 32.158, 'epoch': 12.0}
{'train_runtime': 1174.0332, 'train_samples_per_second': 87.595, 'train_steps_per_second': 2.739, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:34.03
  train_samples            =       8570
  train_samples_per_second =     87.595
  train_steps_per_second   =      2.739
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.3997, 'eval_samples_per_second': 236.419, 'eval_steps_per_second': 29.689, 'epoch': 1.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8816, 'eval_samples_per_second': 257.242, 'eval_steps_per_second': 32.304, 'epoch': 2.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8996, 'eval_samples_per_second': 256.46, 'eval_steps_per_second': 32.206, 'epoch': 3.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8995, 'eval_samples_per_second': 256.463, 'eval_steps_per_second': 32.206, 'epoch': 4.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8925, 'eval_samples_per_second': 256.768, 'eval_steps_per_second': 32.245, 'epoch': 5.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8944, 'eval_samples_per_second': 256.682, 'eval_steps_per_second': 32.234, 'epoch': 6.0, 'step': 1608}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 1876}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8641, 'eval_samples_per_second': 258.011, 'eval_steps_per_second': 32.401, 'epoch': 7.0, 'step': 1876}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 2144}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8592, 'eval_samples_per_second': 258.226, 'eval_steps_per_second': 32.428, 'epoch': 8.0, 'step': 2144}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 2412}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8693, 'eval_samples_per_second': 257.783, 'eval_steps_per_second': 32.372, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.1706, 'eval_samples_per_second': 245.194, 'eval_steps_per_second': 30.791, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 2948}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9036, 'eval_samples_per_second': 256.285, 'eval_steps_per_second': 32.184, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9083, 'eval_samples_per_second': 256.078, 'eval_steps_per_second': 32.158, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1174.0332, 'train_samples_per_second': 87.595, 'train_steps_per_second': 2.739, 'total_flos': 1.1820017066289432e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.95
  predict_samples_per_second =    252.475
  predict_steps_per_second   =      31.66
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_505.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_202.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_202.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 4850.96 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 3826.83 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:01, 5000.35 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 5225.72 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 5824.84 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:01<00:00, 6350.43 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6586.21 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 6888.98 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 5552.14 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7257.72 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 3686.10 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 3924.99 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 2559.80 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-268 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.8969, 'grad_norm': 2.0091655254364014, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': 0.16160210967063904, 'eval_precision': 0.22291407222914073, 'eval_recall': 0.2882447665056361, 'eval_f1': 0.2514044943820225, 'eval_accuracy': 0.9746746394653535, 'eval_runtime': 6.0035, 'eval_samples_per_second': 252.021, 'eval_steps_per_second': 31.648, 'epoch': 1.0}
{'loss': 0.0973, 'grad_norm': 0.7128599286079407, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': 0.08368714898824692, 'eval_precision': 0.44751381215469616, 'eval_recall': 0.5217391304347826, 'eval_f1': 0.48178438661710044, 'eval_accuracy': 0.9812404736780397, 'eval_runtime': 5.8621, 'eval_samples_per_second': 258.1, 'eval_steps_per_second': 32.412, 'epoch': 2.0}
{'loss': 0.0611, 'grad_norm': 0.39874303340911865, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': 0.0651906430721283, 'eval_precision': 0.6282051282051282, 'eval_recall': 0.6312399355877617, 'eval_f1': 0.629718875502008, 'eval_accuracy': 0.9842888967053582, 'eval_runtime': 5.9418, 'eval_samples_per_second': 254.635, 'eval_steps_per_second': 31.977, 'epoch': 3.0}
{'loss': 0.0459, 'grad_norm': 0.3066602945327759, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': 0.05844005197286606, 'eval_precision': 0.673469387755102, 'eval_recall': 0.6908212560386473, 'eval_f1': 0.6820349761526231, 'eval_accuracy': 0.9873764020791809, 'eval_runtime': 5.9075, 'eval_samples_per_second': 256.117, 'eval_steps_per_second': 32.163, 'epoch': 4.0}
{'loss': 0.037, 'grad_norm': 0.6141569018363953, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': 0.05648414418101311, 'eval_precision': 0.6592920353982301, 'eval_recall': 0.7198067632850241, 'eval_f1': 0.6882217090069285, 'eval_accuracy': 0.9876108961582053, 'eval_runtime': 5.8916, 'eval_samples_per_second': 256.808, 'eval_steps_per_second': 32.25, 'epoch': 5.0}
{'loss': 0.0298, 'grad_norm': 0.6072406768798828, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': 0.055609092116355896, 'eval_precision': 0.6825885978428351, 'eval_recall': 0.7133655394524959, 'eval_f1': 0.6976377952755906, 'eval_accuracy': 0.9875327314651972, 'eval_runtime': 5.8723, 'eval_samples_per_second': 257.651, 'eval_steps_per_second': 32.355, 'epoch': 6.0}
{'loss': 0.0244, 'grad_norm': 0.6688739061355591, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': 0.05657903850078583, 'eval_precision': 0.6466165413533834, 'eval_recall': 0.6924315619967794, 'eval_f1': 0.6687402799377916, 'eval_accuracy': 0.9868292492281237, 'eval_runtime': 5.8885, 'eval_samples_per_second': 256.942, 'eval_steps_per_second': 32.266, 'epoch': 7.0}
{'loss': 0.0214, 'grad_norm': 0.14042633771896362, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': 0.05797874927520752, 'eval_precision': 0.6584615384615384, 'eval_recall': 0.6892109500805152, 'eval_f1': 0.6734854445318647, 'eval_accuracy': 0.9872591550396685, 'eval_runtime': 5.9076, 'eval_samples_per_second': 256.111, 'eval_steps_per_second': 32.162, 'epoch': 8.0}
{'loss': 0.0188, 'grad_norm': 0.7401527166366577, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': 0.058757342398166656, 'eval_precision': 0.6381679389312978, 'eval_recall': 0.6731078904991948, 'eval_f1': 0.6551724137931035, 'eval_accuracy': 0.9866338374956032, 'eval_runtime': 5.8701, 'eval_samples_per_second': 257.748, 'eval_steps_per_second': 32.368, 'epoch': 9.0}
{'loss': 0.0173, 'grad_norm': 0.33766475319862366, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': 0.05834595859050751, 'eval_precision': 0.6630434782608695, 'eval_recall': 0.6876006441223832, 'eval_f1': 0.6750988142292489, 'eval_accuracy': 0.9871809903466604, 'eval_runtime': 5.9011, 'eval_samples_per_second': 256.391, 'eval_steps_per_second': 32.197, 'epoch': 10.0}
{'loss': 0.0165, 'grad_norm': 0.10801027715206146, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': 0.058513492345809937, 'eval_precision': 0.6661466458658346, 'eval_recall': 0.6876006441223832, 'eval_f1': 0.676703645007924, 'eval_accuracy': 0.9870246609606441, 'eval_runtime': 5.8909, 'eval_samples_per_second': 256.835, 'eval_steps_per_second': 32.253, 'epoch': 11.0}
{'loss': 0.0158, 'grad_norm': 0.2665192484855652, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': 0.059556204825639725, 'eval_precision': 0.6583850931677019, 'eval_recall': 0.6827697262479872, 'eval_f1': 0.6703557312252965, 'eval_accuracy': 0.9871028256536523, 'eval_runtime': 5.8683, 'eval_samples_per_second': 257.825, 'eval_steps_per_second': 32.377, 'epoch': 12.0}
{'train_runtime': 1176.6718, 'train_samples_per_second': 87.399, 'train_steps_per_second': 2.733, 'train_loss': 0.10686015356239395, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =     0.1069
  train_runtime            = 0:19:36.67
  train_samples            =       8570
  train_samples_per_second =     87.399
  train_steps_per_second   =      2.733
[{'loss': 0.8969, 'grad_norm': 2.0091655254364014, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 268}, {'eval_loss': 0.16160210967063904, 'eval_precision': 0.22291407222914073, 'eval_recall': 0.2882447665056361, 'eval_f1': 0.2514044943820225, 'eval_accuracy': 0.9746746394653535, 'eval_runtime': 6.0035, 'eval_samples_per_second': 252.021, 'eval_steps_per_second': 31.648, 'epoch': 1.0, 'step': 268}, {'loss': 0.0973, 'grad_norm': 0.7128599286079407, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 536}, {'eval_loss': 0.08368714898824692, 'eval_precision': 0.44751381215469616, 'eval_recall': 0.5217391304347826, 'eval_f1': 0.48178438661710044, 'eval_accuracy': 0.9812404736780397, 'eval_runtime': 5.8621, 'eval_samples_per_second': 258.1, 'eval_steps_per_second': 32.412, 'epoch': 2.0, 'step': 536}, {'loss': 0.0611, 'grad_norm': 0.39874303340911865, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 804}, {'eval_loss': 0.0651906430721283, 'eval_precision': 0.6282051282051282, 'eval_recall': 0.6312399355877617, 'eval_f1': 0.629718875502008, 'eval_accuracy': 0.9842888967053582, 'eval_runtime': 5.9418, 'eval_samples_per_second': 254.635, 'eval_steps_per_second': 31.977, 'epoch': 3.0, 'step': 804}, {'loss': 0.0459, 'grad_norm': 0.3066602945327759, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 1072}, {'eval_loss': 0.05844005197286606, 'eval_precision': 0.673469387755102, 'eval_recall': 0.6908212560386473, 'eval_f1': 0.6820349761526231, 'eval_accuracy': 0.9873764020791809, 'eval_runtime': 5.9075, 'eval_samples_per_second': 256.117, 'eval_steps_per_second': 32.163, 'epoch': 4.0, 'step': 1072}, {'loss': 0.037, 'grad_norm': 0.6141569018363953, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 1340}, {'eval_loss': 0.05648414418101311, 'eval_precision': 0.6592920353982301, 'eval_recall': 0.7198067632850241, 'eval_f1': 0.6882217090069285, 'eval_accuracy': 0.9876108961582053, 'eval_runtime': 5.8916, 'eval_samples_per_second': 256.808, 'eval_steps_per_second': 32.25, 'epoch': 5.0, 'step': 1340}, {'loss': 0.0298, 'grad_norm': 0.6072406768798828, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 1608}, {'eval_loss': 0.055609092116355896, 'eval_precision': 0.6825885978428351, 'eval_recall': 0.7133655394524959, 'eval_f1': 0.6976377952755906, 'eval_accuracy': 0.9875327314651972, 'eval_runtime': 5.8723, 'eval_samples_per_second': 257.651, 'eval_steps_per_second': 32.355, 'epoch': 6.0, 'step': 1608}, {'loss': 0.0244, 'grad_norm': 0.6688739061355591, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 1876}, {'eval_loss': 0.05657903850078583, 'eval_precision': 0.6466165413533834, 'eval_recall': 0.6924315619967794, 'eval_f1': 0.6687402799377916, 'eval_accuracy': 0.9868292492281237, 'eval_runtime': 5.8885, 'eval_samples_per_second': 256.942, 'eval_steps_per_second': 32.266, 'epoch': 7.0, 'step': 1876}, {'loss': 0.0214, 'grad_norm': 0.14042633771896362, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 2144}, {'eval_loss': 0.05797874927520752, 'eval_precision': 0.6584615384615384, 'eval_recall': 0.6892109500805152, 'eval_f1': 0.6734854445318647, 'eval_accuracy': 0.9872591550396685, 'eval_runtime': 5.9076, 'eval_samples_per_second': 256.111, 'eval_steps_per_second': 32.162, 'epoch': 8.0, 'step': 2144}, {'loss': 0.0188, 'grad_norm': 0.7401527166366577, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 2412}, {'eval_loss': 0.058757342398166656, 'eval_precision': 0.6381679389312978, 'eval_recall': 0.6731078904991948, 'eval_f1': 0.6551724137931035, 'eval_accuracy': 0.9866338374956032, 'eval_runtime': 5.8701, 'eval_samples_per_second': 257.748, 'eval_steps_per_second': 32.368, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0173, 'grad_norm': 0.33766475319862366, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': 0.05834595859050751, 'eval_precision': 0.6630434782608695, 'eval_recall': 0.6876006441223832, 'eval_f1': 0.6750988142292489, 'eval_accuracy': 0.9871809903466604, 'eval_runtime': 5.9011, 'eval_samples_per_second': 256.391, 'eval_steps_per_second': 32.197, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0165, 'grad_norm': 0.10801027715206146, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 2948}, {'eval_loss': 0.058513492345809937, 'eval_precision': 0.6661466458658346, 'eval_recall': 0.6876006441223832, 'eval_f1': 0.676703645007924, 'eval_accuracy': 0.9870246609606441, 'eval_runtime': 5.8909, 'eval_samples_per_second': 256.835, 'eval_steps_per_second': 32.253, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0158, 'grad_norm': 0.2665192484855652, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': 0.059556204825639725, 'eval_precision': 0.6583850931677019, 'eval_recall': 0.6827697262479872, 'eval_f1': 0.6703557312252965, 'eval_accuracy': 0.9871028256536523, 'eval_runtime': 5.8683, 'eval_samples_per_second': 257.825, 'eval_steps_per_second': 32.377, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1176.6718, 'train_samples_per_second': 87.399, 'train_steps_per_second': 2.733, 'total_flos': 1.177790769287418e+16, 'train_loss': 0.10686015356239395, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9892
  predict_f1                 =     0.7058
  predict_loss               =     0.0463
  predict_precision          =     0.6754
  predict_recall             =      0.739
  predict_runtime            = 0:00:04.96
  predict_samples_per_second =    252.049
  predict_steps_per_second   =     31.607
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_202.json completed. F1: 0.705759162303665
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_202.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_202.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 7215.71 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 5343.18 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 5796.47 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6246.84 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6534.67 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 6858.72 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6901.91 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7094.68 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6253.13 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 6053.93 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 3738.15 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4299.95 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3195.11 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-1608 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9886, 'eval_samples_per_second': 252.648, 'eval_steps_per_second': 31.727, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8938, 'eval_samples_per_second': 256.711, 'eval_steps_per_second': 32.237, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9207, 'eval_samples_per_second': 255.543, 'eval_steps_per_second': 32.091, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7932, 'eval_samples_per_second': 261.166, 'eval_steps_per_second': 32.797, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8869, 'eval_samples_per_second': 257.011, 'eval_steps_per_second': 32.275, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8999, 'eval_samples_per_second': 256.444, 'eval_steps_per_second': 32.204, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9133, 'eval_samples_per_second': 255.864, 'eval_steps_per_second': 32.131, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9544, 'eval_samples_per_second': 254.098, 'eval_steps_per_second': 31.909, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9062, 'eval_samples_per_second': 256.173, 'eval_steps_per_second': 32.17, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8854, 'eval_samples_per_second': 257.078, 'eval_steps_per_second': 32.283, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8515, 'eval_samples_per_second': 258.567, 'eval_steps_per_second': 32.47, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8671, 'eval_samples_per_second': 257.879, 'eval_steps_per_second': 32.384, 'epoch': 12.0}
{'train_runtime': 1169.7376, 'train_samples_per_second': 87.917, 'train_steps_per_second': 2.749, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:29.73
  train_samples            =       8570
  train_samples_per_second =     87.917
  train_steps_per_second   =      2.749
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9886, 'eval_samples_per_second': 252.648, 'eval_steps_per_second': 31.727, 'epoch': 1.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8938, 'eval_samples_per_second': 256.711, 'eval_steps_per_second': 32.237, 'epoch': 2.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9207, 'eval_samples_per_second': 255.543, 'eval_steps_per_second': 32.091, 'epoch': 3.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7932, 'eval_samples_per_second': 261.166, 'eval_steps_per_second': 32.797, 'epoch': 4.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8869, 'eval_samples_per_second': 257.011, 'eval_steps_per_second': 32.275, 'epoch': 5.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8999, 'eval_samples_per_second': 256.444, 'eval_steps_per_second': 32.204, 'epoch': 6.0, 'step': 1608}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 1876}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9133, 'eval_samples_per_second': 255.864, 'eval_steps_per_second': 32.131, 'epoch': 7.0, 'step': 1876}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 2144}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9544, 'eval_samples_per_second': 254.098, 'eval_steps_per_second': 31.909, 'epoch': 8.0, 'step': 2144}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 2412}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9062, 'eval_samples_per_second': 256.173, 'eval_steps_per_second': 32.17, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8854, 'eval_samples_per_second': 257.078, 'eval_steps_per_second': 32.283, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 2948}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8515, 'eval_samples_per_second': 258.567, 'eval_steps_per_second': 32.47, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8671, 'eval_samples_per_second': 257.879, 'eval_steps_per_second': 32.384, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1169.7376, 'train_samples_per_second': 87.917, 'train_steps_per_second': 2.749, 'total_flos': 1.177790769287418e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.93
  predict_samples_per_second =    253.886
  predict_steps_per_second   =     31.837
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_202.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_505.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_505.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 6398.47 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 5478.71 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6090.06 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6295.74 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6599.67 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 6908.43 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6937.75 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7098.01 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6159.04 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7143.45 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 3751.45 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4239.48 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3000.29 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-268 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 6.8516, 'grad_norm': 491.1483154296875, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': 1.3438438177108765, 'eval_precision': 0.4057142857142857, 'eval_recall': 0.571658615136876, 'eval_f1': 0.4745989304812834, 'eval_accuracy': 0.9768632508695823, 'eval_runtime': 6.0608, 'eval_samples_per_second': 249.639, 'eval_steps_per_second': 31.349, 'epoch': 1.0}
{'loss': 1.823, 'grad_norm': 57.11756134033203, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': 1.3931760787963867, 'eval_precision': 0.2396788990825688, 'eval_recall': 0.3365539452495974, 'eval_f1': 0.27997320830542527, 'eval_accuracy': 0.9760034392464924, 'eval_runtime': 5.9, 'eval_samples_per_second': 256.442, 'eval_steps_per_second': 32.204, 'epoch': 2.0}
{'loss': 1.1115, 'grad_norm': 142.7116241455078, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': 1.640677809715271, 'eval_precision': 0.1928817451205511, 'eval_recall': 0.27053140096618356, 'eval_f1': 0.22520107238605896, 'eval_accuracy': 0.9719779575565717, 'eval_runtime': 5.9125, 'eval_samples_per_second': 255.899, 'eval_steps_per_second': 32.135, 'epoch': 3.0}
{'loss': 0.6854, 'grad_norm': 131.33778381347656, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': 1.1929377317428589, 'eval_precision': 0.494949494949495, 'eval_recall': 0.6312399355877617, 'eval_f1': 0.5548478414720454, 'eval_accuracy': 0.973463086723727, 'eval_runtime': 5.8236, 'eval_samples_per_second': 259.806, 'eval_steps_per_second': 32.626, 'epoch': 4.0}
{'loss': 0.4303, 'grad_norm': 18.030454635620117, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': 1.1543147563934326, 'eval_precision': 0.5120967741935484, 'eval_recall': 0.6135265700483091, 'eval_f1': 0.5582417582417583, 'eval_accuracy': 0.9813577207175519, 'eval_runtime': 5.9004, 'eval_samples_per_second': 256.422, 'eval_steps_per_second': 32.201, 'epoch': 5.0}
{'loss': 0.2608, 'grad_norm': 43.40476608276367, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': 1.1590919494628906, 'eval_precision': 0.5704607046070461, 'eval_recall': 0.677938808373591, 'eval_f1': 0.6195732155997057, 'eval_accuracy': 0.9843279790518623, 'eval_runtime': 5.9294, 'eval_samples_per_second': 255.169, 'eval_steps_per_second': 32.044, 'epoch': 6.0}
{'loss': 0.2048, 'grad_norm': 3.3149516582489014, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': 1.1633920669555664, 'eval_precision': 0.6304023845007451, 'eval_recall': 0.6811594202898551, 'eval_f1': 0.6547987616099071, 'eval_accuracy': 0.9850314612889358, 'eval_runtime': 5.9515, 'eval_samples_per_second': 254.223, 'eval_steps_per_second': 31.925, 'epoch': 7.0}
{'loss': 0.1279, 'grad_norm': 5.16098690032959, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': 0.9897288084030151, 'eval_precision': 0.6239193083573487, 'eval_recall': 0.6972624798711755, 'eval_f1': 0.6585551330798478, 'eval_accuracy': 0.9862039316840583, 'eval_runtime': 5.8549, 'eval_samples_per_second': 258.417, 'eval_steps_per_second': 32.452, 'epoch': 8.0}
{'loss': 0.0965, 'grad_norm': 5.7671685218811035, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': 1.1699410676956177, 'eval_precision': 0.6165951359084406, 'eval_recall': 0.6940418679549114, 'eval_f1': 0.653030303030303, 'eval_accuracy': 0.9854222847539766, 'eval_runtime': 5.8363, 'eval_samples_per_second': 259.238, 'eval_steps_per_second': 32.555, 'epoch': 9.0}
{'loss': 0.0701, 'grad_norm': 5.469101905822754, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': 1.1275533437728882, 'eval_precision': 0.6305916305916306, 'eval_recall': 0.7037037037037037, 'eval_f1': 0.665144596651446, 'eval_accuracy': 0.9860085199515379, 'eval_runtime': 5.8647, 'eval_samples_per_second': 257.984, 'eval_steps_per_second': 32.397, 'epoch': 10.0}
{'loss': 0.0468, 'grad_norm': 1.885923147201538, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': 1.073804497718811, 'eval_precision': 0.6592592592592592, 'eval_recall': 0.71658615136876, 'eval_f1': 0.6867283950617284, 'eval_accuracy': 0.9872200726931645, 'eval_runtime': 5.7592, 'eval_samples_per_second': 262.708, 'eval_steps_per_second': 32.99, 'epoch': 11.0}
{'loss': 0.0429, 'grad_norm': 12.69792366027832, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': 1.0815908908843994, 'eval_precision': 0.65, 'eval_recall': 0.711755233494364, 'eval_f1': 0.679477325134512, 'eval_accuracy': 0.9871419080001563, 'eval_runtime': 5.8357, 'eval_samples_per_second': 259.264, 'eval_steps_per_second': 32.558, 'epoch': 12.0}
{'train_runtime': 1172.0725, 'train_samples_per_second': 87.742, 'train_steps_per_second': 2.744, 'train_loss': 0.979287591443133, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =     0.9793
  train_runtime            = 0:19:32.07
  train_samples            =       8570
  train_samples_per_second =     87.742
  train_steps_per_second   =      2.744
[{'loss': 6.8516, 'grad_norm': 491.1483154296875, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 268}, {'eval_loss': 1.3438438177108765, 'eval_precision': 0.4057142857142857, 'eval_recall': 0.571658615136876, 'eval_f1': 0.4745989304812834, 'eval_accuracy': 0.9768632508695823, 'eval_runtime': 6.0608, 'eval_samples_per_second': 249.639, 'eval_steps_per_second': 31.349, 'epoch': 1.0, 'step': 268}, {'loss': 1.823, 'grad_norm': 57.11756134033203, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 536}, {'eval_loss': 1.3931760787963867, 'eval_precision': 0.2396788990825688, 'eval_recall': 0.3365539452495974, 'eval_f1': 0.27997320830542527, 'eval_accuracy': 0.9760034392464924, 'eval_runtime': 5.9, 'eval_samples_per_second': 256.442, 'eval_steps_per_second': 32.204, 'epoch': 2.0, 'step': 536}, {'loss': 1.1115, 'grad_norm': 142.7116241455078, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 804}, {'eval_loss': 1.640677809715271, 'eval_precision': 0.1928817451205511, 'eval_recall': 0.27053140096618356, 'eval_f1': 0.22520107238605896, 'eval_accuracy': 0.9719779575565717, 'eval_runtime': 5.9125, 'eval_samples_per_second': 255.899, 'eval_steps_per_second': 32.135, 'epoch': 3.0, 'step': 804}, {'loss': 0.6854, 'grad_norm': 131.33778381347656, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 1072}, {'eval_loss': 1.1929377317428589, 'eval_precision': 0.494949494949495, 'eval_recall': 0.6312399355877617, 'eval_f1': 0.5548478414720454, 'eval_accuracy': 0.973463086723727, 'eval_runtime': 5.8236, 'eval_samples_per_second': 259.806, 'eval_steps_per_second': 32.626, 'epoch': 4.0, 'step': 1072}, {'loss': 0.4303, 'grad_norm': 18.030454635620117, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 1340}, {'eval_loss': 1.1543147563934326, 'eval_precision': 0.5120967741935484, 'eval_recall': 0.6135265700483091, 'eval_f1': 0.5582417582417583, 'eval_accuracy': 0.9813577207175519, 'eval_runtime': 5.9004, 'eval_samples_per_second': 256.422, 'eval_steps_per_second': 32.201, 'epoch': 5.0, 'step': 1340}, {'loss': 0.2608, 'grad_norm': 43.40476608276367, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 1608}, {'eval_loss': 1.1590919494628906, 'eval_precision': 0.5704607046070461, 'eval_recall': 0.677938808373591, 'eval_f1': 0.6195732155997057, 'eval_accuracy': 0.9843279790518623, 'eval_runtime': 5.9294, 'eval_samples_per_second': 255.169, 'eval_steps_per_second': 32.044, 'epoch': 6.0, 'step': 1608}, {'loss': 0.2048, 'grad_norm': 3.3149516582489014, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 1876}, {'eval_loss': 1.1633920669555664, 'eval_precision': 0.6304023845007451, 'eval_recall': 0.6811594202898551, 'eval_f1': 0.6547987616099071, 'eval_accuracy': 0.9850314612889358, 'eval_runtime': 5.9515, 'eval_samples_per_second': 254.223, 'eval_steps_per_second': 31.925, 'epoch': 7.0, 'step': 1876}, {'loss': 0.1279, 'grad_norm': 5.16098690032959, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 2144}, {'eval_loss': 0.9897288084030151, 'eval_precision': 0.6239193083573487, 'eval_recall': 0.6972624798711755, 'eval_f1': 0.6585551330798478, 'eval_accuracy': 0.9862039316840583, 'eval_runtime': 5.8549, 'eval_samples_per_second': 258.417, 'eval_steps_per_second': 32.452, 'epoch': 8.0, 'step': 2144}, {'loss': 0.0965, 'grad_norm': 5.7671685218811035, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 2412}, {'eval_loss': 1.1699410676956177, 'eval_precision': 0.6165951359084406, 'eval_recall': 0.6940418679549114, 'eval_f1': 0.653030303030303, 'eval_accuracy': 0.9854222847539766, 'eval_runtime': 5.8363, 'eval_samples_per_second': 259.238, 'eval_steps_per_second': 32.555, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0701, 'grad_norm': 5.469101905822754, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': 1.1275533437728882, 'eval_precision': 0.6305916305916306, 'eval_recall': 0.7037037037037037, 'eval_f1': 0.665144596651446, 'eval_accuracy': 0.9860085199515379, 'eval_runtime': 5.8647, 'eval_samples_per_second': 257.984, 'eval_steps_per_second': 32.397, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0468, 'grad_norm': 1.885923147201538, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 2948}, {'eval_loss': 1.073804497718811, 'eval_precision': 0.6592592592592592, 'eval_recall': 0.71658615136876, 'eval_f1': 0.6867283950617284, 'eval_accuracy': 0.9872200726931645, 'eval_runtime': 5.7592, 'eval_samples_per_second': 262.708, 'eval_steps_per_second': 32.99, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0429, 'grad_norm': 12.69792366027832, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': 1.0815908908843994, 'eval_precision': 0.65, 'eval_recall': 0.711755233494364, 'eval_f1': 0.679477325134512, 'eval_accuracy': 0.9871419080001563, 'eval_runtime': 5.8357, 'eval_samples_per_second': 259.264, 'eval_steps_per_second': 32.558, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1172.0725, 'train_samples_per_second': 87.742, 'train_steps_per_second': 2.744, 'total_flos': 1.1820017066289432e+16, 'train_loss': 0.979287591443133, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9882
  predict_f1                 =     0.6557
  predict_loss               =     1.0128
  predict_precision          =     0.6154
  predict_recall             =     0.7018
  predict_runtime            = 0:00:04.89
  predict_samples_per_second =     255.98
  predict_steps_per_second   =       32.1
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_505.json completed. F1: 0.6557377049180328
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_404.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_404.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 6989.02 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 5604.36 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 5652.67 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 5180.75 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 5758.64 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:01<00:00, 6261.39 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6490.26 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 6768.97 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6037.19 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7172.18 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 4543.26 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4298.86 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 2592.99 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0095, 'eval_samples_per_second': 251.769, 'eval_steps_per_second': 31.617, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8463, 'eval_samples_per_second': 258.795, 'eval_steps_per_second': 32.499, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8579, 'eval_samples_per_second': 258.284, 'eval_steps_per_second': 32.435, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8845, 'eval_samples_per_second': 257.117, 'eval_steps_per_second': 32.288, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8864, 'eval_samples_per_second': 257.031, 'eval_steps_per_second': 32.278, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9515, 'eval_samples_per_second': 254.221, 'eval_steps_per_second': 31.925, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8706, 'eval_samples_per_second': 257.725, 'eval_steps_per_second': 32.365, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8619, 'eval_samples_per_second': 258.108, 'eval_steps_per_second': 32.413, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8553, 'eval_samples_per_second': 258.399, 'eval_steps_per_second': 32.449, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.833, 'eval_samples_per_second': 259.387, 'eval_steps_per_second': 32.573, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8409, 'eval_samples_per_second': 259.035, 'eval_steps_per_second': 32.529, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8209, 'eval_samples_per_second': 259.926, 'eval_steps_per_second': 32.641, 'epoch': 12.0}
{'train_runtime': 1178.3447, 'train_samples_per_second': 87.275, 'train_steps_per_second': 1.365, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:38.34
  train_samples            =       8570
  train_samples_per_second =     87.275
  train_steps_per_second   =      1.365
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 134}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0095, 'eval_samples_per_second': 251.769, 'eval_steps_per_second': 31.617, 'epoch': 1.0, 'step': 134}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8463, 'eval_samples_per_second': 258.795, 'eval_steps_per_second': 32.499, 'epoch': 2.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 402}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8579, 'eval_samples_per_second': 258.284, 'eval_steps_per_second': 32.435, 'epoch': 3.0, 'step': 402}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8845, 'eval_samples_per_second': 257.117, 'eval_steps_per_second': 32.288, 'epoch': 4.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 670}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8864, 'eval_samples_per_second': 257.031, 'eval_steps_per_second': 32.278, 'epoch': 5.0, 'step': 670}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9515, 'eval_samples_per_second': 254.221, 'eval_steps_per_second': 31.925, 'epoch': 6.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 938}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8706, 'eval_samples_per_second': 257.725, 'eval_steps_per_second': 32.365, 'epoch': 7.0, 'step': 938}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8619, 'eval_samples_per_second': 258.108, 'eval_steps_per_second': 32.413, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 1206}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8553, 'eval_samples_per_second': 258.399, 'eval_steps_per_second': 32.449, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.833, 'eval_samples_per_second': 259.387, 'eval_steps_per_second': 32.573, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 1474}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8409, 'eval_samples_per_second': 259.035, 'eval_steps_per_second': 32.529, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8209, 'eval_samples_per_second': 259.926, 'eval_steps_per_second': 32.641, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1178.3447, 'train_samples_per_second': 87.275, 'train_steps_per_second': 1.365, 'total_flos': 1.3398687396739788e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.88
  predict_samples_per_second =    256.182
  predict_steps_per_second   =     32.125
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_404.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_404.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_404.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:02, 2555.82 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 3655.97 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:01, 4484.27 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:01<00:01, 3280.74 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:01<00:00, 4087.76 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:01<00:00, 4859.40 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 5408.78 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 5961.55 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 4605.61 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7201.54 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 4541.98 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4280.56 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3729.13 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-134 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 1.0288, 'grad_norm': 0.5731481909751892, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': 0.08743728697299957, 'eval_precision': 0.22087912087912087, 'eval_recall': 0.32367149758454106, 'eval_f1': 0.26257348138471587, 'eval_accuracy': 0.9751827099699066, 'eval_runtime': 5.9563, 'eval_samples_per_second': 254.018, 'eval_steps_per_second': 31.899, 'epoch': 1.0}
{'loss': 0.0647, 'grad_norm': 0.17927084863185883, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': 0.05951204150915146, 'eval_precision': 0.6086286594761171, 'eval_recall': 0.6360708534621579, 'eval_f1': 0.6220472440944882, 'eval_accuracy': 0.9835854144682846, 'eval_runtime': 5.8961, 'eval_samples_per_second': 256.612, 'eval_steps_per_second': 32.225, 'epoch': 2.0}
{'loss': 0.0423, 'grad_norm': 0.2474563866853714, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': 0.05800238996744156, 'eval_precision': 0.6737357259380098, 'eval_recall': 0.6650563607085346, 'eval_f1': 0.6693679092382495, 'eval_accuracy': 0.9868292492281237, 'eval_runtime': 5.8997, 'eval_samples_per_second': 256.453, 'eval_steps_per_second': 32.205, 'epoch': 3.0}
{'loss': 0.0299, 'grad_norm': 0.3054586350917816, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': 0.054896071553230286, 'eval_precision': 0.5754857997010463, 'eval_recall': 0.6199677938808373, 'eval_f1': 0.5968992248062015, 'eval_accuracy': 0.9843279790518623, 'eval_runtime': 5.8878, 'eval_samples_per_second': 256.972, 'eval_steps_per_second': 32.27, 'epoch': 4.0}
{'loss': 0.0215, 'grad_norm': 0.2898614704608917, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': 0.05353066697716713, 'eval_precision': 0.654434250764526, 'eval_recall': 0.6892109500805152, 'eval_f1': 0.6713725490196077, 'eval_accuracy': 0.9867510845351155, 'eval_runtime': 5.8936, 'eval_samples_per_second': 256.72, 'eval_steps_per_second': 32.238, 'epoch': 5.0}
{'loss': 0.0148, 'grad_norm': 0.13582053780555725, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': 0.05081525072455406, 'eval_precision': 0.6993865030674846, 'eval_recall': 0.7342995169082126, 'eval_f1': 0.716417910447761, 'eval_accuracy': 0.9885879548208074, 'eval_runtime': 5.9905, 'eval_samples_per_second': 252.567, 'eval_steps_per_second': 31.717, 'epoch': 6.0}
{'loss': 0.0106, 'grad_norm': 0.06541990488767624, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': 0.05628931149840355, 'eval_precision': 0.648036253776435, 'eval_recall': 0.6908212560386473, 'eval_f1': 0.6687451286048324, 'eval_accuracy': 0.9874936491186931, 'eval_runtime': 5.886, 'eval_samples_per_second': 257.051, 'eval_steps_per_second': 32.28, 'epoch': 7.0}
{'loss': 0.0084, 'grad_norm': 0.0628286674618721, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': 0.06263528764247894, 'eval_precision': 0.6184798807749627, 'eval_recall': 0.6682769726247987, 'eval_f1': 0.6424148606811145, 'eval_accuracy': 0.9857740258725134, 'eval_runtime': 5.9832, 'eval_samples_per_second': 252.874, 'eval_steps_per_second': 31.756, 'epoch': 8.0}
{'loss': 0.0074, 'grad_norm': 0.06599107384681702, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': 0.059262216091156006, 'eval_precision': 0.6881720430107527, 'eval_recall': 0.7214170692431562, 'eval_f1': 0.7044025157232705, 'eval_accuracy': 0.987962637276742, 'eval_runtime': 5.8781, 'eval_samples_per_second': 257.396, 'eval_steps_per_second': 32.323, 'epoch': 9.0}
{'loss': 0.0067, 'grad_norm': 0.04257367551326752, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': 0.059628553688526154, 'eval_precision': 0.6890243902439024, 'eval_recall': 0.7278582930756844, 'eval_f1': 0.7079091620986687, 'eval_accuracy': 0.9880408019697503, 'eval_runtime': 5.8821, 'eval_samples_per_second': 257.221, 'eval_steps_per_second': 32.301, 'epoch': 10.0}
{'loss': 0.0064, 'grad_norm': 0.11107046902179718, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': 0.06023075804114342, 'eval_precision': 0.6881720430107527, 'eval_recall': 0.7214170692431562, 'eval_f1': 0.7044025157232705, 'eval_accuracy': 0.9880408019697503, 'eval_runtime': 5.9844, 'eval_samples_per_second': 252.824, 'eval_steps_per_second': 31.749, 'epoch': 11.0}
{'loss': 0.0062, 'grad_norm': 0.012301208451390266, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': 0.0606587752699852, 'eval_precision': 0.6886503067484663, 'eval_recall': 0.7230273752012882, 'eval_f1': 0.7054202670856246, 'eval_accuracy': 0.9880408019697503, 'eval_runtime': 5.9075, 'eval_samples_per_second': 256.117, 'eval_steps_per_second': 32.163, 'epoch': 12.0}
{'train_runtime': 1189.9375, 'train_samples_per_second': 86.425, 'train_steps_per_second': 1.351, 'train_loss': 0.10397791784645906, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =      0.104
  train_runtime            = 0:19:49.93
  train_samples            =       8570
  train_samples_per_second =     86.425
  train_steps_per_second   =      1.351
[{'loss': 1.0288, 'grad_norm': 0.5731481909751892, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 134}, {'eval_loss': 0.08743728697299957, 'eval_precision': 0.22087912087912087, 'eval_recall': 0.32367149758454106, 'eval_f1': 0.26257348138471587, 'eval_accuracy': 0.9751827099699066, 'eval_runtime': 5.9563, 'eval_samples_per_second': 254.018, 'eval_steps_per_second': 31.899, 'epoch': 1.0, 'step': 134}, {'loss': 0.0647, 'grad_norm': 0.17927084863185883, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 268}, {'eval_loss': 0.05951204150915146, 'eval_precision': 0.6086286594761171, 'eval_recall': 0.6360708534621579, 'eval_f1': 0.6220472440944882, 'eval_accuracy': 0.9835854144682846, 'eval_runtime': 5.8961, 'eval_samples_per_second': 256.612, 'eval_steps_per_second': 32.225, 'epoch': 2.0, 'step': 268}, {'loss': 0.0423, 'grad_norm': 0.2474563866853714, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 402}, {'eval_loss': 0.05800238996744156, 'eval_precision': 0.6737357259380098, 'eval_recall': 0.6650563607085346, 'eval_f1': 0.6693679092382495, 'eval_accuracy': 0.9868292492281237, 'eval_runtime': 5.8997, 'eval_samples_per_second': 256.453, 'eval_steps_per_second': 32.205, 'epoch': 3.0, 'step': 402}, {'loss': 0.0299, 'grad_norm': 0.3054586350917816, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 536}, {'eval_loss': 0.054896071553230286, 'eval_precision': 0.5754857997010463, 'eval_recall': 0.6199677938808373, 'eval_f1': 0.5968992248062015, 'eval_accuracy': 0.9843279790518623, 'eval_runtime': 5.8878, 'eval_samples_per_second': 256.972, 'eval_steps_per_second': 32.27, 'epoch': 4.0, 'step': 536}, {'loss': 0.0215, 'grad_norm': 0.2898614704608917, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 670}, {'eval_loss': 0.05353066697716713, 'eval_precision': 0.654434250764526, 'eval_recall': 0.6892109500805152, 'eval_f1': 0.6713725490196077, 'eval_accuracy': 0.9867510845351155, 'eval_runtime': 5.8936, 'eval_samples_per_second': 256.72, 'eval_steps_per_second': 32.238, 'epoch': 5.0, 'step': 670}, {'loss': 0.0148, 'grad_norm': 0.13582053780555725, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 804}, {'eval_loss': 0.05081525072455406, 'eval_precision': 0.6993865030674846, 'eval_recall': 0.7342995169082126, 'eval_f1': 0.716417910447761, 'eval_accuracy': 0.9885879548208074, 'eval_runtime': 5.9905, 'eval_samples_per_second': 252.567, 'eval_steps_per_second': 31.717, 'epoch': 6.0, 'step': 804}, {'loss': 0.0106, 'grad_norm': 0.06541990488767624, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 938}, {'eval_loss': 0.05628931149840355, 'eval_precision': 0.648036253776435, 'eval_recall': 0.6908212560386473, 'eval_f1': 0.6687451286048324, 'eval_accuracy': 0.9874936491186931, 'eval_runtime': 5.886, 'eval_samples_per_second': 257.051, 'eval_steps_per_second': 32.28, 'epoch': 7.0, 'step': 938}, {'loss': 0.0084, 'grad_norm': 0.0628286674618721, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 1072}, {'eval_loss': 0.06263528764247894, 'eval_precision': 0.6184798807749627, 'eval_recall': 0.6682769726247987, 'eval_f1': 0.6424148606811145, 'eval_accuracy': 0.9857740258725134, 'eval_runtime': 5.9832, 'eval_samples_per_second': 252.874, 'eval_steps_per_second': 31.756, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0074, 'grad_norm': 0.06599107384681702, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 1206}, {'eval_loss': 0.059262216091156006, 'eval_precision': 0.6881720430107527, 'eval_recall': 0.7214170692431562, 'eval_f1': 0.7044025157232705, 'eval_accuracy': 0.987962637276742, 'eval_runtime': 5.8781, 'eval_samples_per_second': 257.396, 'eval_steps_per_second': 32.323, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0067, 'grad_norm': 0.04257367551326752, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': 0.059628553688526154, 'eval_precision': 0.6890243902439024, 'eval_recall': 0.7278582930756844, 'eval_f1': 0.7079091620986687, 'eval_accuracy': 0.9880408019697503, 'eval_runtime': 5.8821, 'eval_samples_per_second': 257.221, 'eval_steps_per_second': 32.301, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0064, 'grad_norm': 0.11107046902179718, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 1474}, {'eval_loss': 0.06023075804114342, 'eval_precision': 0.6881720430107527, 'eval_recall': 0.7214170692431562, 'eval_f1': 0.7044025157232705, 'eval_accuracy': 0.9880408019697503, 'eval_runtime': 5.9844, 'eval_samples_per_second': 252.824, 'eval_steps_per_second': 31.749, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0062, 'grad_norm': 0.012301208451390266, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': 0.0606587752699852, 'eval_precision': 0.6886503067484663, 'eval_recall': 0.7230273752012882, 'eval_f1': 0.7054202670856246, 'eval_accuracy': 0.9880408019697503, 'eval_runtime': 5.9075, 'eval_samples_per_second': 256.117, 'eval_steps_per_second': 32.163, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1189.9375, 'train_samples_per_second': 86.425, 'train_steps_per_second': 1.351, 'total_flos': 1.3398687396739788e+16, 'train_loss': 0.10397791784645906, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9909
  predict_f1                 =     0.7505
  predict_loss               =     0.0433
  predict_precision          =     0.7189
  predict_recall             =     0.7851
  predict_runtime            = 0:00:05.04
  predict_samples_per_second =    248.088
  predict_steps_per_second   =      31.11
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_404.json completed. F1: 0.750524109014675
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_303.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_303.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 5652.78 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 4505.09 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 5583.19 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 5114.86 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 5717.06 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:01<00:00, 6136.31 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6323.80 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 6571.85 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 5599.59 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 6764.82 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 4883.10 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4123.27 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3151.74 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-804 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9184, 'eval_samples_per_second': 255.641, 'eval_steps_per_second': 32.103, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8757, 'eval_samples_per_second': 257.502, 'eval_steps_per_second': 32.337, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8631, 'eval_samples_per_second': 258.054, 'eval_steps_per_second': 32.406, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.876, 'eval_samples_per_second': 257.486, 'eval_steps_per_second': 32.335, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8564, 'eval_samples_per_second': 258.352, 'eval_steps_per_second': 32.443, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9118, 'eval_samples_per_second': 255.928, 'eval_steps_per_second': 32.139, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8134, 'eval_samples_per_second': 260.263, 'eval_steps_per_second': 32.683, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8859, 'eval_samples_per_second': 257.057, 'eval_steps_per_second': 32.281, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8288, 'eval_samples_per_second': 259.574, 'eval_steps_per_second': 32.597, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8339, 'eval_samples_per_second': 259.347, 'eval_steps_per_second': 32.568, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8782, 'eval_samples_per_second': 257.393, 'eval_steps_per_second': 32.323, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7964, 'eval_samples_per_second': 261.026, 'eval_steps_per_second': 32.779, 'epoch': 12.0}
{'train_runtime': 1183.5387, 'train_samples_per_second': 86.892, 'train_steps_per_second': 1.359, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:43.53
  train_samples            =       8570
  train_samples_per_second =     86.892
  train_steps_per_second   =      1.359
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 134}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9184, 'eval_samples_per_second': 255.641, 'eval_steps_per_second': 32.103, 'epoch': 1.0, 'step': 134}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8757, 'eval_samples_per_second': 257.502, 'eval_steps_per_second': 32.337, 'epoch': 2.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 402}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8631, 'eval_samples_per_second': 258.054, 'eval_steps_per_second': 32.406, 'epoch': 3.0, 'step': 402}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.876, 'eval_samples_per_second': 257.486, 'eval_steps_per_second': 32.335, 'epoch': 4.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 670}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8564, 'eval_samples_per_second': 258.352, 'eval_steps_per_second': 32.443, 'epoch': 5.0, 'step': 670}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9118, 'eval_samples_per_second': 255.928, 'eval_steps_per_second': 32.139, 'epoch': 6.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 938}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8134, 'eval_samples_per_second': 260.263, 'eval_steps_per_second': 32.683, 'epoch': 7.0, 'step': 938}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8859, 'eval_samples_per_second': 257.057, 'eval_steps_per_second': 32.281, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 1206}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8288, 'eval_samples_per_second': 259.574, 'eval_steps_per_second': 32.597, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8339, 'eval_samples_per_second': 259.347, 'eval_steps_per_second': 32.568, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 1474}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8782, 'eval_samples_per_second': 257.393, 'eval_steps_per_second': 32.323, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.7964, 'eval_samples_per_second': 261.026, 'eval_steps_per_second': 32.779, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1183.5387, 'train_samples_per_second': 86.892, 'train_steps_per_second': 1.359, 'total_flos': 1.3424881588325064e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.92
  predict_samples_per_second =    254.435
  predict_steps_per_second   =     31.906
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_06_303.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_303.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_303.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 7063.02 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 6209.03 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6885.16 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 7095.49 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 7179.46 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 7369.98 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:00<00:00, 7308.87 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7401.82 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6472.37 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 6472.23 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 4180.74 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4328.63 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3456.59 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-134 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9852, 'eval_samples_per_second': 252.792, 'eval_steps_per_second': 31.745, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9009, 'eval_samples_per_second': 256.402, 'eval_steps_per_second': 32.198, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.909, 'eval_samples_per_second': 256.05, 'eval_steps_per_second': 32.154, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9195, 'eval_samples_per_second': 255.595, 'eval_steps_per_second': 32.097, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9136, 'eval_samples_per_second': 255.851, 'eval_steps_per_second': 32.129, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0038, 'eval_samples_per_second': 252.007, 'eval_steps_per_second': 31.647, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.902, 'eval_samples_per_second': 256.356, 'eval_steps_per_second': 32.193, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9048, 'eval_samples_per_second': 256.232, 'eval_steps_per_second': 32.177, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.993, 'eval_samples_per_second': 252.461, 'eval_steps_per_second': 31.704, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9307, 'eval_samples_per_second': 255.115, 'eval_steps_per_second': 32.037, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9043, 'eval_samples_per_second': 256.255, 'eval_steps_per_second': 32.18, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9202, 'eval_samples_per_second': 255.564, 'eval_steps_per_second': 32.093, 'epoch': 12.0}
{'train_runtime': 1183.5735, 'train_samples_per_second': 86.889, 'train_steps_per_second': 1.359, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:43.57
  train_samples            =       8570
  train_samples_per_second =     86.889
  train_steps_per_second   =      1.359
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 134}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9852, 'eval_samples_per_second': 252.792, 'eval_steps_per_second': 31.745, 'epoch': 1.0, 'step': 134}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9009, 'eval_samples_per_second': 256.402, 'eval_steps_per_second': 32.198, 'epoch': 2.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 402}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.909, 'eval_samples_per_second': 256.05, 'eval_steps_per_second': 32.154, 'epoch': 3.0, 'step': 402}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9195, 'eval_samples_per_second': 255.595, 'eval_steps_per_second': 32.097, 'epoch': 4.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 670}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9136, 'eval_samples_per_second': 255.851, 'eval_steps_per_second': 32.129, 'epoch': 5.0, 'step': 670}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0038, 'eval_samples_per_second': 252.007, 'eval_steps_per_second': 31.647, 'epoch': 6.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 938}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.902, 'eval_samples_per_second': 256.356, 'eval_steps_per_second': 32.193, 'epoch': 7.0, 'step': 938}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9048, 'eval_samples_per_second': 256.232, 'eval_steps_per_second': 32.177, 'epoch': 8.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 1206}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.993, 'eval_samples_per_second': 252.461, 'eval_steps_per_second': 31.704, 'epoch': 9.0, 'step': 1206}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9307, 'eval_samples_per_second': 255.115, 'eval_steps_per_second': 32.037, 'epoch': 10.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 1474}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9043, 'eval_samples_per_second': 256.255, 'eval_steps_per_second': 32.18, 'epoch': 11.0, 'step': 1474}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9202, 'eval_samples_per_second': 255.564, 'eval_steps_per_second': 32.093, 'epoch': 12.0, 'step': 1608}, {'train_runtime': 1183.5735, 'train_samples_per_second': 86.889, 'train_steps_per_second': 1.359, 'total_flos': 1.3424881588325064e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 1608}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.96
  predict_samples_per_second =    252.072
  predict_steps_per_second   =      31.61
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_09_303.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_404.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_404.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 6795.20 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 6527.92 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6749.70 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6951.87 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 7034.47 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 7201.24 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:00<00:00, 7155.90 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7261.56 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6693.99 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 6499.86 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 2814.72 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4267.01 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 2207.40 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9765, 'eval_samples_per_second': 253.158, 'eval_steps_per_second': 31.791, 'epoch': 1.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9626, 'eval_samples_per_second': 253.747, 'eval_steps_per_second': 31.865, 'epoch': 2.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9188, 'eval_samples_per_second': 255.627, 'eval_steps_per_second': 32.101, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9233, 'eval_samples_per_second': 255.431, 'eval_steps_per_second': 32.077, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9109, 'eval_samples_per_second': 255.969, 'eval_steps_per_second': 32.144, 'epoch': 5.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9408, 'eval_samples_per_second': 254.681, 'eval_steps_per_second': 31.982, 'epoch': 6.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9153, 'eval_samples_per_second': 255.776, 'eval_steps_per_second': 32.12, 'epoch': 7.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0128, 'eval_samples_per_second': 251.632, 'eval_steps_per_second': 31.599, 'epoch': 8.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9309, 'eval_samples_per_second': 255.104, 'eval_steps_per_second': 32.036, 'epoch': 9.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.997, 'eval_samples_per_second': 252.294, 'eval_steps_per_second': 31.683, 'epoch': 10.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0104, 'eval_samples_per_second': 251.73, 'eval_steps_per_second': 31.612, 'epoch': 11.0}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.6058, 'eval_samples_per_second': 229.04, 'eval_steps_per_second': 28.762, 'epoch': 12.0}
{'train_runtime': 1171.3862, 'train_samples_per_second': 87.793, 'train_steps_per_second': 2.745, 'train_loss': 0.0, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =        0.0
  train_runtime            = 0:19:31.38
  train_samples            =       8570
  train_samples_per_second =     87.793
  train_steps_per_second   =      2.745
[{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 268}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9765, 'eval_samples_per_second': 253.158, 'eval_steps_per_second': 31.791, 'epoch': 1.0, 'step': 268}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 536}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9626, 'eval_samples_per_second': 253.747, 'eval_steps_per_second': 31.865, 'epoch': 2.0, 'step': 536}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 804}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9188, 'eval_samples_per_second': 255.627, 'eval_steps_per_second': 32.101, 'epoch': 3.0, 'step': 804}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 1072}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9233, 'eval_samples_per_second': 255.431, 'eval_steps_per_second': 32.077, 'epoch': 4.0, 'step': 1072}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 1340}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9109, 'eval_samples_per_second': 255.969, 'eval_steps_per_second': 32.144, 'epoch': 5.0, 'step': 1340}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 1608}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9408, 'eval_samples_per_second': 254.681, 'eval_steps_per_second': 31.982, 'epoch': 6.0, 'step': 1608}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 1876}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9153, 'eval_samples_per_second': 255.776, 'eval_steps_per_second': 32.12, 'epoch': 7.0, 'step': 1876}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 2144}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0128, 'eval_samples_per_second': 251.632, 'eval_steps_per_second': 31.599, 'epoch': 8.0, 'step': 2144}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 2412}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9309, 'eval_samples_per_second': 255.104, 'eval_steps_per_second': 32.036, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.997, 'eval_samples_per_second': 252.294, 'eval_steps_per_second': 31.683, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 2948}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0104, 'eval_samples_per_second': 251.73, 'eval_steps_per_second': 31.612, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': nan, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.6058, 'eval_samples_per_second': 229.04, 'eval_steps_per_second': 28.762, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1171.3862, 'train_samples_per_second': 87.793, 'train_steps_per_second': 2.745, 'total_flos': 1.1777951355924468e+16, 'train_loss': 0.0, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =        nan
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.98
  predict_samples_per_second =    251.205
  predict_steps_per_second   =     31.501
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_404.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_303.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_303.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 7323.19 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 6151.95 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6180.13 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6297.80 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6613.28 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 6909.36 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 6926.76 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7097.67 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 5966.67 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7243.72 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 4154.24 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4273.69 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 3299.45 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-268 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0461, 'eval_samples_per_second': 250.246, 'eval_steps_per_second': 31.425, 'epoch': 1.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.894, 'eval_samples_per_second': 256.7, 'eval_steps_per_second': 32.236, 'epoch': 2.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9009, 'eval_samples_per_second': 256.4, 'eval_steps_per_second': 32.198, 'epoch': 3.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0345, 'eval_samples_per_second': 250.725, 'eval_steps_per_second': 31.486, 'epoch': 4.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8457, 'eval_samples_per_second': 258.821, 'eval_steps_per_second': 32.502, 'epoch': 5.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 5e-06, 'epoch': 6.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8339, 'eval_samples_per_second': 259.347, 'eval_steps_per_second': 32.568, 'epoch': 6.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8859, 'eval_samples_per_second': 257.055, 'eval_steps_per_second': 32.281, 'epoch': 7.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8339, 'eval_samples_per_second': 259.348, 'eval_steps_per_second': 32.568, 'epoch': 8.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 2.5e-06, 'epoch': 9.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9007, 'eval_samples_per_second': 256.408, 'eval_steps_per_second': 32.199, 'epoch': 9.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8936, 'eval_samples_per_second': 256.718, 'eval_steps_per_second': 32.238, 'epoch': 10.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9045, 'eval_samples_per_second': 256.244, 'eval_steps_per_second': 32.179, 'epoch': 11.0}
{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8778, 'eval_samples_per_second': 257.409, 'eval_steps_per_second': 32.325, 'epoch': 12.0}
{'train_runtime': 1171.4657, 'train_samples_per_second': 87.787, 'train_steps_per_second': 2.745, 'train_loss': 2.397890252260426, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =     2.3979
  train_runtime            = 0:19:31.46
  train_samples            =       8570
  train_samples_per_second =     87.787
  train_steps_per_second   =      2.745
[{'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 9.166666666666666e-06, 'epoch': 1.0, 'step': 268}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0461, 'eval_samples_per_second': 250.246, 'eval_steps_per_second': 31.425, 'epoch': 1.0, 'step': 268}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 8.333333333333334e-06, 'epoch': 2.0, 'step': 536}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.894, 'eval_samples_per_second': 256.7, 'eval_steps_per_second': 32.236, 'epoch': 2.0, 'step': 536}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 7.500000000000001e-06, 'epoch': 3.0, 'step': 804}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9009, 'eval_samples_per_second': 256.4, 'eval_steps_per_second': 32.198, 'epoch': 3.0, 'step': 804}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.0, 'step': 1072}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 6.0345, 'eval_samples_per_second': 250.725, 'eval_steps_per_second': 31.486, 'epoch': 4.0, 'step': 1072}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 5.833333333333334e-06, 'epoch': 5.0, 'step': 1340}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8457, 'eval_samples_per_second': 258.821, 'eval_steps_per_second': 32.502, 'epoch': 5.0, 'step': 1340}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 5e-06, 'epoch': 6.0, 'step': 1608}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8339, 'eval_samples_per_second': 259.347, 'eval_steps_per_second': 32.568, 'epoch': 6.0, 'step': 1608}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 4.166666666666667e-06, 'epoch': 7.0, 'step': 1876}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8859, 'eval_samples_per_second': 257.055, 'eval_steps_per_second': 32.281, 'epoch': 7.0, 'step': 1876}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.0, 'step': 2144}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8339, 'eval_samples_per_second': 259.348, 'eval_steps_per_second': 32.568, 'epoch': 8.0, 'step': 2144}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 2.5e-06, 'epoch': 9.0, 'step': 2412}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9007, 'eval_samples_per_second': 256.408, 'eval_steps_per_second': 32.199, 'epoch': 9.0, 'step': 2412}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 1.6666666666666667e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8936, 'eval_samples_per_second': 256.718, 'eval_steps_per_second': 32.238, 'epoch': 10.0, 'step': 2680}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 8.333333333333333e-07, 'epoch': 11.0, 'step': 2948}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.9045, 'eval_samples_per_second': 256.244, 'eval_steps_per_second': 32.179, 'epoch': 11.0, 'step': 2948}, {'loss': 2.3979, 'grad_norm': inf, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': 2.397895336151123, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9625200297025833, 'eval_runtime': 5.8778, 'eval_samples_per_second': 257.409, 'eval_steps_per_second': 32.325, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1171.4657, 'train_samples_per_second': 87.787, 'train_steps_per_second': 2.745, 'total_flos': 1.1779075679469384e+16, 'train_loss': 2.397890252260426, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =     0.9679
  predict_f1                 =        0.0
  predict_loss               =     2.3979
  predict_precision          =        0.0
  predict_recall             =        0.0
  predict_runtime            = 0:00:04.93
  predict_samples_per_second =    253.676
  predict_steps_per_second   =     31.811
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_00_303.json completed. F1: 0.0
/cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_101.json
/cluster/shared/nlpl/software/eb/packages/nlpl-python-candy/01-foss-2022b-Python-3.10.8/lib/python3.10/site-packages/pydot.py:17: UserWarning: `pydot` could not import `dot_parser`, so `pydot` will be unable to parse DOT files. The error was:  No module named 'pyparsing'
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/cluster/shared/nlpl/software/eb/packages/nlpl-pytorch/2.1.2-foss-2022b-cuda-12.0.0-Python-3.10.8/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Numpy: 1.24.4
PyTorch: 2.1.2
Transformers: 4.38.2



***Loading config file: /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_101.json
03091023_elsa-intensity_norbert3-large Our label2id: {'O': 0, 'B-Negative_Slight': 1, 'I-Negative_Slight': 2, 'B-Negative_Standard': 3, 'I-Negative_Standard': 4, 'B-Neutral': 5, 'I-Neutral': 6, 'B-Positive_Slight': 7, 'I-Positive_Slight': 8, 'B-Positive_Standard': 9, 'I-Positive_Standard': 10}
Running tokenizer on train dataset:   0%|          | 0/8570 [00:00<?, ? examples/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Running tokenizer on train dataset:  12%|█▏        | 1000/8570 [00:00<00:01, 5747.84 examples/s]Running tokenizer on train dataset:  23%|██▎       | 2000/8570 [00:00<00:01, 5702.37 examples/s]Running tokenizer on train dataset:  35%|███▌      | 3000/8570 [00:00<00:00, 6424.88 examples/s]Running tokenizer on train dataset:  47%|████▋     | 4000/8570 [00:00<00:00, 6466.66 examples/s]Running tokenizer on train dataset:  58%|█████▊    | 5000/8570 [00:00<00:00, 6703.27 examples/s]Running tokenizer on train dataset:  70%|███████   | 6000/8570 [00:00<00:00, 6982.26 examples/s]Running tokenizer on train dataset:  82%|████████▏ | 7000/8570 [00:01<00:00, 7014.05 examples/s]Running tokenizer on train dataset:  93%|█████████▎| 8000/8570 [00:01<00:00, 7161.42 examples/s]Running tokenizer on train dataset: 100%|██████████| 8570/8570 [00:01<00:00, 6322.34 examples/s]
Running tokenizer on validation dataset:   0%|          | 0/1513 [00:00<?, ? examples/s]Running tokenizer on validation dataset:  66%|██████▌   | 1000/1513 [00:00<00:00, 7221.97 examples/s]Running tokenizer on validation dataset: 100%|██████████| 1513/1513 [00:00<00:00, 4726.78 examples/s]
Running tokenizer on test dataset:   0%|          | 0/1252 [00:00<?, ? examples/s]Running tokenizer on test dataset:  80%|███████▉  | 1000/1252 [00:00<00:00, 4153.43 examples/s]Running tokenizer on test dataset: 100%|██████████| 1252/1252 [00:00<00:00, 2936.42 examples/s]
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Checkpoint destination directory /cluster/work/users/egilron/finetunes/03091023_elsa-intensity_norbert3-large/checkpoint-268 already exists and is non-empty. Saving will proceed but saved results may be invalid.
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/work/users/egilron/venvs/transformers_a100/lib/python3.10/site-packages/seqeval/metrics/v1.py:57: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
03091023_elsa-intensity_norbert3-large Ready to train. Train dataset labels are now: ['sent_id', 'tokens', 'elsa_labels', 'entity', 'input_ids', 'token_type_ids', 'attention_mask', 'labels']
{'loss': 0.2936, 'grad_norm': 0.3603750169277191, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0}
{'eval_loss': 0.08182453364133835, 'eval_precision': 0.2437357630979499, 'eval_recall': 0.3446054750402576, 'eval_f1': 0.28552368245497, 'eval_accuracy': 0.9758861922069801, 'eval_runtime': 6.0813, 'eval_samples_per_second': 248.797, 'eval_steps_per_second': 31.243, 'epoch': 1.0}
{'loss': 0.0621, 'grad_norm': 0.3335112929344177, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0}
{'eval_loss': 0.06725738197565079, 'eval_precision': 0.5859030837004405, 'eval_recall': 0.642512077294686, 'eval_f1': 0.6129032258064515, 'eval_accuracy': 0.9825692734591784, 'eval_runtime': 5.996, 'eval_samples_per_second': 252.334, 'eval_steps_per_second': 31.688, 'epoch': 2.0}
{'loss': 0.0489, 'grad_norm': 0.6670600771903992, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0}
{'eval_loss': 0.06508239358663559, 'eval_precision': 0.544973544973545, 'eval_recall': 0.6634460547504025, 'eval_f1': 0.59840232389252, 'eval_accuracy': 0.9827256028451948, 'eval_runtime': 5.975, 'eval_samples_per_second': 253.22, 'eval_steps_per_second': 31.799, 'epoch': 3.0}
{'loss': 0.0383, 'grad_norm': 0.748274028301239, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0}
{'eval_loss': 0.06412997096776962, 'eval_precision': 0.6320610687022901, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6489028213166144, 'eval_accuracy': 0.986516590456091, 'eval_runtime': 5.8815, 'eval_samples_per_second': 257.249, 'eval_steps_per_second': 32.305, 'epoch': 4.0}
{'loss': 0.0313, 'grad_norm': 0.19151520729064941, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0}
{'eval_loss': 0.06256505846977234, 'eval_precision': 0.626453488372093, 'eval_recall': 0.6940418679549114, 'eval_f1': 0.6585179526355996, 'eval_accuracy': 0.9860866846445461, 'eval_runtime': 5.9969, 'eval_samples_per_second': 252.296, 'eval_steps_per_second': 31.683, 'epoch': 5.0}
{'loss': 0.026, 'grad_norm': 0.5988292098045349, 'learning_rate': 2.5e-05, 'epoch': 6.0}
{'eval_loss': 0.0643669068813324, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.6763285024154589, 'eval_f1': 0.6714628297362111, 'eval_accuracy': 0.9873764020791809, 'eval_runtime': 5.963, 'eval_samples_per_second': 253.73, 'eval_steps_per_second': 31.863, 'epoch': 6.0}
{'loss': 0.0223, 'grad_norm': 0.5306894183158875, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0}
{'eval_loss': 0.06306583434343338, 'eval_precision': 0.6842105263157895, 'eval_recall': 0.7326892109500805, 'eval_f1': 0.7076205287713843, 'eval_accuracy': 0.9875718138117012, 'eval_runtime': 5.9356, 'eval_samples_per_second': 254.901, 'eval_steps_per_second': 32.01, 'epoch': 7.0}
{'loss': 0.0198, 'grad_norm': 0.2826365530490875, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0}
{'eval_loss': 0.06526315212249756, 'eval_precision': 0.6167400881057269, 'eval_recall': 0.6763285024154589, 'eval_f1': 0.6451612903225806, 'eval_accuracy': 0.9854613671004807, 'eval_runtime': 5.9343, 'eval_samples_per_second': 254.96, 'eval_steps_per_second': 32.017, 'epoch': 8.0}
{'loss': 0.0185, 'grad_norm': 0.10697690397500992, 'learning_rate': 1.25e-05, 'epoch': 9.0}
{'eval_loss': 0.06350889801979065, 'eval_precision': 0.6587887740029542, 'eval_recall': 0.7181964573268921, 'eval_f1': 0.687211093990755, 'eval_accuracy': 0.9869074139211318, 'eval_runtime': 5.9706, 'eval_samples_per_second': 253.41, 'eval_steps_per_second': 31.823, 'epoch': 9.0}
{'loss': 0.0173, 'grad_norm': 0.27904149889945984, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': 0.06493796408176422, 'eval_precision': 0.6472303206997084, 'eval_recall': 0.714975845410628, 'eval_f1': 0.6794185156847742, 'eval_accuracy': 0.9862820963770664, 'eval_runtime': 5.9971, 'eval_samples_per_second': 252.29, 'eval_steps_per_second': 31.682, 'epoch': 10.0}
{'loss': 0.0167, 'grad_norm': 0.07662376761436462, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0}
{'eval_loss': 0.06456692516803741, 'eval_precision': 0.6646706586826348, 'eval_recall': 0.714975845410628, 'eval_f1': 0.6889061287820014, 'eval_accuracy': 0.98698557861414, 'eval_runtime': 5.9285, 'eval_samples_per_second': 255.207, 'eval_steps_per_second': 32.048, 'epoch': 11.0}
{'loss': 0.0161, 'grad_norm': 0.2542739808559418, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': 0.06402674317359924, 'eval_precision': 0.6701807228915663, 'eval_recall': 0.71658615136876, 'eval_f1': 0.6926070038910506, 'eval_accuracy': 0.9872591550396685, 'eval_runtime': 5.8992, 'eval_samples_per_second': 256.476, 'eval_steps_per_second': 32.208, 'epoch': 12.0}
{'train_runtime': 1172.3774, 'train_samples_per_second': 87.719, 'train_steps_per_second': 2.743, 'train_loss': 0.050899657592251527, 'epoch': 12.0}
***** train metrics *****
  epoch                    =       12.0
  train_loss               =     0.0509
  train_runtime            = 0:19:32.37
  train_samples            =       8570
  train_samples_per_second =     87.719
  train_steps_per_second   =      2.743
[{'loss': 0.2936, 'grad_norm': 0.3603750169277191, 'learning_rate': 4.5833333333333334e-05, 'epoch': 1.0, 'step': 268}, {'eval_loss': 0.08182453364133835, 'eval_precision': 0.2437357630979499, 'eval_recall': 0.3446054750402576, 'eval_f1': 0.28552368245497, 'eval_accuracy': 0.9758861922069801, 'eval_runtime': 6.0813, 'eval_samples_per_second': 248.797, 'eval_steps_per_second': 31.243, 'epoch': 1.0, 'step': 268}, {'loss': 0.0621, 'grad_norm': 0.3335112929344177, 'learning_rate': 4.166666666666667e-05, 'epoch': 2.0, 'step': 536}, {'eval_loss': 0.06725738197565079, 'eval_precision': 0.5859030837004405, 'eval_recall': 0.642512077294686, 'eval_f1': 0.6129032258064515, 'eval_accuracy': 0.9825692734591784, 'eval_runtime': 5.996, 'eval_samples_per_second': 252.334, 'eval_steps_per_second': 31.688, 'epoch': 2.0, 'step': 536}, {'loss': 0.0489, 'grad_norm': 0.6670600771903992, 'learning_rate': 3.7500000000000003e-05, 'epoch': 3.0, 'step': 804}, {'eval_loss': 0.06508239358663559, 'eval_precision': 0.544973544973545, 'eval_recall': 0.6634460547504025, 'eval_f1': 0.59840232389252, 'eval_accuracy': 0.9827256028451948, 'eval_runtime': 5.975, 'eval_samples_per_second': 253.22, 'eval_steps_per_second': 31.799, 'epoch': 3.0, 'step': 804}, {'loss': 0.0383, 'grad_norm': 0.748274028301239, 'learning_rate': 3.3333333333333335e-05, 'epoch': 4.0, 'step': 1072}, {'eval_loss': 0.06412997096776962, 'eval_precision': 0.6320610687022901, 'eval_recall': 0.6666666666666666, 'eval_f1': 0.6489028213166144, 'eval_accuracy': 0.986516590456091, 'eval_runtime': 5.8815, 'eval_samples_per_second': 257.249, 'eval_steps_per_second': 32.305, 'epoch': 4.0, 'step': 1072}, {'loss': 0.0313, 'grad_norm': 0.19151520729064941, 'learning_rate': 2.916666666666667e-05, 'epoch': 5.0, 'step': 1340}, {'eval_loss': 0.06256505846977234, 'eval_precision': 0.626453488372093, 'eval_recall': 0.6940418679549114, 'eval_f1': 0.6585179526355996, 'eval_accuracy': 0.9860866846445461, 'eval_runtime': 5.9969, 'eval_samples_per_second': 252.296, 'eval_steps_per_second': 31.683, 'epoch': 5.0, 'step': 1340}, {'loss': 0.026, 'grad_norm': 0.5988292098045349, 'learning_rate': 2.5e-05, 'epoch': 6.0, 'step': 1608}, {'eval_loss': 0.0643669068813324, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.6763285024154589, 'eval_f1': 0.6714628297362111, 'eval_accuracy': 0.9873764020791809, 'eval_runtime': 5.963, 'eval_samples_per_second': 253.73, 'eval_steps_per_second': 31.863, 'epoch': 6.0, 'step': 1608}, {'loss': 0.0223, 'grad_norm': 0.5306894183158875, 'learning_rate': 2.0833333333333336e-05, 'epoch': 7.0, 'step': 1876}, {'eval_loss': 0.06306583434343338, 'eval_precision': 0.6842105263157895, 'eval_recall': 0.7326892109500805, 'eval_f1': 0.7076205287713843, 'eval_accuracy': 0.9875718138117012, 'eval_runtime': 5.9356, 'eval_samples_per_second': 254.901, 'eval_steps_per_second': 32.01, 'epoch': 7.0, 'step': 1876}, {'loss': 0.0198, 'grad_norm': 0.2826365530490875, 'learning_rate': 1.6666666666666667e-05, 'epoch': 8.0, 'step': 2144}, {'eval_loss': 0.06526315212249756, 'eval_precision': 0.6167400881057269, 'eval_recall': 0.6763285024154589, 'eval_f1': 0.6451612903225806, 'eval_accuracy': 0.9854613671004807, 'eval_runtime': 5.9343, 'eval_samples_per_second': 254.96, 'eval_steps_per_second': 32.017, 'epoch': 8.0, 'step': 2144}, {'loss': 0.0185, 'grad_norm': 0.10697690397500992, 'learning_rate': 1.25e-05, 'epoch': 9.0, 'step': 2412}, {'eval_loss': 0.06350889801979065, 'eval_precision': 0.6587887740029542, 'eval_recall': 0.7181964573268921, 'eval_f1': 0.687211093990755, 'eval_accuracy': 0.9869074139211318, 'eval_runtime': 5.9706, 'eval_samples_per_second': 253.41, 'eval_steps_per_second': 31.823, 'epoch': 9.0, 'step': 2412}, {'loss': 0.0173, 'grad_norm': 0.27904149889945984, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0, 'step': 2680}, {'eval_loss': 0.06493796408176422, 'eval_precision': 0.6472303206997084, 'eval_recall': 0.714975845410628, 'eval_f1': 0.6794185156847742, 'eval_accuracy': 0.9862820963770664, 'eval_runtime': 5.9971, 'eval_samples_per_second': 252.29, 'eval_steps_per_second': 31.682, 'epoch': 10.0, 'step': 2680}, {'loss': 0.0167, 'grad_norm': 0.07662376761436462, 'learning_rate': 4.166666666666667e-06, 'epoch': 11.0, 'step': 2948}, {'eval_loss': 0.06456692516803741, 'eval_precision': 0.6646706586826348, 'eval_recall': 0.714975845410628, 'eval_f1': 0.6889061287820014, 'eval_accuracy': 0.98698557861414, 'eval_runtime': 5.9285, 'eval_samples_per_second': 255.207, 'eval_steps_per_second': 32.048, 'epoch': 11.0, 'step': 2948}, {'loss': 0.0161, 'grad_norm': 0.2542739808559418, 'learning_rate': 0.0, 'epoch': 12.0, 'step': 3216}, {'eval_loss': 0.06402674317359924, 'eval_precision': 0.6701807228915663, 'eval_recall': 0.71658615136876, 'eval_f1': 0.6926070038910506, 'eval_accuracy': 0.9872591550396685, 'eval_runtime': 5.8992, 'eval_samples_per_second': 256.476, 'eval_steps_per_second': 32.208, 'epoch': 12.0, 'step': 3216}, {'train_runtime': 1172.3774, 'train_samples_per_second': 87.719, 'train_steps_per_second': 2.743, 'total_flos': 1.179195264071682e+16, 'train_loss': 0.050899657592251527, 'epoch': 12.0, 'step': 3216}]

Evaluation, ltg/norbert3-large
***** predict metrics *****
  predict_accuracy           =      0.989
  predict_f1                 =     0.6785
  predict_loss               =     0.0471
  predict_precision          =     0.6455
  predict_recall             =     0.7149
  predict_runtime            = 0:00:04.98
  predict_samples_per_second =    251.342
  predict_steps_per_second   =     31.518
Train and save best epoch to /cluster/work/users/egilron/seq-label_github/configs/saga/03091023_elsa-intensity_norbert3-large_03_101.json completed. F1: 0.6784599375650364

Job 10910777 consumed 57.5 billing hours from project nn9851k.

Submitted 2024-03-09T10:40:38; waited 1.0 seconds in the queue after becoming eligible to run.

Requested wallclock time: 14.0 hours
Elapsed wallclock time:   7.2 hours

Task and CPU statistics:
ID              CPUs  Tasks  CPU util                Start  Elapsed  Exit status
10910777           1            0.0 %  2024-03-09T10:40:39    7.2 h  0
10910777.batch     1      1    89.7 %  2024-03-09T10:40:39    7.2 h  0

Used CPU time:   6.4 CPU hours
Unused CPU time: 44.3 CPU minutes

Memory statistics, in GiB:
ID               Alloc   Usage
10910777          24.0        
10910777.batch    24.0     2.4

GPU usage stats:
Job 10910777 completed at Sat Mar 9 17:51:58 CET 2024
